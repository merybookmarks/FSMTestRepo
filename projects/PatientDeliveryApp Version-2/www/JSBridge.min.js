
(function(){var _scriptVersion=11.3;var _inherit=(function(){function _(){}
return function(child,parent){_.prototype=parent.prototype;child.prototype=new _;child.prototype.constructor=child;child.superproto=parent.prototype;return child;};})();var _findInArray=function(arr,property,value){if(arr){for(var i=0;i<arr.length;i++){if(arr[i][property]==value)
return arr[i];}}
return null;};var _addProperty=function(obj,name,writable,value){if(!obj._privVals)
obj._privVals={};if(!obj._typeInfo)
obj._typeInfo={};if(!obj.propertyChanged)
obj.propertyChanged=new _Event(obj);if(value!=undefined)
obj._privVals[name]=value;var propDef={get:function(){return obj._privVals[name];},enumerable:true};if(writable){propDef.set=function(newVal){if(obj._privVals[name]!=newVal){obj._privVals[name]=newVal;obj.propertyChanged.raise(name);}
if(obj._typeInfo[name])
delete obj._typeInfo[name];};}
Object.defineProperty(obj,name,propDef);};var _bindHandler=function(handler,handlers,bind,scope){if(bind||typeof bind=="undefined"){handlers.push({handler:handler,scope:(scope?scope:null)});}
else{var index=0;while(index<handlers.length){if(handlers[index].handler===handler){handlers.splice(index,1);}
else{index++;}}}};var _callHandlers=function(handlers){var params=[];var i=1;while(arguments[i])
params.push(arguments[i++]);var result=false;for(var index in handlers){var handlerDescriptor=handlers[index];if(handlerDescriptor&&handlerDescriptor.handler){var thisResult=handlerDescriptor.handler.apply(handlerDescriptor.scope,params);if(thisResult!=false)
result=result||thisResult;}}
return result;}
var _Event=function(sender){var _handlers=[],_handlersToRemove=[],_bRaisingEvent=false;this.add=function(handler,target){var bExists=false;for(var index in _handlers){var h=_handlers[index];if(h&&h.handler==handler&&h.target==target){bExists=true;break;}}
if(!bExists){_handlers.push({handler:handler,target:target});}}
this.remove=function(handler,target){var index=0;while(index<_handlers.length){var h=_handlers[index];if((!handler||h.handler==handler)&&(!target||h.target==target)){if(!_bRaisingEvent){_handlers.splice(index,1);index--;}
else{_handlersToRemove.push(h);}}
index++;}}
this.clear=function(){if(!_bRaisingEvent){_handlers=[];}
else{_handlersToRemove=_handlers.slice(0);}}
this.raise=function(eventArgs){_bRaisingEvent=true;for(index in _handlers){var h=_handlers[index];if(h&&h.handler){h.handler.call(h.target?h.target:sender,eventArgs,sender);if(eventArgs&&eventArgs.cancel){break;}}}
_bRaisingEvent=false;for(index in _handlersToRemove){var hToRemove=_handlersToRemove[index];if(hToRemove)
this.remove(hToRemove.handler,hToRemove.target);}}};if(typeof MobileCrmException==="undefined"){MobileCrmException=function(msg){this.message=msg;this.name="MobileCrmException";};MobileCrmException.prototype.toString=function(){return this.message;};}
if(typeof MobileCRM==="undefined"){MobileCRM={bridge:null,Bridge:function(platform){this.commandQueue=[];this.processing=false;this.callbacks={};this.callbackId=0;this.version=_scriptVersion;this.platform=platform;},Configuration:function(){},CultureInfo:function(){},DateTimeFormat:function(){},NumberFormat:function(){},Localization:{stringTable:{},initialized:false},Reference:function(entityName,id,primaryName){this.entityName=entityName;this.id=id;this.isNew=(id?false:true);this.primaryName=primaryName;},Relationship:function(sourceProperty,target,intersectEntity,intersectProperty){this.sourceProperty=sourceProperty;this.target=target;this.intersectEntity=intersectEntity;this.intersectProperty=intersectProperty;},ManyToManyReference:{},DynamicEntity:function(entityName,id,primaryName,properties,isOnline){MobileCRM.DynamicEntity.superproto.constructor.apply(this,arguments);this.isOnline=isOnline;if(properties){if(MobileCRM.DynamicEntity.legacyPropsSerialization){for(var i in properties){if(typeof(properties[i])=="boolean")
properties[i]=properties[i].toString();}}
this.properties=new MobileCRM.ObservableObject(properties);}
else
this.properties={};},Metadata:{entities:null},MetaEntity:function(props){MobileCRM.MetaEntity.superproto.constructor.apply(this,arguments);},MetaProperty:function(){},FetchXml:{Fetch:function(entity,count,page){this.entity=entity;this.count=count;this.page=page;this.aggregate=false;},Entity:function(name){this.name=name;this.attributes=[];this.order=[];this.filter=null;this.linkentities=[];},LinkEntity:function(name){MobileCRM.FetchXml.LinkEntity.superproto.constructor.apply(this,arguments);this.from=null;this.to=null;this.linktype=null;this.alias=null;},Attribute:function(name){this.name=name;this.aggregate=null;this.groupby=false;this.alias=null;this.dategrouping=null;},Order:function(attribute,descending){this.attribute=attribute;this.alias=null;this.descending=descending?true:false;},Filter:function(){this.type=null;this.conditions=[];this.filters=[];},Condition:function(){this.attribute=null;this.operator=null;this.uitype=null;this.uiname=null;this.value=null;this.values=[];}},Platform:function(props){MobileCRM.Platform.superproto.constructor.apply(this,arguments);},Application:function(){},AboutInfo:function(){this.manufacturer="";this.productTitle="";this.productTitleAndVersion="";this.productSubTitle="";this.poweredBy="";this.icon="";this.website="";this.supportEmail="";},MobileReport:function(){},Questionnaire:function(){},UI:{FormManager:{},EntityForm:function(props){MobileCRM.UI.EntityForm.superproto.constructor.apply(this,arguments);},QuestionnaireForm:function(){MobileCRM.UI.QuestionnaireForm.superproto.constructor.apply(this,arguments);},EntityList:function(props){MobileCRM.UI.EntityList.superproto.constructor.apply(this,arguments);},HomeForm:function(props){MobileCRM.UI.HomeForm.superproto.constructor.apply(this,arguments);},ReportForm:function(){this.allowedReportIds=[];this.allowedLanguages=[];this.defaultReport=null;},IFrameForm:function(){MobileCRM.UI.IFrameForm.superproto.constructor.apply(this,arguments);},Form:function(props){MobileCRM.UI.Form.superproto.constructor.apply(this,arguments);},ViewController:function(){},ProcessController:function(){MobileCRM.UI.ProcessController.superproto.constructor.apply(this,arguments);},ViewDefinition:function(){},MessageBox:function(title,defaultText){var nArgs=arguments.length;var arr=[];for(var i=2;i<nArgs;i++)
arr.push(arguments[i]);this.title=title||null;this.defaultText=defaultText||null;this.multiLine=false;this.items=arr;},LookupForm:function(){var nEntities=arguments.length;var arr=[];for(var i=0;i<nEntities;i++)
arr.push(arguments[i]);this._views=[];this.allowedViews="";this.entities=arr;this.source=null;this.prevSelection=null;this.allowNull=false;this.preventClose=false;},MultiLookupForm:function(){MobileCRM.UI.MultiLookupForm.superproto.constructor.apply(this,arguments);this.dataSource=[];},TourplanForm:function(props){MobileCRM.UI.TourplanForm.superproto.constructor.apply(this,arguments);},_DetailView:function(props){MobileCRM.UI._DetailView.superproto.constructor.apply(this,arguments);},DetailViewItems:{Item:function(name,label){this._type=null;this.name=name;this.label=label;},SeparatorItem:function(name,label){MobileCRM.UI.DetailViewItems.SeparatorItem.superproto.constructor.apply(this,arguments);this._type="Separator";},TextBoxItem:function(name,label){MobileCRM.UI.DetailViewItems.TextBoxItem.superproto.constructor.apply(this,arguments);this._type="TextBox";},NumericItem:function(name,label){MobileCRM.UI.DetailViewItems.NumericItem.superproto.constructor.apply(this,arguments);this._type="Numeric";},CheckBoxItem:function(name,label){MobileCRM.UI.DetailViewItems.CheckBoxItem.superproto.constructor.apply(this,arguments);this._type="CheckBox";this.isNullable=false;},DateTimeItem:function(name,label){MobileCRM.UI.DetailViewItems.DateTimeItem.superproto.constructor.apply(this,arguments);this._type="DateTime";},DurationItem:function(name,label){MobileCRM.UI.DetailViewItems.DurationItem.superproto.constructor.apply(this,arguments);this._type="Duration";},ComboBoxItem:function(name,label){MobileCRM.UI.DetailViewItems.ComboBoxItem.superproto.constructor.apply(this,arguments);this._type="ComboBox";},LinkItem:function(name,label,listDropDownFormat){MobileCRM.UI.DetailViewItems.LinkItem.superproto.constructor.apply(this,arguments);this._type="Link";if(listDropDownFormat)
this.listDropDownFormat=listDropDownFormat;},DropDownFormat:{StringList:17,StringListInput:18,MultiStringList:19,MultiStringListInput:20},},MediaTab:function(index,name){this.index=index;this.name=name;}},Services:{FileInfo:function(filePath,url,mimeType,nextInfo){this.filePath=filePath;this.url=url;this.mimeType=mimeType;this.nextInfo=nextInfo||null;},ChatService:function(){MobileCRM.Services.ChatService.superproto.constructor.apply(this,arguments);},DocumentService:function(){},AudioRecorder:function(){},AddressBookService:function(){},DynamicsReport:function(reportId,regarding){this.reportId=reportId;this.regarding=regarding;this.outputFolder=null;},HttpWebRequest:function(){this.userName="";this.password="";this.method="";this.headers={};this.contentType=null;this.allowRedirect=false;this._body=null;this._encoding="UTF-8";this._credentials={};this.responseType=null;this.responseEncoding=this._encoding;},SynchronizationResult:function(syncResult){if(typeof(syncResult)!="undefined"){var res=new Number(syncResult);this.newCustomizationReady=(res&1)!=0;this.customizationDownloaded=(res&2)!=0;this.dataErrorsEncountered=(res&8)!=0;this.appWasLocked=(res&16)!=0;this.syncAborted=(res&32)!=0;this.adminFullSync=(res&64)!=0;this.webError=(res&128)!=0,this.connectFailed=(res&256)!=0,this.wasBackgroundSync=(res&0x80000000)!=0;}},GeoAddress:function(){}}};MobileCRM.UI.MediaTab.prototype._onCommand=function(commandIndex,errorCallback){var mediaTab=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[this.index]);mediaTab.invokeMethodAsync("View.ExecuteAction",[commandIndex],function(){},errorCallback);mediaTab.release();};MobileCRM.UI.MediaTab.prototype.setEditable=function(editable,errorCallback){var mediaTab=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[this.index]);mediaTab.invokeMethodAsync("set_IsEditable",[editable],function(){},errorCallback);mediaTab.release();};MobileCRM.UI.MediaTab.prototype.setCommandsMask=function(commandMask,errorCallback){var mediaTab=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[this.index]);mediaTab.invokeMethodAsync("set_CommandsMask",[commandMask],function(){},errorCallback);mediaTab.release();};MobileCRM.AboutInfo.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.AboutForm","LoadAboutInfo",[],function(res){var aboutInfo=new MobileCRM.AboutInfo();for(var property in res){if(aboutInfo.hasOwnProperty(property))
aboutInfo[property]=res[property];}
callback.call(scope,aboutInfo);},errorCallback,scope);};MobileCRM.UI.MediaTab.prototype.capturePhoto=function(errorCallback){this._onCommand(2,errorCallback);};MobileCRM.UI.MediaTab.prototype.selectPhoto=function(errorCallback){this._onCommand(4,errorCallback);};MobileCRM.UI.MediaTab.prototype.selectFile=function(errorCallback){this._onCommand(8,errorCallback);};MobileCRM.UI.MediaTab.prototype.recordAudio=function(errorCallback){this._onCommand(16,errorCallback);};MobileCRM.UI.MediaTab.prototype.recordVideo=function(errorCallback){this._onCommand(32,errorCallback);};MobileCRM.UI.MediaTab.prototype.clear=function(errorCallback){this._onCommand(0x1000,errorCallback);};MobileCRM.UI.MediaTab.prototype.open=function(errorCallback){this._onCommand(0x4000,errorCallback);}
MobileCRM.UI.MediaTab.prototype.export=function(errorCallback){this._onCommand(0x8000000,errorCallback);}
MobileCRM.UI.MediaTab.prototype.print=function(errorCallback){this._onCommand(0x80000,errorCallback);}
MobileCRM.UI.MediaTab.prototype.getDocumentInfo=function(callback,errorCallback,scope){var mediaTab=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[this.index]);mediaTab.invokeMethodAsync("get_View",[],callback,errorCallback,scope);mediaTab.release();};MobileCRM.UI.MediaTab.prototype.getData=function(callback,errorCallback,scope){MobileCRM.bridge.command("getViewData",this.name,callback,errorCallback,scope);};MobileCRM.UI.MediaTab.getData=function(viewName,callback,errorCallback,scope){MobileCRM.bridge.command("getViewData",viewName,callback,errorCallback,scope);};MobileCRM.UI.MediaTab.prototype.isEmpty=function(callback,errorCallback,scope){var mediaTab=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[this.index]);mediaTab.invokeMethodAsync("get_IsEmpty",[],callback,errorCallback,scope);mediaTab.release();};MobileCRM.UI.MediaTab.prototype.getNoteSubject=function(callback,errorCallback,scope){var mediaTab=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[this.index]);mediaTab.invokeMethodAsync("get_NoteSubject",[],callback,errorCallback,scope);mediaTab.release();};MobileCRM.UI.MediaTab.prototype.setNoteSubject=function(subject,errorCallback,scope){var mediaTab=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[this.index]);mediaTab.invokeMethodAsync("set_NoteSubject",[subject],function(){},errorCallback,scope);mediaTab.release();};MobileCRM.Bridge.prototype._createCmdObject=function(success,failed,scope){var self=MobileCRM.bridge;var cmdId='Cmd'+self.callbackId++;self.callbacks[cmdId]={SuccessFn:success,FailedFn:failed,Scope:scope};return cmdId;};MobileCRM.Bridge.prototype.requestObject=function(objectName,callback,errorCallback,scope){MobileCRM.bridge.command("requestObj",objectName,callback,errorCallback,scope);}
MobileCRM.Bridge.prototype.initialize=function(){}
MobileCRM.Bridge.prototype.invokeMethodAsync=function(objectName,method,paramsList,callback,errorCallback,scope){return MobileCRM.bridge.command("invokeMethod",objectName+"."+method+JSON.stringify(paramsList),callback,errorCallback,scope);}
MobileCRM.Bridge.prototype.invokeStaticMethodAsync=function(assembly,typeName,method,paramsList,callback,errorCallback,scope){return MobileCRM.bridge.command("invokeMethod",(assembly?(assembly+":"):"")+typeName+"."+method+JSON.stringify(paramsList),callback,errorCallback,scope);}
var _tmpObjId=0;MobileCRM.Bridge.prototype.exposeObjectAsync=function(method,paramsList){var objId=++_tmpObjId;MobileCRM.bridge.command("exposeMethodResult",objId+"#"+method+JSON.stringify(paramsList));return new MobileCRM.ExposedObject(objId);}
MobileCRM.Bridge.prototype.raiseGlobalEvent=function(eventName,args){this.invokeStaticMethodAsync("MobileCrm.UI","MobileCrm.UI.Controllers.WebController","RaiseGlobalEvent",[eventName,JSON.stringify(args)]);}
var _globalHandlers={};MobileCRM.Bridge.prototype.onGlobalEvent=function(eventName,handler,bind,scope){var handlers=_globalHandlers[eventName];if(handlers===undefined){_globalHandlers[eventName]=handlers=[];}
var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(bind){if(register)
MobileCRM.bridge.command("registerGlobalEvent","+"+eventName);}
else if(handlers.length==0)
MobileCRM.bridge.command("registerGlobalEvent","-"+eventName);};MobileCRM.Bridge.prototype._callGlobalHandlers=function(event,data){var handlers=_globalHandlers[event];if(handlers&&handlers.length>0){return _callHandlers(handlers,data);}
return null;}
MobileCRM.Bridge.prototype.runCallback=function(id,response){try{var callback=MobileCRM.bridge.callbacks[id];if(callback){var result=null;if(callback.SuccessFn){result=callback.SuccessFn.call(callback.Scope,response);delete callback.SuccessFn;}
return JSON.stringify(result);}
return"Err: callback not found";}catch(exception){return'Err:'+exception.message;}};MobileCRM.Bridge.prototype.setResponse=function(id,response,deleteCallback){try{var self=MobileCRM.bridge;var callback=self.callbacks[id];if(callback){if(callback.SuccessFn){callback.SuccessFn.call(callback.Scope,response);}
if(deleteCallback!=false)
delete self.callbacks[id];}}catch(exception){return exception.message;}
return"OK";};MobileCRM.Bridge.prototype.setError=function(id,error){var self=MobileCRM.bridge;var callback=self.callbacks[id];if(callback){if(callback.FailedFn){callback.FailedFn.call(callback.Scope,error);}
delete self.callbacks[id];}};MobileCRM.Bridge.prototype.closeForm=function(){MobileCRM.bridge.command("closeForm");};MobileCRM.Bridge.prototype.enableDebug=function(callback,errorCallback,scope){MobileCRM.bridge.command("enableDebug","",callback,errorCallback,scope);};MobileCRM.Bridge.prototype.enableZoom=function(enable){MobileCRM.bridge.command("enableZoom",enable);};MobileCRM.Bridge.prototype.getWindowSize=function(callback,errorCallback,scope){MobileCRM.bridge.command("getWindowSize","",callback,errorCallback,scope);};MobileCRM.Bridge.prototype.alert=function(text,callback,scope){window.setTimeout(function(){window.alert(text);if(callback)
callback.call(scope);});};MobileCRM.Bridge.prototype.log=function(text){MobileCRM.bridge.command("log",text);};MobileCRM.ExposedObject=function(id){this.id=id;};MobileCRM.ExposedObject.prototype.asInvokeArgument=function(){return"~ExpObj:#exposedObj#"+this.id;};MobileCRM.ExposedObject.prototype.invokeMethodAsync=function(method,paramsList,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("#exposedObj#"+this.id,method,paramsList,callback,errorCallback,scope);};MobileCRM.ExposedObject.prototype.exposeObjectAsync=function(method,paramsList){return MobileCRM.bridge.exposeObjectAsync("#exposedObj#"+this.id+"."+method,paramsList);};MobileCRM.ExposedObject.prototype.release=function(){MobileCRM.bridge.command("releaseExposedObject",this.id);};MobileCRM.ObservableObject=function(props){var privChanged={};var typeInfo={};var propertyChanged=new _Event(this);propertyChanged.add(function(args){privChanged[args]=true;},this);Object.defineProperty(this,"propertyChanged",{value:propertyChanged,enumerable:false});Object.defineProperty(this,"_privChanged",{value:privChanged,enumerable:false});Object.defineProperty(this,"_typeInfo",{value:typeInfo,enumerable:false});if(props){for(var i in props){this.addProp(i,true,props[i]);}}};MobileCRM.ObservableObject.prototype.addProp=function(name,writable,value){_addProperty(this,name,writable,value);};MobileCRM.ObservableObject.prototype.getChanged=function(){var parse=function(obj,changedProps){var result=undefined;for(var i in obj){var val=obj[i];var changedVal=undefined;if(val instanceof MobileCRM.ObservableObject)
changedVal=val.getChanged();else if(changedProps[i]==true)
changedVal=val;else if(val&&typeof val=="object"&&!(val instanceof Date)&&i[0]!='_')
changedVal=parse(val,{});if(changedVal!==undefined){if(result==null){if(obj.constructor==Array){result=[];for(var j=0;j<obj.length;j++)
result[j]=null;}
else
result={};}
var propName=i;if(obj._typeInfo){var typeInfo=obj._typeInfo[i];if(typeInfo)
propName+="-"+typeInfo;}
result[propName]=changedVal;}}
return result;};return parse(this,this._privChanged);}
MobileCRM.ObservableObject.prototype.setTypedValue=function(propName,type,value){this[propName]=value;this._typeInfo[propName]=type.replace(',','-');};MobileCRM.Configuration.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("Configuration",function(obj){if(callback.call(scope,obj)!=false){var changed=obj.getChanged();return changed;}
return'';},errorCallback,scope);};MobileCRM._Settings={}
MobileCRM.CultureInfo.currentCulture=null;MobileCRM.CultureInfo.initialize=function(callback,errorCallback,scope){MobileCRM.bridge.command("getCultureInfo",'',function(res){MobileCRM.CultureInfo.currentCulture=res;if(callback)
callback.call(scope,res);},errorCallback,scope);}
MobileCRM.CultureInfo.load=function(culture,callback,errorCallback,scope){MobileCRM.bridge.command("getCultureInfo",culture||'',function(res){if(callback)
callback.call(scope,res);},errorCallback,scope);};MobileCRM.CultureInfo.shortDateString=function(date){return MobileCRM.CultureInfo.formatDate(date,MobileCRM.CultureInfo.currentCulture.dateTimeFormat.shortDatePattern)};MobileCRM.CultureInfo.longDateString=function(date){return MobileCRM.CultureInfo.formatDate(date,MobileCRM.CultureInfo.currentCulture.dateTimeFormat.longDatePattern)};MobileCRM.CultureInfo.shortTimeString=function(date){return MobileCRM.CultureInfo.formatDate(date,MobileCRM.CultureInfo.currentCulture.dateTimeFormat.shortTimePattern)};MobileCRM.CultureInfo.longTimeString=function(date){return MobileCRM.CultureInfo.formatDate(date,MobileCRM.CultureInfo.currentCulture.dateTimeFormat.longTimePattern)};MobileCRM.CultureInfo.fullDateTimeString=function(date){return MobileCRM.CultureInfo.formatDate(date,MobileCRM.CultureInfo.currentCulture.dateTimeFormat.fullDateTimePattern)};MobileCRM.CultureInfo.monthDayString=function(date){return MobileCRM.CultureInfo.formatDate(date,MobileCRM.CultureInfo.currentCulture.dateTimeFormat.monthDayPattern)};MobileCRM.CultureInfo.yearMonthString=function(date){return MobileCRM.CultureInfo.formatDate(date,MobileCRM.CultureInfo.currentCulture.dateTimeFormat.yearMonthPattern)};MobileCRM.CultureInfo.formatDate=function(date,format){var df=MobileCRM.CultureInfo.currentCulture.dateTimeFormat;var zeroPad=function(num,length,dontCut){var st=""+num;if(st.length>length)
return dontCut?st:st.substr(0,length);while(st.length<length)
st="0"+st;return st;};var trimDigits=function(num,length){var st=""+num;if(st.length>length)
return st.substr(0,length);return st;};var hoursTo12h=function(h){return h<=12?h:(h%12);};var i=0;var fLen=format.length;var res="";while(i<fLen){var c=format.charAt(i);switch(c){case'd':if(format.charAt(++i)==='d'){if(format.charAt(++i)==='d'){if(format.charAt(++i)==='d'){res+=df.dayNames[date.getDay()];i++;}
else
res+=df.abbreviatedDayNames[date.getDay()];}
else
res+=zeroPad(date.getDate(),2,false);}else
res+=date.getDate();break;case'f':if(format.charAt(++i)==='f'){if(format.charAt(++i)==='f'){if(format.charAt(++i)==='f'){if(format.charAt(++i)==='f'){if(format.charAt(++i)==='f'){if(format.charAt(++i)==='f'){res+=date.getMilliseconds();i++;}
else
res+=date.getMilliseconds();}
else
res+=date.getMilliseconds();}
else
res+=date.getMilliseconds();}
else
res+=date.getMilliseconds();}
else
res+=trimDigits(date.getMilliseconds(),2);}
else
res+=trimDigits(date.getMilliseconds(),1);break;case'F':if(format.charAt(++i)==='F'){if(format.charAt(++i)==='F'){if(format.charAt(++i)==='F'){if(format.charAt(++i)==='F'){if(format.charAt(++i)==='F'){if(format.charAt(++i)==='F'){res+=zeroPad(date.getMilliseconds(),7,false);i++;}
else
res+=zeroPad(date.getMilliseconds(),6,false);}
else
res+=zeroPad(date.getMilliseconds(),5,false);}
else
res+=zeroPad(date.getMilliseconds(),4,false);}
else
res+=zeroPad(date.getMilliseconds(),3,false);}
else
res+=zeroPad(date.getMilliseconds(),2,false);}
else
res+=zeroPad(date.getMilliseconds(),1,false);break;case'g':if(format.charAt(++i)==='g'){res+="A.D.";i++;}
else
res+="AD";break;case'h':if(format.charAt(++i)==='h'){res+=zeroPad(hoursTo12h(date.getHours()),2,false);i++;}
else
res+=hoursTo12h(date.getHours());break;case'H':if(format.charAt(++i)==='H'){res+=zeroPad(date.getHours(),2,false);i++;}
else
res+=date.getHours();break;case'K':var o=-date.getTimezoneOffset();res+=(o<0?"-":"")+zeroPad(Math.abs(o/60),2,false)+":"+zeroPad(o%60,2,false);i++;break;case'm':if(format.charAt(++i)==='m'){res+=zeroPad(date.getMinutes(),2,false);i++;}
else
res+=date.getMinutes();break;case's':if(format.charAt(++i)==='s'){res+=zeroPad(date.getSeconds(),2,false);i++;}
else
res+=date.getSeconds();break;case'M':if(format.charAt(++i)==='M'){if(format.charAt(++i)==='M'){if(format.charAt(++i)==='M'){res+=df.monthGenitiveNames[date.getMonth()];i++;}
else
res+=df.abbreviatedMonthGenitiveNames[date.getMonth()];}
else
res+=zeroPad(date.getMonth()+1,2,false);}else
res+=date.getMonth()+1;break;case't':if(format.charAt(++i)==='t')
i++;res+=date.getHours()<12?df.aMDesignator:df.pMDesignator;break;case'y':if(format.charAt(++i)==='y'){if(format.charAt(++i)==='y'){if(format.charAt(++i)==='y'){if(format.charAt(++i)==='y'){res+=zeroPad(date.getFullYear(),5,true);i++;}
else
res+=zeroPad(date.getFullYear(),4,true);}
else
res+=zeroPad(date.getFullYear(),3,true);}else
res+=zeroPad(date.getFullYear()%100,2,false);}
else
res+=date.getFullYear()%100;break;case'z':if(format.charAt(++i)==='z'){var o=-date.getTimezoneOffset();if(format.charAt(++i)==='z'){res+=(o<0?"-":"")+zeroPad(Math.abs(o/60),2,false)+":"+zeroPad(o%60,2,false);i++;}
else
res+=(o<0?"-":"")+zeroPad(Math.abs(o/60),2,false);}
else
res+=-date.getTimezoneOffset()/60;case'/':res+=(typeof(df.dateSeparator)=="string")?df.dateSeparator:'/';i++;break;case':':res+=(typeof(df.timeSeparator)=="string")?df.timeSeparator:':';i++;break;default:res+=c;i++;break;}}
return res;};MobileCRM.Localization.initialize=function(callback,errorCallback,scope){MobileCRM.Localization.initializeEx(null,callback,errorCallback,scope);};MobileCRM.Localization.initializeEx=function(regularExpression,callback,errorCallback,scope){MobileCRM.bridge.command("localizationInit",regularExpression||'',function(res){MobileCRM.Localization.stringTable=res;MobileCRM.Localization.initialized=true;if(callback)
callback.call(scope,MobileCRM.Localization);},errorCallback,scope);};MobileCRM.Localization.getLoadedLangId=function(callback,errorCallback,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Localization","get_LoadedLangId",[],callback,errorCallback,scope);};MobileCRM.Localization.getTextOrDefault=function(id,defaultString){return MobileCRM.Localization.stringTable[id]||defaultString;};MobileCRM.Localization.getComponentLabel=function(entityName,componentType,viewName){return MobileCRM.Localization.stringTable[entityName+"."+componentType+"."+viewName]||MobileCRM.Localization.stringTable[componentType+"."+viewName]||viewName;}
MobileCRM.Localization.get=function(id){return MobileCRM.Localization.getTextOrDefault(id,id);}
MobileCRM.Localization.getPlural=function(id){return MobileCRM.Localization.get(id+"+s");}
MobileCRM.Localization.makeId=function(section,id){return section+"."+id;}
MobileCRM.Reference.prototype.toString=function(){return this.primaryName;}
MobileCRM.Reference.loadById=function(entityName,id,success,failed,scope){window.MobileCRM.bridge.command('referenceload',JSON.stringify({entity:entityName,id:id}),success,failed,scope);};MobileCRM.ManyToManyReference.addRecord=function(entityName,ref1,ref2,create,success,failed,scope){MobileCRM.bridge.command('addManyToManyReference',JSON.stringify({entityName:entityName,ref1:ref1,ref2:ref2,create:create}),success,failed,scope);};MobileCRM.ManyToManyReference.create=function(entityName,ref1,ref2,success,failed,scope){MobileCRM.ManyToManyReference.addRecord(entityName,ref1,ref2,true,success,failed,scope);};MobileCRM.ManyToManyReference.remove=function(entityName,ref1,ref2,success,failed,scope){MobileCRM.ManyToManyReference.addRecord(entityName,ref1,ref2,false,success,failed,scope);};_inherit(MobileCRM.DynamicEntity,MobileCRM.Reference);MobileCRM.DynamicEntity.legacyPropsSerialization=false;MobileCRM.DynamicEntity.createNew=function(entityName,id,primaryName,properties){var entity=new MobileCRM.DynamicEntity(entityName,id,primaryName,properties);entity.isNew=true;return entity;}
MobileCRM.DynamicEntity.deleteById=function(entityName,id,success,failed,scope){var request={entity:entityName,id:id};var cmdParams=JSON.stringify(request);window.MobileCRM.bridge.command('entitydelete',cmdParams,success,failed,scope);};MobileCRM.DynamicEntity.loadById=function(entityName,id,success,failed,scope){window.MobileCRM.bridge.command('entityload',JSON.stringify({entity:entityName,id:id}),success,failed,scope);};MobileCRM.DynamicEntity.saveDocumentBody=function(entityId,entityName,relationship,filePath,mimeType,success,failed,scope){window.MobileCRM.bridge.command('documentBodysave',JSON.stringify({entity:entityName,id:entityId,relationship:relationship,filePath:filePath,mimeType:mimeType}),success,failed,scope);};MobileCRM.DynamicEntity.loadDocumentBody=function(entityName,id,success,failed,scope){window.MobileCRM.bridge.command('documentBodyload',JSON.stringify({entity:entityName,id:id}),success,failed,scope);};MobileCRM.DynamicEntity.unzipDocumentBody=function(entityName,id,targetDir,success,failed,scope){window.MobileCRM.bridge.command('documentBodyUnzip',targetDir+';'+JSON.stringify({entity:entityName,id:id}),success,failed,scope);};MobileCRM.DynamicEntity.downloadAttachment=function(entityName,id,success,failed,scope){window.MobileCRM.bridge.command("downloadAttachment",JSON.stringify({entity:entityName,id:id}),success,failed,scope);}
MobileCRM.DynamicEntity.prototype.save=function(callback,forceMode){var props=this.properties;if(props._privVals)
props=props._privVals;var request={entity:this.entityName,id:this.id,properties:props,isNew:this.isNew,isOnline:this.isOnline};if(forceMode===true||forceMode===false)
request.isOnlineForce=forceMode;if(this.forceDirty)
request.forceDirty=this.forceDirty;var cmdParams=JSON.stringify(request);var self=this;window.MobileCRM.bridge.command('entitysave',cmdParams,function(res){self.id=res.id;self.isNew=false;self.isOnline=res.isOnline;self.primaryName=res.primaryName;self.properties=res.properties;callback.call(self,null);},function(err){callback.call(self,err);},null);return this;};MobileCRM.DynamicEntity.prototype.saveAsync=function(forceMode){var _this=this;return new Promise(function(resolve,reject){_this.save(function(err){if(err)
reject(err);else
resolve(this);},forceMode);});};MobileCRM.Metadata.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("Metadata",function(obj){if(obj){MobileCRM.Metadata.entities=obj;}
callback.call(scope,MobileCRM.Metadata);return'';},errorCallback,scope);}
MobileCRM.Metadata.getEntity=function(name){return MobileCRM.Metadata.entities[name];};MobileCRM.Metadata.getActivities=function(){var arr=[];var metaEntities=MobileCRM.Metadata.entities;for(var entity in metaEntities){var meta=metaEntities[entity];if(meta&&meta.isEnabled&&meta.canRead()&&(meta.attributes&0x10)!=0)
arr.push(meta.name);}
return arr;};MobileCRM.Metadata._childParentMap={invoicedetail:"invoice",quotedetail:"quote",salesorderdetail:"salesorder",opportunityproduct:"opportunity",uom:"uomschedule",productpricelevel:"pricelevel",discount:"discounttype",contractdetail:"contract",salesliteratureitem:"salesliterature",queueitem:"queue",activitymimeattachment:"email"};MobileCRM.Metadata.getEntityParent=function(childEntityName){return MobileCRM.Metadata._childParentMap[childEntityName];};MobileCRM.Metadata.entityHasChildren=function(entityName){return"undefined"!=typeof MobileCRM.Metadata._childParentMap[entityName];};MobileCRM.Metadata.getOptionSetValues=function(entityName,optionSetName,callback,errorCallback,scope){var fn=function(){var result={};var stringTable=MobileCRM.Localization.stringTable;var searchVal=entityName+'.'+optionSetName+'.';var searchValLen=searchVal.length;for(var i in stringTable){if(i&&i.substr(0,searchValLen)==searchVal){var val=parseInt(i.substr(searchValLen),10);if(val>0){var st=stringTable[i];result[st]=val;}}}
callback.call(scope,result);};if(MobileCRM.Localization.initialized)
fn();else
MobileCRM.Localization.initialize(fn,errorCallback,scope);};MobileCRM.Metadata.getStringListOptions=function(entityName,propertyName){var options={};var keyPrefix=entityName+"."+propertyName+".";for(var key in MobileCRM.Localization.stringTable)
{var label=MobileCRM.Localization.stringTable[key];if(key.substring(0,keyPrefix.length)===keyPrefix){options[key]=label;}}
return options;}
_inherit(MobileCRM.MetaEntity,MobileCRM.ObservableObject);MobileCRM.MetaEntity.loadByName=function(name,callback,errorCallback,scope){var obj=MobileCRM.bridge.exposeObjectAsync("MobileCrm.Data:MobileCrm.Data.Metadata.get_Entities",[]);obj.invokeMethodAsync("get_Item",[name],function(metaEntity){callback(metaEntity,scope);obj.release();},errorCallback,scope);}
MobileCRM.MetaEntity.prototype.getProperty=function(name){return _findInArray(this.properties,"name",name);};MobileCRM.MetaEntity.prototype.canRead=function(){return this.getDepth(0)!=0;}
MobileCRM.MetaEntity.prototype.canWrite=function(){return this.getDepth(1)!=0;}
MobileCRM.MetaEntity.prototype.canCreate=function(){return this.getDepth(2)!=0;}
MobileCRM.MetaEntity.prototype.canAppendTo=function(child){return this.getDepth(5)!=0&&MobileCRM.Metadata.entities[child].getDepth(4)!=0;}
MobileCRM.MetaEntity.prototype.canDelete=function(){return this.getDepth(3)!=0;}
MobileCRM.MetaEntity.prototype.getDepth=function(permission){var p=this.permissionMask;var m=permission*4;var d=(p>>m)&0xF;var disabled=(this.attributes&(0x40<<permission))!=0;if(disabled)
d=0;return d;}
MobileCRM.FetchXml.Fetch.executeFromXML=function(fetchXmlData,success,failed,scope){window.MobileCRM.bridge.command('fetchXML',fetchXmlData,success,failed,scope);};MobileCRM.FetchXml.Fetch.prototype.execute=function(output,success,failed,scope){var reqParams=JSON.stringifyNotNull({entity:this.entity,resultformat:output,page:this.page,count:this.count,aggregate:this.aggregate});MobileCRM.bridge.command('fetch',reqParams,success,failed,scope);};MobileCRM.FetchXml.Fetch.prototype.executeOnline=function(output,success,failed,scope){var format="Online.";if(output)
format+=output;this.execute(format,success,failed,scope);};MobileCRM.FetchXml.Fetch.prototype.executeOffline=function(output,success,failed,scope){var format="Offline.";if(output)
format+=output;this.execute("Offline."+output,success,failed,scope);};MobileCRM.FetchXml.Fetch.prototype.executeAsync=function(output,online){var _this=this;return new Promise(function(resolve,reject){var format="";if(online===true&&online===false)
format=online?"Online.":"Offline.";if(output)
format+=output;_this.execute(format,resolve,reject);});};MobileCRM.FetchXml.Fetch.deserializeFromXml=function(xml,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Data.FetchXml.Fetch","Deserialize",[xml],success,failed,scope);};MobileCRM.FetchXml.Fetch.prototype.serializeToXml=function(success,failed,scope){var reqParams=JSON.stringifyNotNull({entity:this.entity,page:this.page,count:this.count,aggregate:this.aggregate});MobileCRM.bridge.command('fetchToXml',reqParams,success,failed,scope);};MobileCRM.FetchXml.Entity.prototype.addAttribute=function(name,alias,aggregate){var attr=new MobileCRM.FetchXml.Attribute(name);if(alias)
attr.alias=alias;if(aggregate)
attr.aggregate=aggregate;this.attributes.push(attr);return attr;};MobileCRM.FetchXml.Entity.prototype.addAttributes=function(){this.allattributes=true;};MobileCRM.FetchXml.Entity.prototype.addFilter=function(){var filter=this.filter;if(filter)
return filter;filter=new MobileCRM.FetchXml.Filter();this.filter=filter;return filter;};MobileCRM.FetchXml.Entity.prototype.addLink=function(target,from,to,linktype){var link=new MobileCRM.FetchXml.LinkEntity(target);link.from=from;link.to=to;link.linktype=linktype;this.linkentities.push(link);return link;};MobileCRM.FetchXml.Entity.prototype.removeLink=function(link){var index=this.linkentities.indexOf(link);if(index!==-1){this.linkentities.splice(index,1);return this.linkentities;}
return null;};MobileCRM.FetchXml.Entity.prototype.orderBy=function(attribute,descending){var order=new MobileCRM.FetchXml.Order(attribute,descending);this.order.push(order);return order;}
_inherit(MobileCRM.FetchXml.LinkEntity,MobileCRM.FetchXml.Entity);MobileCRM.FetchXml.Filter.prototype.where=function(attribute,op,value){var condition=new MobileCRM.FetchXml.Condition();condition.attribute=attribute;condition.operator=op;condition.value=value;this.conditions.push(condition);return condition;};MobileCRM.FetchXml.Filter.prototype.isIn=function(attribute,values){var condition=new MobileCRM.FetchXml.Condition();condition.attribute=attribute;condition.operator="in";condition.values=values;this.conditions.push(condition);return condition;};MobileCRM.FetchXml.Filter.prototype.notIn=function(attribute,values){var condition=new MobileCRM.FetchXml.Condition();condition.attribute=attribute;condition.operator="not-in";condition.values=values;this.conditions.push(condition);return condition;}
MobileCRM.FetchXml.Filter.prototype.between=function(attribute,low,high){var condition=new MobileCRM.FetchXml.Condition();condition.attribute=attribute;condition.operator="between";condition.values=[low,high];this.conditions.push(condition);return condition;};MobileCRM.FetchXml.Filter.prototype.startsWith=function(attribute,value){return this.where(attribute,"like",value+"%");};MobileCRM.FetchXml.Filter.prototype.contains=function(attribute,value){return this.where(attribute,"like","%"+value+"%");};_inherit(MobileCRM.Platform,MobileCRM.ObservableObject);function _executePlatformAction(action,data,success,failed,scope){var params=[action,data];MobileCRM.bridge.invokeStaticMethodAsync("Resco.UI","Resco.UI.Platform","Instance.Execute",params,success,failed,scope);};MobileCRM.Platform.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("Platform",callback,errorCallback,scope);};MobileCRM.Platform.makeCall=function(telephone,errorCallback,scope){var tel={Address:telephone};_executePlatformAction(0,tel,function(){},errorCallback,scope);}
MobileCRM.Platform.sendSMS=function(phoneNumber,text,errorCallback,scope){var tel={Address:phoneNumber,Body:text};_executePlatformAction(2,tel,function(){},errorCallback,scope);}
MobileCRM.Platform.email=function(address,subject,body,errorCallback,scope){var emailContent={Address:address,Subject:subject,Body:body};_executePlatformAction(1,emailContent,null,errorCallback,scope);};MobileCRM.Platform.openDocument=function(path,mimeType,args,errorCallback,scope){var c={Address:path,Subject:args,MimeType:mimeType};_executePlatformAction(5,c,null,errorCallback,scope);};MobileCRM.Platform.emailWithAttachments=function(address,subject,body,attachments,entity,relationship,errorCallback,scope){var params={relationship:relationship,body:body,subject:subject,address:address,attachments:attachments,entity:entity}
MobileCRM.bridge.command("sendEmailWithAttachments",JSON.stringify(params),null,errorCallback,scope);};MobileCRM.Platform.openUrl=function(url){var param={Address:url};_executePlatformAction(3,param,null,null);};MobileCRM.Platform.getURL=function(success,failed,scope){MobileCRM.bridge.command("getURL",null,success,failed,scope);};MobileCRM.Platform.getDeviceInfo=function(success,failed,scope){MobileCRM.bridge.command("getDeviceInfo",null,success,failed,scope);};MobileCRM.Platform.getNetworkInfo=function(success,failed,scope){MobileCRM.bridge.command("getNetworkInfo",null,success,failed,scope);};MobileCRM.Platform.navigateTo=function(latitude,longitude,failed,scope){var params={Address:latitude+","+longitude};_executePlatformAction(4,params,null,null);};MobileCRM.Platform.scanBarCode=function(success,failed,scope){MobileCRM.bridge.command("scanBarcode",null,success,failed,scope);};MobileCRM.Platform.scanBarCodeRequiredLength=function(requiredLength,success,failed,scope){MobileCRM.bridge.command("scanBarcode",JSON.stringify({"RequiredLength":requiredLength}),success,failed,scope);};MobileCRM.Platform.getLocation=function(success,failed,scope,age,precision,timeout){var params={maxAge:age,accuracy:precision};if(timeout)
params.timeout=timeout;MobileCRM.bridge.command("getLocation",JSON.stringify(params),success,failed,scope);};MobileCRM.Platform.preventBackButton=function(handler,scope){MobileCRM.bridge.command("setBackButtonHandler",handler?MobileCRM.bridge._createCmdObject(handler,null,scope):null,handler,null,scope);};MobileCRM.Application.synchronize=function(backgroundOnly,ifNotSyncedBefore){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.HomeForm","Instance.Synchronize",[backgroundOnly,ifNotSyncedBefore]);}
MobileCRM.Application.synchronizeOnForeground=function(forceLogin){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.HomeForm","Instance.Synchronize",[forceLogin,false]);}
MobileCRM.Application.showAppLogin=function(){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.SecurityManager","OpenLoginForm",[]);}
MobileCRM.Application.getAppColor=function(colName,success,failed,scope){MobileCRM.bridge.command("getAppColor",colName,success,failed,scope);};MobileCRM.Application.getAppImage=function(imageName,colorize,success,failed,scope){var data=colorize?(colorize+"#"+imageName):imageName;MobileCRM.bridge.command("getAppImage",data,success,failed,scope);};MobileCRM.Application.checkUserRoles=function(roles,success,failed,scope){MobileCRM.bridge.command("checkUserRoles",JSON.stringify(roles),success,failed,scope);};MobileCRM.Application.setAppColors=function(colors,success,failed,scope){MobileCRM.bridge.command("setAppColors",JSON.stringify(colors),success,failed,scope);};MobileCRM.Application.fileExists=function(path,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.FileExists",[path],success,failed,scope);};MobileCRM.Application.directoryExists=function(path,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.DirectoryExists",[path],success,failed,scope);};MobileCRM.Application.createDirectory=function(path,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.CreateDirectory",[path],success,failed,scope);};MobileCRM.Application.deleteDirectory=function(path,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.DeleteDirectory",[path],success,failed,scope);};MobileCRM.Application.getDirectories=function(path,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.GetDirectories",[path],success,failed,scope);};MobileCRM.Application.deleteFile=function(path,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.DeleteFile",[path],success,failed,scope);};MobileCRM.Application.getFiles=function(path,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.GetFiles",[path],success,failed,scope);};MobileCRM.Application.moveFile=function(src,dst,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.MoveFile",[src,dst],success,failed,scope);};MobileCRM.Application.readFile=function(path,success,failed,scope){if(MobileCRM.bridge.platform==="WebClient"){if(failed){failed.call(scope||this,"You cannot read a file on the Web Client");}}
else{var reader=MobileCRM.bridge.exposeObjectAsync("MobileCrm.Data:MobileCrm.Configuration.Instance.OpenStorageReader",[path]);reader.invokeMethodAsync("ReadToEnd",[],success,failed,scope);reader.invokeMethodAsync("Dispose",[],undefined,failed,scope);reader.release();}};MobileCRM.Application.writeFile=function(path,text,append,success,failed,scope){if(MobileCRM.bridge.platform==="WebClient"){if(failed){failed.call(scope||this,"You cannot write to a file on the Web Client");}}
else{var reader=MobileCRM.bridge.exposeObjectAsync("MobileCrm.Data:MobileCrm.Configuration.Instance.OpenStorageWriter",[path,append]);reader.invokeMethodAsync("Write",[text],success,failed,scope);reader.invokeMethodAsync("Dispose",[],undefined,failed,scope);reader.release();}};MobileCRM.Application.writeFileWithEncoding=function(path,text,encoding,append,success,failed,scope){if(MobileCRM.bridge.platform==="WebClient"){if(failed){failed.call(scope||this,"You cannot write to a file on the Web Client");}}
else{var reader=MobileCRM.bridge.exposeObjectAsync("MobileCrm.Data:MobileCrm.Configuration.Instance.OpenStorageWriterEnc",[path,append,(encoding||null)]);reader.invokeMethodAsync("Write",[text],success,failed,scope);reader.invokeMethodAsync("Dispose",[],undefined,failed,scope);reader.release();}};MobileCRM.Application.readFileAsBase64=function(path,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.ReadStorageFileAsBase64",[path],success,failed,scope);};MobileCRM.Application.writeFileFromBase64=function(path,base64,success,failed,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.Data","MobileCrm.Configuration","Instance.WriteStorageFileFromBase64",[path,base64],success,failed,scope);};MobileCRM.UI.FormManager.showEditDialog=function(entityName,id,relationship,options){var reference=new MobileCRM.Reference(entityName,id);if(!id||id.length==0)
delete reference.id;if(typeof relationship!="undefined")
reference.relationShip=JSON.stringify(relationship);if(typeof options!="undefined")
reference.options=JSON.stringify(options);MobileCRM.bridge.command("formManagerAction",JSON.stringify(reference));}
MobileCRM.UI.FormManager.showDetailDialog=function(entityName,id,relationship){var reference=new MobileCRM.Reference(entityName,id);reference.detail=true;if(typeof relationship!="undefined")
reference.relationShip=JSON.stringify(relationship);MobileCRM.bridge.command("formManagerAction",JSON.stringify(reference));}
MobileCRM.UI.FormManager.showNewDialog=function(entityName,relationship,options){MobileCRM.UI.FormManager.showEditDialog(entityName,null,relationship,options);}
_inherit(MobileCRM.UI.TourplanForm,MobileCRM.ObservableObject);MobileCRM.UI.TourplanForm.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("Tourplan",callback,errorCallback,scope);};MobileCRM.UI.TourplanForm.setDate=function(date,callback,errorCallback){MobileCRM.bridge.command("setDate",JSON.stringify(date),callback,errorCallback);};MobileCRM.UI.TourplanForm.setMode=function(mode,callback,errorCallback){MobileCRM.bridge.command("setMode",JSON.stringify(mode),callback,errorCallback);};MobileCRM.UI.TourplanForm.onCreateNew=function(handler,bind,scope){var handlers=MobileCRM.UI.TourplanForm._handlers.onCreateNew;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onCreateNew");}
MobileCRM.UI.TourplanForm._callHandlers=function(event,data,context){var handlers=MobileCRM.UI.TourplanForm._handlers[event];if(handlers&&handlers.length>0){data.context=context;data._inCallback=true;var result='';if(_callHandlers(handlers,data)!=false){var changed=data.getChanged();result=JSON.stringify(changed);}
data._inCallback=false;return result;}};MobileCRM.UI.TourplanForm._handlers={onCreateNew:[]};MobileCRM.UI._AppointmentView=function(){};_inherit(MobileCRM.UI._DetailView,MobileCRM.ObservableObject);MobileCRM.UI._DetailView.prototype.getItemByName=function(name){var items=this.items;var nItems=items.length;for(var i=0;i<nItems;i++){var item=items[i];if(item.name==name)
return item;}
return undefined;};MobileCRM.UI._DetailView.prototype.getItemIndex=function(name){var items=this.items;var nItems=items.length;for(var i=0;i<nItems;i++){var item=items[i];if(item.name==name)
return i;}
return-1;};MobileCRM.UI._DetailView.prototype.insertItem=function(item,index){var data={};for(var prop in item){data[prop]=item[prop];}
data.action="insert";data.viewName=this.name;data.index=(typeof(index)!=="undefined")?index:-1;MobileCRM.bridge.command("detailViewAction",JSON.stringify(data));};MobileCRM.UI._DetailView.prototype.insertItems=function(items,index){var data={};data.action="insertMultiple";data.viewName=this.name;data.index=(typeof(index)!=="undefined")?index:-1;data.items=items;MobileCRM.bridge.command("detailViewAction",JSON.stringify(data));};MobileCRM.UI._DetailView.prototype.removeItem=function(index){var data={action:"delete",viewName:this.name,index:index};MobileCRM.bridge.command("detailViewAction",JSON.stringify(data));};MobileCRM.UI._DetailView.prototype.removeItems=function(indexes){var data={action:"delete",viewName:this.name,index:indexes};MobileCRM.bridge.command("detailViewAction",JSON.stringify(data));};MobileCRM.UI._DetailView.prototype.startEditItem=function(index){if(index<0){MobileCRM.bridge.log("DetailView.startEditItem: Index must not be negative.");return;}
var data={action:"startEditItem",viewName:this.name,index:index};MobileCRM.bridge.command("detailViewAction",JSON.stringify(data));};MobileCRM.UI._DetailView.prototype.updateComboItemDataSource=function(index,listDataSource,valueType,defaultValue){var data={action:"updateDataSource",viewName:this.name,index:index,listDataSource:listDataSource,value:defaultValue||listDataSource[Object.keys(listDataSource)[0]],listDataSourceValueType:valueType};MobileCRM.bridge.command("detailViewAction",JSON.stringify(data));};MobileCRM.UI._DetailView.prototype.updateLinkItemViews=function(index,dialogSetup,inlinePickSetup,dialogOnly){var xml="<lookup>";xml+=dialogSetup._serialize();if(!dialogOnly&&inlinePickSetup)
xml+=inlinePickSetup._serialize();xml+="<dialog>"+(dialogOnly?1:0)+"</dialog>";xml+="</lookup>";var data={action:"updateLookupFilter",viewName:this.name,index:index,views:xml};MobileCRM.bridge.command("detailViewAction",JSON.stringify(data));};MobileCRM.UI.DetailViewItems.LookupSetup=function(){this._views=[];this._filters=null;this.dialogOnly=false;};MobileCRM.UI.DetailViewItems.LookupSetup.prototype.addView=function(entityName,viewName,isDefault){this._views.push({entity:entityName,view:viewName,isDefault:isDefault});};MobileCRM.UI.DetailViewItems.LookupSetup.prototype.addFilter=function(entityName,filterXml){if(!this._filters)
this._filters={};this._filters[entityName]=filterXml;};MobileCRM.UI.DetailViewItems.LookupSetup.prototype._serialize=function(){var _escape=function(st){var xml_special_to_escaped_one_map={'<':'&lt;','>':'&gt;'};return st.replace(/([<>])/g,function(str,item){return xml_special_to_escaped_one_map[item];});};var firstOne=true;var xml="<extra><views>";if(this._views.length>0){for(var i in this._views){var view=this._views[i];var entityName=view.entity;if(firstOne)
firstOne=false;else
xml+=":";xml+=_escape(entityName+(view.isDefault?".@":".")+view.view);}}
xml+="</views>";if(this._filters){for(var entity in this._filters){var filter=this._filters[entity];xml+="<filter entity='"+entity+"'>"+_escape(filter)+"</filter>";}}
xml+="</extra>";return xml;};MobileCRM.UI._DetailView.prototype.registerClickHandler=function(item,callback,scope){if(!MobileCRM.UI._DetailView._handlers){MobileCRM.UI._DetailView._handlers=[];}
var handlers=MobileCRM.UI._DetailView._handlers;var index=this.name+"."+item.name;handlers[index]={handler:callback,scope:scope};};MobileCRM.UI._DetailView._callHandler=function(viewName,itemName){var index=viewName+"."+itemName;var handlerDescriptor=MobileCRM.UI._DetailView._handlers[index];if(handlerDescriptor&&handlerDescriptor.handler){if(handlerDescriptor.scope)
handlerDescriptor.handler.apply(handlerDescriptor.scope,itemName,viewName);else
handlerDescriptor.handler(itemName,viewName);}};_inherit(MobileCRM.UI.DetailViewItems.SeparatorItem,MobileCRM.UI.DetailViewItems.Item);_inherit(MobileCRM.UI.DetailViewItems.TextBoxItem,MobileCRM.UI.DetailViewItems.Item);_inherit(MobileCRM.UI.DetailViewItems.NumericItem,MobileCRM.UI.DetailViewItems.Item);_inherit(MobileCRM.UI.DetailViewItems.CheckBoxItem,MobileCRM.UI.DetailViewItems.Item);_inherit(MobileCRM.UI.DetailViewItems.DateTimeItem,MobileCRM.UI.DetailViewItems.Item);_inherit(MobileCRM.UI.DetailViewItems.DurationItem,MobileCRM.UI.DetailViewItems.Item);_inherit(MobileCRM.UI.DetailViewItems.ComboBoxItem,MobileCRM.UI.DetailViewItems.Item);_inherit(MobileCRM.UI.DetailViewItems.LinkItem,MobileCRM.UI.DetailViewItems.Item);MobileCRM.UI.ViewController.createCommand=function(primary,labels,callback,scope){var cmdId=MobileCRM.bridge._createCmdObject(callback,null,scope);if(typeof labels=="string")
labels=[labels];MobileCRM.bridge.command("createCommand",JSON.stringify({commandId:cmdId,primary:primary,labels:labels}));};_inherit(MobileCRM.UI.ProcessController,MobileCRM.ObservableObject);MobileCRM.UI.ProcessController.prototype.changeProcess=function(processRef,errorCallback,scope){var controller=MobileCRM.bridge.exposeObjectAsync("EntityForm.GetController",[this.view.name]);controller.invokeMethodAsync("ChangeProcessTo",[processRef],function(){},errorCallback,scope);controller.release();};MobileCRM.UI.ViewDefinition.loadEntityViews=function(entityName,callback,errorCallback,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm.UI","MobileCrm.UI.ViewParser","LoadListViews",[entityName],callback,errorCallback,scope);};MobileCRM.UI.MessageBox.prototype.show=function(success,failed,scope){MobileCRM.bridge.command("messageBox",JSON.stringify(this),success,failed,scope);};MobileCRM.UI.MessageBox.sayText=function(text,success,failed,scope){var mb=new MobileCRM.UI.MessageBox(text);mb.items=["OK"];mb.multiLine=true;mb.show(success,failed,scope);};MobileCRM.UI.LookupForm.prototype.addView=function(entityName,viewName,isDefault){this._views.push({entity:entityName,view:viewName,isDefault:isDefault});};MobileCRM.UI.LookupForm.prototype.addEntityFilter=function(entityName,filterXml){if(!this._filters)
this._filters={};this._filters[entityName]=filterXml;};MobileCRM.UI.LookupForm.prototype.show=function(success,failed,scope){MobileCRM.bridge.command("lookupForm",JSON.stringify(this._constructParams()),success,failed,scope);};MobileCRM.UI.LookupForm.prototype._constructParams=function(){var _escape=function(st){var xml_special_to_escaped_one_map={'<':'&lt;','>':'&gt;'};return st.replace(/([<>])/g,function(str,item){return xml_special_to_escaped_one_map[item];});};var obsoleteViews,obsoleteFilters;if(this.allowedViews){if(this.allowedViews[0]=="<")
obsoleteFilters=this.allowedViews;else
obsoleteViews=this.allowedViews;}
var firstOne=true;var xml="<extra><views>";if(this._views.length>0){for(var i in this._views){var view=this._views[i];var entityName=view.entity;if(this.entities.indexOf(entityName)<0)
this.entities.push(entityName);if(firstOne)
firstOne=false;else
xml+=":";xml+=_escape(entityName+(view.isDefault?".@":".")+view.view);}}
if(obsoleteViews){if(!firstOne)
xml+=":";xml+=_escape(this.allowedViews);}
xml+="</views>";if(this._filters){for(var entity in this._filters){var filter=this._filters[entity];xml+="<filter entity='"+entity+"'>"+_escape(filter)+"</filter>";}}
else if(obsoleteFilters&&this.entities.length>0)
xml+="<filter entity='"+this.entities[0]+"'>"+_escape(obsoleteFilters)+"</filter>";xml+="</extra>";return{entities:this.entities,source:this.source,prevSelection:this.prevSelection,allowedViews:xml,allowNull:this.allowNull,preventClose:this.preventClose};};_inherit(MobileCRM.UI.MultiLookupForm,MobileCRM.UI.LookupForm);MobileCRM.UI.MultiLookupForm.prototype.show=function(success,failed,scope){var params=this._constructParams();params.dataSource=this.dataSource;MobileCRM.bridge.command("multiLookupForm",JSON.stringify(params),success,failed,scope);};_inherit(MobileCRM.UI.Form,MobileCRM.ObservableObject);MobileCRM.UI.Form.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("Form",function(obj){if(callback.call(scope,obj)!=false){var changed=obj.getChanged();return changed;}
return'';},errorCallback,scope);};MobileCRM.UI.Form.showPleaseWait=function(caption){var obj=MobileCRM.bridge.exposeObjectAsync("Form.ShowPleaseWait",[caption]);return{close:function(){obj.invokeMethodAsync("Dispose",[]);obj.release();}};};MobileCRM.UI.Form.showToast=function(message,icon){MobileCRM.bridge.invokeStaticMethodAsync("Resco.UI","Resco.UI.FormFactory","ShowToastInfo.Invoke",[message,icon]);};_inherit(MobileCRM.UI.HomeForm,MobileCRM.ObservableObject);MobileCRM.UI.HomeForm.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("HomeForm",function(obj){obj.lastSyncResult=new MobileCRM.Services.SynchronizationResult(obj.lastSyncResult);delete obj._privChanged.lastSyncResult;if(callback.call(scope,obj)!=false){var changed=obj.getChanged();return changed;}
return'';},errorCallback,scope);};MobileCRM.UI.HomeForm.openHomeItemAsync=function(name,errorCallback,scope){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.HomeForm","Instance.ShowHomeItemByName",[name],null,errorCallback,scope);};MobileCRM.UI.HomeForm.openHomeGroupItemAsync=function(items,errorCallback,scope){var path="";for(var i in items)
path+="\\"+items[i];MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.HomeForm","Instance.ShowHomeGroupItem",[path],null,errorCallback,scope);};MobileCRM.UI.HomeForm.updateHomeItemAsync=function(items,title,subTitle,badge,errorCallback,scope){var path="";for(var i in items)
path+="\\"+items[i];MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.HomeForm","Instance.UpdateHomeItem",[path,title,subTitle,badge],null,errorCallback,scope);};MobileCRM.UI.HomeForm.updateHomeItems=function(items){MobileCRM.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.HomeForm","Instance.UpdateHomeItems",[JSON.stringify(items)]);};MobileCRM.UI.HomeForm.closeHomeItemAsync=function(name,errorCallback,scope){MobileCRM.UI.HomeForm.requestObject(function(homeForm){for(var i in homeForm.items){var item=homeForm.items[i];if(item.name==name){var item=MobileCRM.bridge.exposeObjectAsync("HomeForm.Items.get_Item",[i]);item.invokeMethodAsync("CloseForm",[],null,errorCallback,scope);item.release();return;}}},errorCallback,scope);};MobileCRM.UI.HomeForm.closeForms=function(callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("HomeForm","TryCloseForms",[false],function(){callback.call(scope);},errorCallback,scope);}
MobileCRM.UI.HomeForm.hideUIReplacement=function(){MobileCRM.bridge.invokeMethodAsync("HomeForm","HideUIReplacement",[]);};MobileCRM.UI.HomeForm.restoreUIReplacement=function(){MobileCRM.bridge.invokeMethodAsync("HomeForm","RestoreUIReplacement",[]);};MobileCRM.UI.HomeForm._syncFinishedCallbacks=[];MobileCRM.UI.HomeForm.onSyncFinished=function(handler,scope){_bindHandler(handler,MobileCRM.UI.HomeForm._syncFinishedCallbacks,true,scope);};MobileCRM.UI.HomeForm._raiseSyncFinished=function(homeForm){var handlers=MobileCRM.UI.HomeForm._syncFinishedCallbacks;if(handlers&&handlers.length>0){var result='';homeForm.lastSyncResult=new MobileCRM.Services.SynchronizationResult(homeForm.lastSyncResult);delete homeForm._privChanged.lastSyncResult;if(_callHandlers(handlers,homeForm)!=false){var changed=homeForm.getChanged();result=JSON.stringify(changed);}
return result;}}
MobileCRM.UI.ReportForm.prototype.show=function(success,failed,scope){var params={allowedReportIds:this.allowedReportIds,allowedLanguages:this.allowedLanguages,defaultReport:this.defaultReport};MobileCRM.bridge.command("showReport",JSON.stringify(params),success,failed,scope);};MobileCRM.MobileReport.runReport=function(fetch,reportXML,reportFormat,isExportOnly,isOnline,outputFile,success,failed,scope){var params={SourceFetch:fetch,ReportFormat:reportFormat||"Pdf",IsExportOnly:isExportOnly,IsOnline:isOnline};if(reportXML)
params.ReportXml=reportXML;if(outputFile)
params.OutputFile=outputFile;MobileCRM.bridge.command("runMobileReportAsync",JSON.stringify(params),success,failed,scope);};MobileCRM.MobileReport.showForm=function(entity,source,fetchXml,failed,scope){if(typeof(entity)=="string")
entity=new MobileCRM.Reference(entity,null,null);var params={fetchXml:fetchXml,entityName:entity.entityName,entity:entity,source:source};MobileCRM.bridge.command("showMobileReportForm",JSON.stringify(params),null,failed,scope);};MobileCRM.Questionnaire.showForm=function(id,failed,scope){var params={id:id};MobileCRM.bridge.command("showQuestionnaire",JSON.stringify(params),null,failed,scope);};function _padTo3digits(num){var st=""+num;while(st.length<3)
st="0"+st;return st;}
MobileCRM.Questionnaire.getQuestionName=function(name,repeatIndex){return repeatIndex?(name+"#"+_padTo3digits(repeatIndex)):name;}
MobileCRM.Questionnaire.getGroupName=function(name,repeatIndex){return repeatIndex?(name+"#"+_padTo3digits(repeatIndex)):name;}
_inherit(MobileCRM.UI.IFrameForm,MobileCRM.ObservableObject);MobileCRM.UI.IFrameForm.showModal=function(caption,url,options){MobileCRM.bridge.command("showIFrame",JSON.stringify({caption:caption,url:url,modal:true,options:options}));};MobileCRM.UI.IFrameForm.show=function(caption,url,maximized,options){MobileCRM.bridge.command("showIFrame",JSON.stringify({caption:caption,url:url,modal:false,maximized:maximized,options:options}));};MobileCRM.UI.IFrameForm.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("IFrameForm",function(obj){if(callback.call(scope,obj)!=false){var changed=obj.getChanged();return changed;}
return'';},errorCallback,scope);};MobileCRM.UI.IFrameForm.setDirty=function(dirty){MobileCRM.bridge.invokeMethodAsync("IFrameForm","set_IsDirty",[dirty===false?false:true]);};MobileCRM.UI.IFrameForm.preventClose=function(message){MobileCRM.bridge.invokeMethodAsync("IFrameForm","set_PreventCloseMessage",[message]);};MobileCRM.UI.IFrameForm._handlers={onSave:[]};MobileCRM.UI.IFrameForm.onSave=function(handler,bind,scope){var handlers=MobileCRM.UI.IFrameForm._handlers.onSave;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("InstallSaveCommand");};var _pendingIFrameSaveId=0;MobileCRM.UI.IFrameForm.prototype.suspendSave=function(){var cmdId="IFramePendingValidation"+(++_pendingIFrameSaveId);var self=this;self.context.pendingSaveCommand=cmdId;return{resumeSave:function(result){if(self._inCallback){self.context.errorMessage=result;self.context.pendingSaveCommand=null;}
else
MobileCRM.bridge.command(cmdId,result);}};}
MobileCRM.UI.IFrameForm._callHandlers=function(event,data,context){var handlers=MobileCRM.UI.IFrameForm._handlers[event];if(handlers&&handlers.length>0){data.context=context;data._inCallback=true;var result='';if(_callHandlers(handlers,data)!=false){var changed=data.getChanged();result=JSON.stringify(changed);}
data._inCallback=false;return result;}};_inherit(MobileCRM.UI.EntityList,MobileCRM.ObservableObject);MobileCRM.UI.EntityList._handlers={onCanExecute:[],onCommand:[],onSave:[],onChange:[],onClick:[]};MobileCRM.UI.EntityList._callHandlers=function(event,data,context){var handlers=MobileCRM.UI.EntityList._handlers[event];if(handlers&&handlers.length>0){data.context=context;data._inCallback=true;var result='';if(_callHandlers(handlers,data)!=false){var changed=data.getChanged();result=JSON.stringify(changed);}
data._inCallback=false;return result;}};MobileCRM.UI.EntityList.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("EntityList",function(obj){if(callback.call(scope,obj)!=false){var changed=obj.getChanged();return changed;}
return'';},errorCallback,scope);};MobileCRM.UI.EntityList.selectView=function(viewName){var viewFilter=MobileCRM.bridge.exposeObjectAsync("EntityList.FilterGroup.get_Item",["View"]);viewFilter.invokeMethodAsync("SetSelection",[viewName,false]);viewFilter.release();MobileCRM.UI.EntityList.reload();};MobileCRM.UI.EntityList.requestEditedEntities=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("EditedEntities",function(entities){if(callback.call(scope,entities.items)!=false){var changed=entities.getChanged();return changed;}
return'';},errorCallback);};MobileCRM.UI.EntityList.onCommand=function(command,handler,bind,scope){var handlers=MobileCRM.UI.EntityList._handlers[command];if(!handlers)
handlers=MobileCRM.UI.EntityList._handlers[command]=[];_bindHandler(handler,handlers,bind,scope);var action=((bind==false&&handlers.length==0)?"cmdDel":"cmd");MobileCRM.bridge.command("registerListEvents",action+":"+command);};MobileCRM.UI.EntityList.runCommand=function(commandName,parameter,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityList","RunCommand",[commandName,parameter],null,errorCallback,scope);};MobileCRM.UI.EntityList.reload=function(){MobileCRM.bridge.invokeMethodAsync("EntityList","Reload",[]);}
MobileCRM.UI.EntityList.setPrimaryCommand=function(labels,callback,scope){MobileCRM.UI.ViewController.createCommand(true,labels,callback,scope);};MobileCRM.UI.EntityList.setEntityProperty=function(rowIndex,propertyName,editValue,saveImmediately,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityList","FinishListEditByName",[rowIndex,propertyName,editValue,saveImmediately?MobileCRM.UI.EntityListCellAction.DirectEdit:0],null,errorCallback,scope);};MobileCRM.UI.EntityList.startEditCell=function(rowIndex,cellIndex,saveImmediately,binding,errorCallback,scope){var method="StartListEdit";var ps=[rowIndex,cellIndex,saveImmediately?MobileCRM.UI.EntityListCellAction.DirectEdit:0,binding];if(isNaN(+cellIndex)){method="StartListEditByName";ps=ps.slice(0,3);}
MobileCRM.bridge.invokeMethodAsync("EntityList",method,ps,null,errorCallback,scope);};MobileCRM.UI.EntityList.clickCell=function(rowIndex,cellIndex,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityList","StartListEdit",[rowIndex,cellIndex,MobileCRM.UI.EntityListCellAction.Clickable,null],null,errorCallback,scope);};MobileCRM.UI.EntityList.setDataSource=function(dataSource){MobileCRM.UI.EntityList._dataSource=dataSource;};MobileCRM.UI.EntityList.setDataSourceFactory=function(dataSourceFactory){MobileCRM.UI.EntityList._dataSourceFactory=dataSourceFactory;};MobileCRM.UI.EntityList._dataSourceMap={};MobileCRM.UI.EntityList._initDataSource=function(chunkReadyCmdId,fetch){var result={};var dataSource=MobileCRM.UI.EntityList._dataSource;var factory=MobileCRM.UI.EntityList._dataSourceFactory;if(!dataSource&&factory)
dataSource=factory();if(dataSource){dataSource._chunkReadyCmdId=chunkReadyCmdId;dataSource.fetch=fetch;result={chunkSize:dataSource.chunkSize||50};MobileCRM.UI.EntityList._dataSourceMap[chunkReadyCmdId]=dataSource;}
return JSON.stringify(result);};MobileCRM.UI.EntityList._loadNextChunk=function(page,count,chunkReadyCmdId){var ds;if(chunkReadyCmdId){ds=MobileCRM.UI.EntityList._dataSourceMap[chunkReadyCmdId];}
if(!ds)
ds=MobileCRM.UI.EntityList._dataSource;if(ds&&typeof ds.loadNextChunk=="function"){try{var fetch=ds.fetch;fetch.page=page;fetch.count=count;ds.loadNextChunk(page,count);return"OK";}catch(e){return e.message;}}
return"Invalid ListDataSource";};var _pendingListSaveId=0;MobileCRM.UI.EntityList.prototype.suspendSave=function(){var cmdId="EntityListPendingValidation"+(++_pendingListSaveId);var self=this;self.context.pendingSaveCommand=cmdId;return{resumeSave:function(result){if(self._inCallback){self.context.errorMessage=result;self.context.pendingSaveCommand=null;}
else
MobileCRM.bridge.command(cmdId,result);}};};MobileCRM.UI.EntityList.onSave=function(handler,bind,scope){var handlers=MobileCRM.UI.EntityList._handlers.onSave;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onSave");}
MobileCRM.UI.EntityList.onChange=function(handler,bind,scope){var handlers=MobileCRM.UI.EntityList._handlers.onChange;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onChange");}
MobileCRM.UI.EntityList.onClick=function(handler,bind,scope){var handlers=MobileCRM.UI.EntityList._handlers.onClick;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onClick");}
MobileCRM.UI.EntityListClickContext=function(){}
MobileCRM.UI.EntityListClickEvent=function(){};MobileCRM.UI.EntityListCellAction=function(){};MobileCRM.UI.EntityListCellAction.Text=0;MobileCRM.UI.EntityListCellAction.Image=1;MobileCRM.UI.EntityListCellAction.Button=2;MobileCRM.UI.EntityListCellAction.InlineButton=3;MobileCRM.UI.EntityListCellAction.Editable=0x1000;MobileCRM.UI.EntityListCellAction.Clickable=0x2000;MobileCRM.UI.EntityListCellAction.DirectEdit=0x4000|MobileCRM.UI.EntityListCellAction.Editable;MobileCRM.UI.EntityListCellAction.ActionMask=0xF000;MobileCRM.UI.TourplanViewMode=function(){}
MobileCRM.UI.TourplanViewMode.Agenda=0;MobileCRM.UI.TourplanViewMode.Day=1;MobileCRM.UI.TourplanViewMode.Week=2;MobileCRM.UI.TourplanViewMode.Month=3;MobileCRM.UI.ListDataSource=function(){this.chunkSize=50;this.fetch=null;this.loadNextChunk=null;this._chunkReadyCmdId=null;};MobileCRM.UI.ListDataSource.prototype.chunkReady=function(entities){MobileCRM.bridge.command(this._chunkReadyCmdId,JSON.stringify(entities));};_inherit(MobileCRM.UI.QuestionnaireForm,MobileCRM.ObservableObject);MobileCRM.UI.QuestionnaireForm._handlers={onChange:[],onSave:[],onPostSave:[],onRepeatGroup:[],onDeleteGroup:[]};MobileCRM.UI.QuestionnaireForm.prototype.cancelValidation=function(errorMsg){this.context.errorMessage=errorMsg||"";};var _pendingSaveId=0;MobileCRM.UI.QuestionnaireForm.prototype.suspendSave=function(){var cmdId="QuestionnaireFormPendingValidation"+(++_pendingSaveId);var _this=this;_this.context.pendingSaveCommand=cmdId;return{resumeSave:function(result){if(_this._inCallback){_this.context.errorMessage=result;_this.context.pendingSaveCommand=null;}
else
MobileCRM.bridge.command(cmdId,result);}};};MobileCRM.UI.QuestionnaireForm.onSave=function(handler,bind,scope){var handlers=MobileCRM.UI.QuestionnaireForm._handlers.onSave;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onSave");}
MobileCRM.UI.QuestionnaireForm.onChange=function(handler,bind,scope){var handlers=MobileCRM.UI.QuestionnaireForm._handlers.onChange;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onChange");}
MobileCRM.UI.QuestionnaireForm.onAnswerChanged=function(questionName,handler,bind,scope){var handlerName="onChange:"+questionName;var handlers=MobileCRM.UI.QuestionnaireForm._handlers[handlerName];if(!handlers)
MobileCRM.UI.QuestionnaireForm._handlers[handlerName]=handlers=[];var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents",handlerName);}
MobileCRM.UI.QuestionnaireForm.onRepeatGroup=function(handler,bind,scope){var handlers=MobileCRM.UI.QuestionnaireForm._handlers.onRepeatGroup;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onRepeatGroup");}
MobileCRM.UI.QuestionnaireForm.onDeleteGroup=function(handler,bind,scope){var handlers=MobileCRM.UI.QuestionnaireForm._handlers.onDeleteGroup;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onDeleteGroup");}
MobileCRM.UI.QuestionnaireForm.onPostSave=function(handler,bind,scope){var handlers=MobileCRM.UI.QuestionnaireForm._handlers.onPostSave;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onPostSave");}
var _pendingQFPostSaveId=0;MobileCRM.UI.QuestionnaireForm.prototype.suspendPostSave=function(){var cmdId="QuestionnaireFormPendingPostSave"+(++_pendingQFPostSaveId);var _this=this;_this.context.pendingPostSaveCommand=cmdId;return{resumePostSave:function(){if(_this._inCallback){_this.context.pendingPostSaveCommand=null;}
else
MobileCRM.bridge.command(cmdId);}};};MobileCRM.UI.QuestionnaireForm.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("QuestionnaireForm",function(obj){if(callback.call(scope,obj)!=false){var changed=obj.getChanged();return changed;}
return'';},errorCallback,scope);}
MobileCRM.UI.QuestionnaireForm._callHandlers=function(event,data,context){var handlers=MobileCRM.UI.QuestionnaireForm._handlers[event];if(handlers&&handlers.length>0){data.context=context;data._inCallback=true;var result='';if(_callHandlers(handlers,data)!=false){var changed=data.getChanged();result=JSON.stringify(changed);}
data._inCallback=false;return result;}};MobileCRM.UI.QuestionnaireForm.prototype.findGroupById=function(groupId){return _findInArray(this.groups,"id",groupId);};MobileCRM.UI.QuestionnaireForm.prototype.findGroupByName=function(groupName){return _findInArray(this.groups,"name",groupName);};MobileCRM.UI.QuestionnaireForm.prototype.findQuestionById=function(id){return _findInArray(this.questions,"id",id);};MobileCRM.UI.QuestionnaireForm.prototype.findQuestionByName=function(name){return _findInArray(this.questions,"name",name);};MobileCRM.UI.QuestionnaireForm.trySetAnswer=function(questionName,answer,errorCallback,scope){var val=typeof(answer)=="object"?JSON.stringify(answer):answer;MobileCRM.bridge.invokeMethodAsync("QuestionnaireForm","TrySetAnswer",[questionName,val],null,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.focusQuestion=function(questionName,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("QuestionnaireForm","FocusQuestion",[questionName],null,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.overridePicklistOptions=function(questionName,allowNull,options,errorCallback,scope){var optionsSt="";if(typeof options=="string")
optionsSt=options;else{for(var key in options){if(optionsSt)
optionsSt+=";";optionsSt+=options[key]+";"+key;}}
MobileCRM.bridge.invokeMethodAsync("QuestionnaireForm","OverridePicklistOptions",[questionName,allowNull?true:false,optionsSt],null,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.changeLookupQuestionSetup=function(questionName,dialogSetup,inlinePickSetup,dialogOnly,errorCallback,scope){var xml="<lookup>";xml+=dialogSetup._serialize();if(!dialogOnly&&inlinePickSetup)
xml+=inlinePickSetup._serialize();xml+="<dialog>"+(dialogOnly?1:0)+"</dialog>";xml+="</lookup>";MobileCRM.bridge.invokeMethodAsync("QuestionnaireForm","ChangeLookupViews",[questionName,xml],null,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.repeatGroup=function(groupId,copyValues,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("QuestionnaireForm","RepeatGroup",[groupId,copyValues],null,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.deleteGroup=function(groupId,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("QuestionnaireForm","DeleteGroup",[groupId],null,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.Group=function(){MobileCRM.UI.QuestionnaireForm.Group.superproto.constructor.apply(this,arguments);};_inherit(MobileCRM.UI.QuestionnaireForm.Group,MobileCRM.ObservableObject);MobileCRM.UI.QuestionnaireForm.Group.prototype.repeatGroup=function(copyValues,errorCallback,scope){MobileCRM.UI.QuestionnaireForm.repeatGroup(this.id,copyValues,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.Group.prototype.deleteGroup=function(errorCallback,scope){MobileCRM.UI.QuestionnaireForm.deleteGroup(this.id,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.Question=function(){MobileCRM.UI.QuestionnaireForm.Question.superproto.constructor.apply(this,arguments);};_inherit(MobileCRM.UI.QuestionnaireForm.Question,MobileCRM.ObservableObject);MobileCRM.UI.QuestionnaireForm.Question.prototype.trySetAnswer=function(answer,errorCallback,scope){MobileCRM.UI.QuestionnaireForm.trySetAnswer(this.name,answer,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.Question.prototype.focus=function(errorCallback,scope){MobileCRM.UI.QuestionnaireForm.focusQuestion(this.name,errorCallback,scope);};MobileCRM.UI.QuestionnaireForm.getQuestionnaireEntity=function(callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("QuestionnaireForm","get_Questionnaire",[],callback,errorCallback,scope);};_inherit(MobileCRM.UI.EntityForm,MobileCRM.ObservableObject);MobileCRM.UI.EntityForm._handlers={onChange:[],onSave:[],onPostSave:[],onDetailCollectionChange:[],onSelectedViewChanged:[]};MobileCRM.UI.EntityForm.prototype.getDetailView=function(name){var detailViews=this.detailViews;if(detailViews){var nItems=detailViews.length;for(var i=0;i<nItems;i++){var item=detailViews[i];if(item.name==name)
return item;}}
return undefined;};MobileCRM.UI.EntityForm.prototype.getController=function(name){var controllers=this.controllers;if(controllers){var nItems=controllers.length;for(var i=0;i<nItems;i++){var item=controllers[i];if(item.view&&item.view.name==name)
return item;}}
return undefined;};MobileCRM.UI.EntityForm.prototype.updateAddressFields=function(latitude,longitude){var detailViewController=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[0]);detailViewController.invokeMethodAsync("UpdateAddress",[latitude,longitude]);detailViewController.release();};MobileCRM.UI.EntityForm.prototype.cancelValidation=function(errorMsg){this.context.errorMessage=errorMsg||"";};MobileCRM.UI.EntityForm.prototype.selectTab=function(tabName,errorCallback,scope){MobileCRM.UI.EntityForm.selectTabEx(tabName,function(){},errorCallback,scope);};MobileCRM.UI.EntityForm.selectTabEx=function(tabName,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","FindView",[tabName],function(index){if(index<0){if(errorCallback)
errorCallback.call(scope,tabName+" view not found");}
else
MobileCRM.bridge.invokeMethodAsync("EntityForm","Form.set_SelectedViewIndex",[index],callback,errorCallback,scope);},errorCallback,scope);};MobileCRM.UI.EntityForm.loadTab=function(tabName,isLoaded,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","LoadView",[tabName,isLoaded],callback,errorCallback,scope);};MobileCRM.UI.EntityForm.prototype.selectView=function(tabName,viewName){var controllers=this.controllers;for(var i=0;i<controllers.length;i++){var controller=controllers[i];var view=controller.view;if(view&&view.name==tabName){var list=MobileCRM.bridge.exposeObjectAsync("EntityForm.Controllers.get_Item",[i]);var viewFilter=list.exposeObjectAsync("List.FilterGroup.get_Item",["View"]);viewFilter.invokeMethodAsync("SetSelection",[viewName,false]);viewFilter.release();list.invokeMethodAsync("List.Reload",[]);list.release();return true;}}
var assocViews=this.associatedViews;for(var i=0;i<assocViews.length;i++){var assocView=assocViews[i];var view=assocView.listView;if(view&&view.name==tabName){var list=MobileCRM.bridge.exposeObjectAsync("EntityForm.AssociatedViews.get_Item",[i]);var viewFilter=list.exposeObjectAsync("FilterGroup.get_Item",["View"]);viewFilter.invokeMethodAsync("SetSelection",[viewName,false]);viewFilter.release();list.invokeMethodAsync("Reload",[]);list.release();return true;}}
return false;};MobileCRM.UI.EntityForm.prototype.setTabVisibility=function(tabName,visible){var controllers=this.controllers;for(var i=0;i<controllers.length;i++){var controller=controllers[i];var view=controller.view;if(view&&view.name==tabName){view.isVisible=visible;if(controller.hasOwnProperty("isLoaded")&&controller.isLoaded===false)
controller.isLoaded=true;return true;}}
var assocViews=this.associatedViews;for(var i=0;i<assocViews.length;i++){var assocView=assocViews[i];var view=assocView.listView;if(view&&view.name==tabName){view.isVisible=visible;return true;}}
var detailViews=this.detailViews;for(var i=0;i<detailViews.length;i++){var detailView=detailViews[i];if(detailView.name==tabName){detailView.isVisible=visible;return true;}}
return false;};MobileCRM.UI.EntityForm.prototype.getMediaTab=function(name){var controllers=this.controllers;for(var i=0;i<controllers.length;i++){var controller=controllers[i];var view=controller.view;if(view&&view.name==name){if(controller.hasOwnProperty("isLoaded")&&controller.isLoaded===false)
controller.isLoaded=true;return new MobileCRM.UI.MediaTab(i,name);}}
return null;};var _pendingSaveId=0;MobileCRM.UI.EntityForm.prototype.suspendSave=function(){var cmdId="EntityFormPendingValidation"+(++_pendingSaveId);var entityForm=this;entityForm.context.pendingSaveCommand=cmdId;return{resumeSave:function(result){if(entityForm._inCallback){entityForm.context.errorMessage=result;entityForm.context.pendingSaveCommand=null;}
else
MobileCRM.bridge.command(cmdId,result);}};};MobileCRM.UI.EntityForm.onSave=function(handler,bind,scope){var handlers=MobileCRM.UI.EntityForm._handlers.onSave;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onSave");}
MobileCRM.UI.EntityForm.onChange=function(handler,bind,scope){var handlers=MobileCRM.UI.EntityForm._handlers.onChange;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onChange");}
MobileCRM.UI.EntityForm.onItemChange=function(itemName,handler,bind,scope){var handlerName="onChange:"+itemName;var handlers=MobileCRM.UI.EntityForm._handlers[handlerName];if(!handlers)
MobileCRM.UI.EntityForm._handlers[handlerName]=handlers=[];var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents",handlerName);}
MobileCRM.UI.EntityForm.onPostSave=function(handler,bind,scope){var handlers=MobileCRM.UI.EntityForm._handlers.onPostSave;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onPostSave");}
var _pendingPostSaveId=0;MobileCRM.UI.EntityForm.prototype.suspendPostSave=function(){var cmdId="EntityFormPendingPostSave"+(++_pendingPostSaveId);var entityForm=this;entityForm.context.pendingPostSaveCommand=cmdId;return{resumePostSave:function(){if(entityForm._inCallback){entityForm.context.pendingPostSaveCommand=null;}
else
MobileCRM.bridge.command(cmdId);}};};MobileCRM.UI.EntityForm.onSelectedViewChanged=function(handler,bind,scope){var handlers=MobileCRM.UI.EntityForm._handlers.onSelectedViewChanged;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onSelectedViewChanged");}
MobileCRM.UI.EntityForm.loadTab=function(tabName,load,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","LoadView",[tabName,load],function(index){},errorCallback,scope);};MobileCRM.UI.EntityForm.requestObject=function(callback,errorCallback,scope){MobileCRM.bridge.requestObject("EntityForm",function(obj){if(callback.call(scope,obj)!=false){var changed=obj.getChanged();return changed;}
return'';},errorCallback,scope);}
MobileCRM.UI.EntityForm._callHandlers=function(event,data,context){var handlers=MobileCRM.UI.EntityForm._handlers[event];if(handlers&&handlers.length>0){data.context=context;data._inCallback=true;var result='';if(_callHandlers(handlers,data)!=false){var changed=data.getChanged();result=JSON.stringify(changed);}
data._inCallback=false;return result;}}
MobileCRM.UI.EntityForm._callCmdHandlers=function(event,data,context){var handlers=MobileCRM.UI.EntityForm._handlers[event];if(handlers&&handlers.length>0){data.context=context;var res=_callHandlers(handlers,data);return typeof(res)=="string"?res:JSON.stringify(res);}
return null;}
MobileCRM.UI.EntityForm.executeCommandByName=function(command,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","ExecuteCommandByName",[command],callback,errorCallback,scope);}
MobileCRM.UI.EntityForm.onCommand=function(command,handler,bind,scope){var handlers=MobileCRM.UI.EntityForm._handlers[command];if(!handlers)
handlers=MobileCRM.UI.EntityForm._handlers[command]=[];_bindHandler(handler,handlers,bind,scope);var action=((bind==false&&handlers.length==0)?"cmdDel":"cmd");MobileCRM.bridge.command("registerEvents",action+":"+command);}
MobileCRM.UI.EntityForm.onCanExecuteCommand=function(command,handler,bind,scope){var handlerName="CanExecute_"+command;var handlers=MobileCRM.UI.EntityForm._handlers[handlerName];if(!handlers)
handlers=MobileCRM.UI.EntityForm._handlers[handlerName]=[];_bindHandler(handler,handlers,bind,scope);var action=((bind==false&&handlers.length==0)?"cmdEnabledDel":"cmdEnabled");MobileCRM.bridge.command("registerEvents",action+":"+command);}
MobileCRM.UI.EntityForm.enableCommand=function(command,enable,iParam){if(typeof iParam!="undefined")
command+="/"+iParam;MobileCRM.bridge.invokeMethodAsync("EntityForm","EnableCommandByName",[command,enable]);};MobileCRM.UI.EntityForm.refreshForm=function(){MobileCRM.bridge.invokeMethodAsync("EntityForm","ReloadForm",[]);};MobileCRM.UI.EntityForm.saveAndClose=function(){MobileCRM.bridge.invokeMethodAsync("EntityForm","SaveAndClose",[true]);};MobileCRM.UI.EntityForm.save=function(){MobileCRM.bridge.invokeMethodAsync("EntityForm","InternalSave",[false]);};MobileCRM.UI.EntityForm.closeWithoutSaving=function(){MobileCRM.bridge.invokeMethodAsync("EntityForm","SaveAndClose",[false]);};MobileCRM.UI.EntityForm.prototype.reactivateEntity=function(statuscode){this.entity.properties.statuscode=statuscode;MobileCRM.bridge.invokeMethodAsync("EntityForm","OnEntityStateChanged",[]);MobileCRM.UI.EntityForm.save();}
MobileCRM.UI.EntityForm.showPleaseWait=function(caption){var obj=MobileCRM.bridge.exposeObjectAsync("EntityForm.Form.ShowPleaseWait",[caption]);return{close:function(){obj.invokeMethodAsync("Dispose",[]);obj.release();}};};MobileCRM.UI.EntityForm.maximizeView=function(viewName,maximize){MobileCRM.bridge.invokeMethodAsync("EntityForm","MaximizeView",[viewName,maximize]);};MobileCRM.UI.EntityForm.isViewMaximized=function(viewName,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","IsViewMaximized",[viewName],callback,errorCallback,scope);};MobileCRM.UI.EntityForm.openSalesEntityDetail=function(detail,errorCallback){MobileCRM.bridge.invokeMethodAsync("EntityForm","ShowEntityDetailDialog",[detail.id],null,errorCallback,null);}
MobileCRM.UI.EntityForm.DetailCollection=function(){};MobileCRM.UI.EntityForm.DetailCollection._updateDetail=function(updateCallback){var props=this.properties;if(props._privVals)
props=props._privVals;var request={entity:this.entityName,id:this.id,properties:props,isNew:this.isNew,isOnline:this.isOnline};var cmdParams=JSON.stringify(request);var self=this;MobileCRM.bridge.command('updateSalesDetailProduct',cmdParams,function(res){self.id=res.id;self.isNew=false;self.isOnline=res.isOnline;self.primaryName=res.primaryName;self.properties=res.properties;if(typeof updateCallback=="function")
updateCallback.call(self,null);},function(err){if(typeof updateCallback=="function")
updateCallback.call(self,err);},null);return this;};MobileCRM.UI.EntityForm.DetailCollection.getAll=function(callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","Entity.get_DetailCollection",[],function(orderDetails){var nDetails=orderDetails.length;for(var i=0;i<nDetails;i++){var detail=orderDetails[i];detail.update=MobileCRM.UI.EntityForm.DetailCollection._updateDetail;}
callback.call(scope,orderDetails);},errorCallback,scope);};MobileCRM.UI.EntityForm.DetailCollection.get=function(index,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","Entity.DetailCollection.get_Item",[index],function(entity){entity.update=MobileCRM.UI.EntityForm.DetailCollection._updateDetail;if(typeof callback=="function")
callback.call(scope,entity);},errorCallback,scope);};MobileCRM.UI.EntityForm.DetailCollection.deleteByIndex=function(index,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","Entity.DetailCollection.RemoveItem",[index],callback,errorCallback,scope);};MobileCRM.UI.EntityForm.DetailCollection.deleteById=function(orderDetailId,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("EntityForm","Entity.get_DetailCollection",[],function(res){var nDetails=res.length;for(var i=0;i<nDetails;i++){if(res[i].id==orderDetailId){MobileCRM.UI.EntityForm.DetailCollection.deleteByIndex(i,callback,errorCallback,scope);}}},errorCallback,scope);};MobileCRM.UI.EntityForm.DetailCollection.add=function(product,callback,errorCallback,scope){MobileCRM.bridge.command("addSalesDetailProduct",JSON.stringify(product),function(detailEntity){detailEntity.update=MobileCRM.UI.EntityForm.DetailCollection._updateDetail;if(typeof callback=="function")
callback.call(scope,detailEntity);},errorCallback,scope);};MobileCRM.UI.EntityForm.DetailCollection.addProductWithQuantity=function(product,quantity,callback,errorCallback,scope){MobileCRM.bridge.command("addSalesDetailProduct","#"+quantity+":"+JSON.stringify(product),function(detailEntity){detailEntity.update=MobileCRM.UI.EntityForm.DetailCollection._updateDetail;if(typeof callback=="function")
callback.call(scope,detailEntity);},errorCallback,scope);};MobileCRM.UI.EntityForm.DetailCollection.onChange=function(handler,bind,scope){var handlers=MobileCRM.UI.EntityForm._handlers.onDetailCollectionChange;var register=handlers.length==0;_bindHandler(handler,handlers,bind,scope);if(register)
MobileCRM.bridge.command("registerEvents","onDetailCollectionChange");};MobileCRM.Services.DocumentService.prototype._executeAction=function(action,callback,errorCallback,scope){var params={action:action,maxImageSize:this.maxImageSize,recordQuality:this.recordQuality,allowChooseVideo:this.allowChooseVideo,allowMultipleFiles:this.allowMultipleFiles};MobileCRM.bridge.command("documentService",JSON.stringify(params),callback,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.capturePhoto=function(callback,errorCallback,scope){this._executeAction(2,callback,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.selectPhoto=function(callback,errorCallback,scope){this._executeAction(4,callback,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.selectFile=function(callback,errorCallback,scope){this._executeAction(8,callback,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.recordAudio=function(callback,errorCallback,scope){this._executeAction(0x10,callback,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.recordVideo=function(callback,errorCallback,scope){this._executeAction(0x20,callback,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.pasteFile=function(callback,errorCallback,scope){this._executeAction(0x40000,callback,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.selectMultiplePhotos=function(callback,errorCallback,scope){this._executeAction(0x1000000,callback,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.print=function(filePath,landscape,errorCallback,scope){var params={filePath:filePath||"",landscape:landscape,print:true}
MobileCRM.bridge.command("documentService",JSON.stringify(params),null,errorCallback,scope);};MobileCRM.Services.DocumentService.prototype.resizeImage=function(filePath,maxWidth,maxHeight,callback,scope){var params={filePath:filePath||"",maxWidth:maxWidth,maxHeight:maxHeight,resizeImage:true}
MobileCRM.bridge.command("documentService",JSON.stringify(params),callback,null,scope);};MobileCRM.Services.DocumentService.prototype.saveFileDialog=function(fileName,fileData,callback,scope){var params={fileName:fileName||"",fileData:fileData,saveFileDialog:true}
MobileCRM.bridge.command("documentService",JSON.stringify(params),callback,null,scope);};_inherit(MobileCRM.Services.ChatService,MobileCRM.ObservableObject);MobileCRM.Services.ChatService.getService=function(callback,errorCallback,scope){MobileCRM.bridge.command("chatService",JSON.stringify({method:"create"}),callback,errorCallback,scope);};MobileCRM.Services.ChatService.prototype.postMessage=function(regardingEntity,text,callback,errorCallback,scope){MobileCRM.bridge.command("chatService",JSON.stringify({method:"postMessage",entityName:regardingEntity.entityName,entityId:regardingEntity.id,primaryName:regardingEntity.primaryName,text:text}),callback,errorCallback,scope);};MobileCRM.Services.ChatService.prototype.attachNoteToPost=function(postId,filePath,mimeType,subject,callback,errorCallback,scope){MobileCRM.bridge.command("chatService",JSON.stringify({method:"attachNoteToPost",postId:postId,filePath:filePath,mimeType:mimeType,subject:subject}),callback,errorCallback,scope);};MobileCRM.Services.ChatService.prototype.subscribeToEntityChannel=function(regardingEntity,subscribe,callback,errorCallback,scope){MobileCRM.bridge.command("chatService",JSON.stringify({method:"subscribe",entityName:regardingEntity.entityName,entityId:regardingEntity.id,primaryName:regardingEntity.primaryName,subscribe:subscribe}),callback,errorCallback,scope);};MobileCRM.Services.AudioRecorder.startRecording=function(callback,errorCallback,scope){MobileCRM.bridge.command("audioRecorder","startRecording",callback,errorCallback,scope);return new MobileCRM.Services.AudioRecorder();};MobileCRM.Services.AudioRecorder.prototype.stopRecording=function(callback,errorCallback,scope){MobileCRM.bridge.command("audioRecorder","stopRecording",callback,errorCallback,scope);};MobileCRM.Services.AudioRecorder.prototype.getRecordBase64=function(callback,errorCallback,scope){MobileCRM.bridge.command("audioRecorder","getRecordBase64",callback,errorCallback,scope);};MobileCRM.Services.AudioRecorder.prototype.getRecordFilePath=function(callback,errorCallback,scope){MobileCRM.bridge.command("audioRecorder","getRecordFilePath",callback,errorCallback,scope);};MobileCRM.Services.AddressBookService.getService=function(errorCallback,scope){MobileCRM.bridge.command("getAddressService",[],null,errorCallback,scope);return new MobileCRM.Services.AddressBookService();};MobileCRM.Services.AddressBookService.prototype.getContact=function(id,callback,errorCallback,scope){MobileCRM.bridge.invokeMethodAsync("AddressBookService","GetContact",[id],function(res){callback.call(scope,res);},errorCallback,scope);};MobileCRM.Services.AddressBookService.AddressBookRecord=function(){};MobileCRM.Services.GeoAddress.fromLocation=function(latitude,longitude,success,failed,scope){MobileCRM.bridge.command("locationToAddress",latitude+";"+longitude,success,failed,scope);};MobileCRM.Services.GeoAddress.prototype.toLocation=function(success,failed,scope){MobileCRM.bridge.command("addressToLocation",JSON.stringifyNotNull(this),success,failed,scope);};MobileCRM.Services.DynamicsReport.prototype.download=function(fileName,format,success,failed,scope){var params=JSON.stringify({format:format||"PDF",outputFileName:fileName,outputFolder:this.outputFolder,outputFilePath:this.outputFilePath,reportId:this.reportId,regardingEntity:this.regarding?this.regarding.entityName:null,regardingId:this.regarding?this.regarding.id:null});MobileCRM.bridge.command("downloadReport",params,success,failed,scope);};MobileCRM.Services.HttpWebRequest.prototype.send=function(url,callback,scope){var data={url:url,method:this.method,headers:JSON.stringify(this.headers),credentials:this._credentials,body:this._body,encoding:this._encoding,contentType:this.contentType,allowRedirect:this.allowRedirect,responseEncoding:this.responseEncoding};if(this._encoding==="Binary"){if(this._body&&this._body.constructor==Blob){var reader=new FileReader();reader.addEventListener("loadend",function(res){data.body=this.result.split(',')[1];data.encoding="Base64";MobileCRM.bridge.command("sendHttpRequest",JSON.stringify(data),callback,null,scope);});reader.readAsDataURL(this._body);}}
else
MobileCRM.bridge.command("sendHttpRequest",JSON.stringify(data),callback,null,scope);};MobileCRM.Services.HttpWebRequest.prototype.setBody=function(body,encoding){this._body=body;if(encoding)
this._encoding=encoding;}
MobileCRM.Services.HttpWebRequest.prototype.setResponseEncoding=function(encoding){if(encoding||encoding!=="Base64")
this.responseEncoding=encoding;}
MobileCRM.Services.HttpWebRequest.prototype.setCredentials=function(userName,password){this.userName=userName;this.password=password;this._credentials=JSON.stringify({"userName":this.userName,"password":this.password});}
MobileCRM.Services.Workflow={};MobileCRM.Services.Workflow.Action=function(){};MobileCRM.Services.Workflow.Action.execute=function(actionName,parameters,success,failed,scope){window.MobileCRM.bridge.command('executeWorkflowAction',JSON.stringify({actionName:actionName,actionParameters:JSON.stringify(parameters)}),success,failed,scope);};if(document.location.search.indexOf("isWC_MCRM=1")>=0){var instanceId;MobileCRM.Bridge.prototype.command=function(command,params,success,failed,scope){if(!this.instanceId){this.instanceId=getBridgeInstanceId();}
var cmdId=this._createCmdObject(success,failed,scope);var cmdText=this.instanceId+';'+cmdId+';'+command+';'+params;parent.window.postMessage(cmdText,"*");};MobileCRM.bridge=new MobileCRM.Bridge('WebClient');window.addEventListener("message",receiveMessageFromWebClient,false);function receiveMessageFromWebClient(event){var data=event.data;try{if(data.indexOf("eval")===0){var index=data.indexOf(":");if(index>=0){var evalCode=data.substr(index+1);var evalId=data.substr(0,index).split('|')[1];var result=eval(evalCode);if(evalId){if(!this.instanceId){this.instanceId=getBridgeInstanceId();}
parent.window.postMessage(this.instanceId+";"+evalId+";asyncResponse;"+result,"*");}}}}
catch(ex){alert("JSBridge on Webclient exception: "+ex);console.log(ex);}}
function getBridgeInstanceId(){args=document.location.search;var index=args.indexOf("bid=");var id=null;if(index>0){id=args.substr(index+4);}
if(id===null){throw"JSBridge not registered."}
return id;}}
else if(typeof CrmBridge!=="undefined"){if(typeof CrmBridge.processCommand!=="undefined"){MobileCRM.Bridge.prototype.command=function(command,params,success,failed,scope){var cmdId=this._createCmdObject(success,failed,scope);CrmBridge.processCommand(cmdId,command,params);};MobileCRM.bridge=new MobileCRM.Bridge('Windows');}
else{MobileCRM.Bridge.prototype.command=function(command,params,success,failed,scope){var cmdId=this._createCmdObject(success,failed,scope);CrmBridge.println(cmdId+';'+command+':'+params);};MobileCRM.bridge=new MobileCRM.Bridge('Android');}
if(typeof CrmBridge.invoke!=="undefined"){MobileCRM.Bridge.prototype.invoke=function(command,params){var result=CrmBridge.invoke(command,params);if(result.length>=4&&result.substr(0,4)=='ERR:')
throw new MobileCrmException(result.substr(4));else
return eval('('+result+')');};}}
else{if("external"in window&&external){var win10="win10version"in window;if("notify"in external||win10){MobileCRM.Bridge.prototype.command=function(command,params,success,failed,scope){var cmdId=this._createCmdObject(success,failed,scope);window.external.notify(cmdId+';'+command+':'+params);};MobileCRM.Bridge.prototype.invoke=function(command,params){var result=undefined;var error=null;var cmdId=this._createCmdObject(function(res){result=res;},function(err){error=err;},this);window.external.notify(cmdId+';'+command+':'+params);if(error)
throw new MobileCrmException(error);else
return result;};if(!("alert"in window)){window.alert=function(text){MobileCRM.bridge.invoke("alert",text);};}
MobileCRM.Bridge.prototype.alert=function(text,callback,scope){MobileCRM.bridge.command("alert",text,callback,callback,scope);};var platformName=win10?window.win10version:(navigator.userAgent.indexOf("Windows Phone")>0?"WindowsPhone":"WindowsRT");MobileCRM.bridge=new MobileCRM.Bridge(platformName);}
else if("ProcessCommand"in external){MobileCRM.Bridge.prototype.command=function(command,params,success,failed,scope){var cmdId=this._createCmdObject(success,failed,scope);external.ProcessCommand(cmdId,command,params);};if("InvokeCommand"in external){MobileCRM.Bridge.prototype.invoke=function(command,params){var result=window.external.InvokeCommand(command,params);if(result.length>=4&&result.substr(0,4)=='ERR:')
throw new MobileCrmException(result.substr(4));else
return eval('('+result+')');};}
MobileCRM.bridge=new MobileCRM.Bridge('Windows');}}
else if("webkit"in window&&"messageHandlers"in webkit&&"JSBridge"in webkit.messageHandlers){MobileCRM.Bridge.prototype.command=function(command,params,success,failed,scope){var cmdId=this._createCmdObject(success,failed,scope);var cmdText=cmdId+';'+command+':'+params;webkit.messageHandlers.JSBridge.postMessage(cmdText);};MobileCRM.bridge=new MobileCRM.Bridge('iOS');}
else if(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/)){MobileCRM.Bridge.prototype.command=function(command,params,success,failed,scope){var self=MobileCRM.bridge;var cmdId=self._createCmdObject(success,failed,scope);var cmdText=cmdId+';'+command+':'+params;self.commandQueue.push(cmdText);if(!self.processing){self.processing=true;document.location.href='crm:wake';}};MobileCRM.Bridge.prototype.peekCommand=function(){var cmdText=MobileCRM.bridge.commandQueue.shift();if(cmdText!=null){return cmdText;}
return"";};MobileCRM.Bridge.prototype.invoke=function(command,params){var self=MobileCRM.bridge;var result=undefined;var error=null;var cmdId=self._createCmdObject(function(res){result=res;},function(err){error=err;},self);var cmdText=cmdId+';'+command+':'+params;self.commandQueue.push(cmdText);var iframe=document.getElementById("MobileCRM_JSBridge_iFrame");if(iframe===null){iframe=document.createElement("iframe");iframe.id="MobileCRM_JSBridge_iFrame";iframe.style="visibility:hidden;display:none";iframe.src="crm:wake";iframe.height=0;iframe.width=0;iframe.hspace="0";iframe.vspace="0";iframe.marginheight="0";iframe.marginwidth="0";iframe.frameBorder="0";iframe.scrolling="No";document.documentElement.appendChild(iframe);}else{iframe.src=iframe.src;document.documentElement.removeChild(iframe);document.documentElement.appendChild(iframe);}
if(error)
throw new MobileCrmException(error);return result;};MobileCRM.Bridge.prototype.dequeueCommand=function(id){var queue=MobileCRM.bridge.commandQueue;for(var i in queue){var cmdText=queue[i];if(cmdText){var idEnd=cmdText.indexOf(';');if(idEnd>0&&cmdText.substr(0,idEnd)==id){queue.splice(i,1);return cmdText;}}}
return"";};MobileCRM.bridge=new MobileCRM.Bridge('iOS');MobileCRM.Bridge.prototype.initialize=function(){};}}}
if(typeof JSON==="undefined")
JSON={};if(typeof JSON.parse!=='function')
JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
text=String(text);var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+
('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');};if(typeof JSON.stringify!=='function')
JSON.stringify=function(obj){var t=typeof obj;if(t!="object"||obj===null){if(t=="string")obj=obj.toJSON();return String(obj);}
else if(obj instanceof Date)return'"'+obj.toJSON()+'"';else{var n,v,json=[],arr=(obj&&obj.constructor==Array);for(n in obj){v=obj[n];t=typeof v;if(t!='function'){if(t=="string")v=v.toJSON();if(t=="undefined")v=null;else if(t=="object"&&v!==null)v=JSON.stringify(v);json.push((arr?"":'"'+n+'":')+String(v));}}
return(arr?"[":"{")+String(json)+(arr?"]":"}");}};if(typeof JSON.stringifyNotNull!=='function')
JSON.stringifyNotNull=function(obj){var t=typeof obj;if(t!="object"||obj===null){if(t=="string")obj=obj.toJSON();return String(obj);}
else if(obj instanceof Date)return'"'+obj.toJSON()+'"';else{var n,v,json=[],arr=(obj&&obj.constructor==Array);for(n in obj){v=obj[n];if(v!=null){t=typeof v;if(t!='function'&&t!='undefined'){if(t=="string")v=v.toJSON();else if(t=="object"&&v!==null){if((v=JSON.stringifyNotNull(v))=='null')
continue;}
json.push((arr?"":'"'+n+'":')+String(v));}}}
return(json.length==0)?"null":(arr?"[":"{")+String(json)+(arr?"]":"}");}};if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){function f(n){return n<10?'0'+n:n;}
if(isFinite(this.valueOf())){var timeOff=-this.getTimezoneOffset()/60;return this.getFullYear()+'-'+
f(this.getMonth()+1)+'-'+
f(this.getDate())+'T'+
f(this.getHours())+':'+
f(this.getMinutes())+':'+
f(this.getSeconds())+
(timeOff==0?'Z':((timeOff>0?'+':'')+f(timeOff)+':00'));}
else
return null;};Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}
String.prototype.toJSON=function(){return'"'+this.replace(/\\/g,'\\\\').replace(/"/g,'\\"').replace(/\r/g,'\\r').replace(/\n/g,'\\n').replace(/\t/g,'\\t')+'"';};})();