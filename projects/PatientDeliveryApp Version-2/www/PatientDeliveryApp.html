<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>test title Dev02 again</title>
    <style>
        #btnabc{ 
        }
        #btnStartButton {
            background: #00204f;
            color: white;
            border: 0;
            cursor: pointer;
            box-shadow: 3px 4px 9px 1px #0000007a;
        }

        #btnFailed {
            background: red;
            color: white;
            border: 0;
            cursor: pointer;
            box-shadow: 3px 4px 9px 1px #0000007a;
        }

        .overlay {
            background: rgba(8, 8, 8, 0.3);
            width: 100%;
            /* height: 100%; */
            height: 26em;
            margin-top: 8px;
            position: fixed;
            z-index: 99999999;
        }

        body {
            font-family: "Segoe UI", Arial, sans-serif;
            font-size: 13px;
            font-style: normal;
            font-weight: 600;
        }

        #txtPincode {
            -webkit-text-security: disc !important;
        }

        /*table ui start */
        .Res-table {
            border: 1px solid #ccc;
            border-collapse: collapse;
            margin: 0;
            padding: 0;
            width: 100%;
            table-layout: fixed;
            margin-top: 1em;
        }

            .Res-table caption {
                font-size: 1.5em;
                margin: .5em 0 .75em;
            }

            .Res-table tr {
                background-color: #f8f8f8;
                border: 1px solid #ddd;
                padding: .35em;
            }

            .Res-table th,
            .Res-table td {
                padding: .625em;
                text-align: center;
            }

            .Res-table th {
                font-size: .85em;
                letter-spacing: .1em;
                text-transform: uppercase;
                background: #00204f;
                color: white;
            }

        @media screen and (max-width: 600px) {

            .Res-table caption {
                font-size: 1.3em;
            }

            .Res-table thead {
                font-size: .9em;
            }

            .Res-table tr {
                font-size: .9em;
            }

            .Res-table td {
                font-size: .9em;
                font-weight: normal;
            }
        }
    </style>
</head>
<link rel="stylesheet" href="style.css">

<body>
    <script type="text/javascript" src="../../../../../WebResources/ClientGlobalContext.js.aspx"></script>
    <script type="text/javascript" src="JSBridge.js"></script>
    <script type="text/javascript" src="Jquery.js"></script>
    <!--<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>-->
    <div align="left" style="margin-top: 5px;">
        <input type="button" id="btnStartButton" value="Start Delivery" style="text-align: center;width: 136px; height: 30px;display:inline;float:right;position:fixed;z-index:99;left: 0;border: none;outline: none;" onclick="onStartClick()" />
        <div align="right" style="display: inline;float: right;position: fixed;z-index: 99;right: 0;border: none;outline: none;color: white;cursor: pointer;">
            <!-- <input type="button" id="btnFailed" value="Failed" style="width: 120px; height: 30px" onclick="document.getElementById('id03').style.display = 'block'; document.getElementById('ddlookUpSubFailedDiv').style.display = 'none'; document.getElementById('ddlookUpFailed').value = 0;document.getElementById('ddlookUpSubFailed').options.length = 0;" disabled />       -->
            <input type="button" id="btnFailed" value="Failed" style="width: 120px; height: 30px" onclick="document.getElementById('id03').style.display = 'block'; document.getElementById('ddlookUpSubFailedDiv').style.display = 'none'; document.getElementById('ddlookUpFailed').value = 0" disabled />
        </div>
    </div>
    <br />
    <br />
    <div id="disablingPanel" class="overlay"></div>
    <br />

    <div class="container anotherSection" style="border-top: 1px solid #dfdfdf; padding:0;min-height: 25.2em;max-height: 25.2em;overflow: auto;">
        <form style="padding: 1em;">
            <div class="form-group" style="margin-top: 0;margin-bottom: 0;" id="productPackageTypeDiv">
                <table class="Res-table">
                    <thead>
                        <tr>
                            <th>Product Package Type</th>
                            <th>Temperature °C</th>
                        </tr>
                    </thead>
                    <tbody id="productPackageTypeList"></tbody>
                </table>
                <br />
                <div>
                    <label>Temperature Bypass code:</label>
                    <input style="border-bottom: 0.0625rem solid #999;font-weight: 400;" type="text" id="txtTemperatureBypasscode" maxlength="15" required="required">
                </div>
                <!--<label for="input" id="lblTemperatureBypasscode" class="control-label">Temperature Bypass code</label><i class="bar"></i>-->

            </div>

            <div id="verificationDiv" style="margin-top: 14px;">
                <div class="form-group" style="margin-top: 0;margin-bottom: 0;" id="packageSerialBlock">
                    <label>Package Serial: </label>
                    <input style="font-weight: 400;" type="text" id="txtPackageSerial" />

                    <i class="bar"></i>
                    <!--<button id="btnScanBarCode" class="button" style="margin-top: 1em;margin-bottom:0;"><span>Scan Barcode</span></button>-->
                    <!--<button id="btnscanbarcode" class="button" style="margin-top: 1em; margin-bottom: 0;" disabled><span>Scan Barcode</span></button>-->

                </div>
                <div class="form-group" style="margin-top: 0;margin-bottom: 0;" id="packageTableDiv">
                    <table class="Res-table">
                        <thead>
                            <tr>
                                <th>Package</th>
                                <th>Package Type</th>
                                <!--<th>Batch</th>-->
                                <!--<th>Quantity</th>-->
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="productList"></tbody>
                    </table>
                </div>
                <div id="collectedFromDiv" style="display:none;">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label id="lblCollectedFrom">Collected From</label>
                        <input style="border-bottom: 0.0625rem solid #999;font-weight: 400;" type="text" id="txtCollectedFrom" maxlength="30" required="required">
                    </div>
                </div>
                <br />
                <div id="pinVerificationDiv">
                    <!--<div class="form-group" style="margin-bottom: 0;">
                       <input style="font-weight: 400;" type="number" id="txtPincode" maxlength="6" required="required" />
                        <label for="input" id="lblPinCode" class="control-label">Pin Code</label><i class="bar pinCodeBar"></i>
                    </div>-->
                    <div class="form-group" style="margin-bottom: 0;">
                        <label id="lblPinCode">Pin Code</label>
                        <input style="border-bottom: 0.0625rem solid #999;font-weight: 400;" type="number" id="txtPincode" maxlength="6" required="required">
                    </div>
                    <button type="button" id="btnVerify" class="button" style="padding: 8px 27px;margin-top: 1em; margin-bottom: 0;"><span>Verify</span></button>
                    <!--<input type="checkbox" checked data-toggle="toggle" data-size="normal">-->
                    <div class="form-radio" style="margin-top: 0; margin-bottom: 0;">

                        <div class="radio">
                            <label>
                                <input type="radio" id="rbYes" name="rbName" value="Yes"><i class="helper"></i>Yes
                            </label>
                        </div>
                        <div class="radio" style="padding-left: 1em;">
                            <label>
                                <input type="radio" id="rbNo" name="rbName" value="No" checked="checked"><i class="helper"></i>No
                            </label>
                        </div>
                    </div>
                </div>
                <br />
                <div class="form-group" style="margin-top: 0;" id="receiverBlock">
                    <div style="width: 10%"></div>
                    <div style="width: 40%; float: left;">
                        <label>Received By </label>
                        <select id="ddlRecievedBy" style="margin-top:12px;font-weight: 400;">
                            <option value="-1">Select</option>
                            <option value="275380002">Authorized Recipient</option>
                            <option value="275380003">Other Recipient</option>
                        </select>
                        <i class="bar"></i>
                    </div>
                    <!--<div style="width: 10%"></div>-->
                    <div style="display: inline-block; float: right; width: 40%;" class="receiverNameDiv">
                        <label>Receiver Name </label>
                        <select id="ddlRecieverName" style="margin-top:12px;font-weight: 400;">
                            <option>Select</option>
                        </select>
                        <i class="bar"></i>
                    </div>
                    <div style="display: none; float: right; width: 40%;" class="otherRecipientDiv">
                        <label>Other Recipient Name</label>
                        <input id="txtOtherRecipient" style="font-weight: 400;margin-top: 12px" type="text" maxlength="50" />
                        <i class="bar"></i>
                    </div>
                    <div style="width: 10%"></div>
                </div>
                <br />
            </div>
        </form>
    </div>
    <!-- end of another section -->

    <div id="id01" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <!--<span onclick="document.getElementById('id01').style.display='none'" class="w3-button w3-blue w3-xlarge w3-display-topright" style="display: none;">&times;</span>-->
                <h2 style="height: 32px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <p style="padding: 0 2em;">You are not picking the next delivery order in the list, either follow the right sequence or provide reason code for changing the sequence. </p>
            <div class="w3-container w3-light-grey w3-padding">
                <!--<button id="btnokDiv1" class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('id01').style.display = 'none';document.getElementById('disablingPanel').style.display = 'block';">Ok </button>-->
                <button id="btnSkipDiv1" class="w3-button w3-right w3-white w3-border" style="margin-right: 7px;" onclick="document.getElementById('id02').style.display = 'block'; document.getElementById('id01').style.display = 'none'; document.getElementById('disablingPanel').style.display = 'none'">
                    Skip
                </button>
            </div>
        </div>
    </div>

    <div id="id02" class="w3-modal" style="display: none;">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 32px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <br />
            <br />
            <div class="form-group" style="margin-top: 0; width:100%; padding:0px 10px;">
                <div style="width: 20%; float: left; margin-top:7px;">
                    <label>Reason:</label>
                </div>
                <div style="width: 80%; float: right;">
                    <select id="ddlookUp" style="font-weight: normal;"></select>
                    <i class="bar"></i>
                </div>
            </div>
            <div class="w3-container w3-light-grey w3-padding">
                <button id="btnOK" class="w3-button w3-right w3-white w3-border">Ok</button>
                <!--<button style="margin-right: 10px;" id="btnCancel" class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('id02').style.display='none'">Cancel</button>-->
            </div>
        </div>
    </div>

    <div id="id03" class="w3-modal" style="display: none;">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center">
                <br />
                <div class="form-group" style="margin-top: 0; width:100%; padding:0px 10px;">
                    <div style="width:30%; display:inline-block; float: left;margin-top: 7px;">
                        <label>Reason : </label>
                    </div>
                    <div style="width: 70%; display:inline-block;">
                        <select id="ddlookUpFailed" style="font-weight: normal;"></select>
                        <i class="bar"></i>
                    </div>
                </div>
                <div class="form-group" id="ddlookUpSubFailedDiv" style="margin-top: 0; width:100%; padding:0px 10px;">
                    <div style="width:30%; display:inline-block; float: left;margin-top: 7px;">
                        <label>Sub Reason : </label>
                    </div>
                    <div style="width: 70%; display:inline-block;">
                        <select id="ddlookUpSubFailed" style="font-weight: normal;"></select>
                        <i class="bar"></i>
                    </div>
                </div>
                <div class="form-group" style="margin-top: 0; width:100%; padding:0px 10px;display:none" id="failedDeliveryPinBlock">
                    <div style="width:30%; display:inline-block; float: left; padding-left: 10px;padding-top: 5px;">
                        <label>Pin Code : </label>
                    </div>
                    <div style="width: 70%; display:inline-block;">
                        <input style="border-bottom: 1px solid #999;" type="password" id="txtFailedPincode" maxlength="4" />
                    </div>
                </div>



                <br /><br />
            </div>

            <div class="w3-container w3-light-grey w3-padding">
                <button id="btnOKFailedButton" class="w3-button w3-right w3-white w3-border">Done</button>
                <button style="margin-right: 10px;" id="btnCancelFailedButton" class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('id03').style.display='none'">Cancel</button>
            </div>
        </div>
    </div>

    <div id="popUpMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>The PIN entered by the patient is incorrect, please try again or contact Logistics services team.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('popUpMessage').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <div id="popUpSignatureMandatoryMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>Signature is mandatory as per contract SLA rule.</label>
                <br /><br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('popUpSignatureMandatoryMessage').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <div id="popUpPincodeMandatoryMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>PIN Code is mandatory as per contract SLA rule.</label>
                <br /><br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('popUpPincodeMandatoryMessage').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <div id="popUpSignatureAndPincodeMandatoryMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>Signature and PIN Code both are mandatory as per contract SLA rule.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('popUpSignatureAndPincodeMandatoryMessage').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <div id="popUpSignatureORPincodeMandatoryMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>Signature/PIN Code is mandatory as per contract SLA rule.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('popUpSignatureORPincodeMandatoryMessage').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <div id="SelectReasonFirstMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>Select Reason to proceed.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('SelectReasonFirstMessage').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <div id="popUpFailedPinMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>The PIN you entered is incorrect, please try again or contact Logistics services team.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('popUpFailedPinMessage').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <div id="PackageSerialNotMatchedMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>PACKID you're trying to scan doesn't match with any lines of the selected delivery order.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('PackageSerialNotMatchedMessage').style.display = 'none';document.getElementById('txtPackageSerial').value = ''">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <div id="PackageSerialMatchedMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>The package has been successfully scanned.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('PackageSerialMatchedMessage').style.display = 'none';document.getElementById('txtPackageSerial').value = ''">Ok </button>
                <br />
            </div>
        </div>
    </div>
    <!--ye use nahi kia hay, is ko use karna hai 741-010 requirement pe-->
    <div id="PackageSerialNotMatchedMessage2" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>One or more lines on the delivery order are not delivered, either scan all the items or mark the delivery as failed.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('PackageSerialNotMatchedMessage2').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>
    <!--pin code verified msg-->
    <div id="PinCodeVerificationMessage2" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>The PIN Code is successfully verified.</label>
                <br /> <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('PinCodeVerificationMessage2').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>
    <!--pin code verified msg-->
    <div id="PinCodeVerificationMessage" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>The PIN Code is successfully verified.</label>
                <br />
                <button id="pincodemessageOkButton" class="w3-button w3-right w3-white w3-border" onclick="document.getElementById('PinCodeVerificationMessage').style.display = 'none'">Ok </button>
                <br />
            </div>
        </div>
    </div>
    <!--Select Reciever Name before proceeding-->
    <div id="validationMessagePopup" class="w3-modal" style="display: none">
        <div class="w3-modal-content w3-card-4 w3-animate-zoom">
            <header class="w3-container w3-blue">
                <h2 style="height: 20px;">
                    <!-- Wait! -->
                </h2>
            </header>
            <div align="center" style="overflow: auto; padding: 1em;">
                <label>Select Reciever Name before proceeding.</label>
                <br />
                <button class="w3-button w3-right w3-white w3-border" onclick="closeValidationMessagePopup()">Ok </button>
                <br />
            </div>
        </div>
    </div>

    <script type="text/javascript">
        //$(document).ready(function () {
        var pinVerified = false;
        var isWorkOrderPackage = false;
        var workorderProductPackageIds = [];
        var workorderProducts = [];
        var workorderProductTemperatures = [];
        var productpackageTemperatureVerified = false;
        var bypassdeliverytemperaturecode = '';
        var deliveryoutsidetempcodeforwholesaleorgord = '';
        var deliveryoutsidetempcodeforemployeeorders = '';
        var allowDeliveryOutsideTemperature = '';
        var pinSignatureRule = -1;
        var contact = { id: '', name: '' };
        var nominatoryAddressid = '';
        var nominatoryAddressname = '';
        var nominatoryAddressList = [];
        var customeraddressid = '';
        var customeraddressname = '';

        function closeValidationMessagePopup() {
            $('#validationMessagePopup').hide();
            $('#validationMessagePopup').find('label').text('');
        }

        $("input[type=radio]").attr('disabled', true);

        $("#btnFailed").attr("disabled", true);

        $('#btnCancel').click(function () {
            $('#disablingPanel').show();
            $("#btnStartButton").attr("disabled", true);
        });


        $('#btnokDiv1').click(function () {
            $("#btnFailed").attr("disabled", true);
            $("#btnStartButton").attr("disabled", true);
        });

        //$('#btnscanbarcode').click(function () {
        //    barCode();
        //});

        var id01 = document.getElementById("id01");

        var today = new Date();
        var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();
        var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
        var dt = date + ' ' + time;


        if ($('btnokDiv1').data('clicked', true)) {
            $('#btnFailed').attr("disabled", "disabled");
        }

        if ($('btnSkipDiv1').data('clicked', true)) {
            $('#btnFailed').attr("disabled", "disabled");
        }

        var x = document.getElementById("btnStartButton");
        function onStartClick() {
            try {
                $('#disablingPanel').hide();
                $("#btnFailed").attr("disabled", false);
                if (x.value == "Start Delivery") {

                    MobileCRM.UI.EntityForm.requestObject(StartDate, onError, null);
                    x.value = "End Delivery & Save";

                    if (visitType == 275380003 || visitType == 275380004 || visitType == 275380007) {
                        $("#btnStartButton").attr("disabled", false);
                        MobileCRM.UI.EntityForm.requestObject(
                            function (entityForm) {
                                // get media tab by its name
                                var media = entityForm.getMediaTab("Signature");
                                media.setEditable(true, MobileCRM.bridge.alert); // set false to make it read-only
                            },
                            MobileCRM.bridge.alert, null
                        );
                    }
                    else {
                        $("#btnStartButton").attr("disabled", true);
                    }

                }
                else {
                    MobileCRM.UI.EntityForm.requestObject(EndDate, onError, null);
                }
            }
            catch (e) {
                alert(e);
            }

        }

        function onError(error) {
            if (typeofalert != "undefined") {
                alert("An error occured:" + err);
            }
        }


        function StartDate(entityForm) {
            try {

                var a = entityForm.entity;
                a.properties["mzk_actualvisitstartdatetime"] = new Date();
            }
            catch (e) {
                alert(e);
            }
        }

        function SetEndDate(entityForm) {
            try {
                var a = entityForm.entity;
                a.properties["mzk_actualvisitenddatetime"] = new Date();
                a.properties["mzk_actualdropnumber"] = newDropNumber;
            }
            catch (e) {
                alert(e);
            }
        }


        function EndDate(entityForm) {
            try {
                var recieveType = entityForm.entity.properties["mzk_recievingtype"];
                var recieveBy = entityForm.entity.properties["mzk_recievedby"];
                var otherRecipient = $('#txtOtherRecipient').val();

                if (productpackageTemperatureVerified == false && $("#productPackageTypeList .workorderproductpackageTemperature").length > 0) {
                    $('#validationMessagePopup').find('label').text('Please first validate temperature against all the Product Package types.');
                    $('#validationMessagePopup').show();
                    return false;
                }

                if (visitType != 275380003 && visitType != 275380004 && visitType != 275380007) {

                    if ($("#productList .workorderproductpackage").length > 0 && (workorderProductPackageIds.length != $("#productList .workorderproductpackage").length)) {
                        $('#validationMessagePopup').find('label').text('One or more lines on the delivery order are not delivered, either scan all the items or mark the delivery as failed.');
                        $('#validationMessagePopup').show();
                        return false;
                    }
                }
                if (visitType == 275380003 || visitType == 275380004 || visitType == 275380007) {
                    if ($("#txtCollectedFrom").val() == undefined || $("#txtCollectedFrom").val() == null || $("#txtCollectedFrom").val() == '') {
                        $('#validationMessagePopup').find('label').text('Please enter Collected From Name.');
                        $('#validationMessagePopup').show();
                        return false;
                    }
                }

                if (visitType == 275380001 || visitType == 275380002 || visitType == 275380006) {

                    if (recieveType == undefined || recieveType == null || recieveType == '' || recieveType == -1 || recieveType == 0) {
                        $('#validationMessagePopup').find('label').text('Select Receiver Type before proceeding.');
                        $('#validationMessagePopup').show();
                        return false;
                    }
                    else {
                        if (recieveType == 275380000) {
                            if (recieveBy == undefined || recieveBy == null || recieveBy == '' || recieveBy == -1 || recieveBy == 0) {
                                $('#validationMessagePopup').find('label').text('Select Authorized Recipient before proceeding.');
                                $('#validationMessagePopup').show();
                                return false;
                            }
                        }
                        else if (recieveType == 275380001) {
                            //otherRecipient
                            if (otherRecipient == '') {
                                $('#validationMessagePopup').find('label').text('Enter Other Recipient Name before proceeding.');
                                $('#validationMessagePopup').show();
                                return false;
                            }
                        }
                    }
                }

                if (visitType == 275380002 || visitType == 275380003 || visitType == 275380004 || visitType == 275380006 || visitType == 275380007) {
                    var media = entityForm.getMediaTab("Signature");
                    media.isEmpty(
                        function (result) {
                            if (result == true) {
                                $('#validationMessagePopup').find('label').text('Signature is mandatory.');
                                $('#validationMessagePopup').show();
                            }
                            else {
                                var x = document.getElementById("btnStartButton");
                                x.value = "Completed!";
                                x.disabled = true;
                                DisableSignatureTab();
                                $('#disablingPanel').show();
                                $("#btnFailed").attr("disabled", true);
                                MobileCRM.UI.EntityForm.requestObject(SetEndDate, onError, null);
                                MarkDeliveryEnd();
                            }
                        },
                        function (_error) {
                            alert("An error occurred: " + _error);
                        }, null
                    );

                }
                else {  // for patients delivery order
                    var x = document.getElementById("btnStartButton");

                    if (pinSignatureRule != -1) {

                        if (pinSignatureRule == 275380000) //Signature
                        {
                            MobileCRM.UI.EntityForm.requestObject(
                                function (entityForm) {
                                    var media = entityForm.getMediaTab("Signature");
                                    media.isEmpty(
                                        function (result) {

                                            if (result == true) {

                                                var popUpSignatureMandatoryMessage = document.getElementById("popUpSignatureMandatoryMessage");
                                                popUpSignatureMandatoryMessage.style.display = "block";
                                            }
                                            else {
                                                x.value = "Completed!";
                                                x.disabled = true;
                                                DisableSignatureTab();
                                                $('#disablingPanel').show();
                                                $("#btnFailed").attr("disabled", true);
                                                MobileCRM.UI.EntityForm.requestObject(SetEndDate, onError, null);
                                                MarkDeliveryEnd();
                                            }
                                        },
                                        function (_error) {
                                            alert("An error occurred: " + _error);
                                        }, null
                                    );
                                }

                            );

                        }

                        else if (pinSignatureRule == 275380001) //PIN
                        {
                            var pinCode = $('#txtPincode').val();

                            if (pinCode == '') {
                                var popUpPincodeMandatoryMessage = document.getElementById("popUpPincodeMandatoryMessage");
                                popUpPincodeMandatoryMessage.style.display = "block";
                            }
                            else {
                                if (!pinVerified) {
                                    $('#validationMessagePopup').find('label').text('Verify PIN Code first.');
                                    $('#validationMessagePopup').show();
                                } else {
                                    x.value = "Completed!";
                                    x.disabled = true;
                                    DisableSignatureTab();
                                    $('#disablingPanel').show();
                                    $("#btnFailed").attr("disabled", true);
                                    MobileCRM.UI.EntityForm.requestObject(SetEndDate, onError, null);
                                    MarkDeliveryEnd();
                                }

                            }
                        }

                        else if (pinSignatureRule == 275380002) //Signature & PIN
                        {
                            var flag = false;

                            var pinCode = $('#txtPincode').val();

                            MobileCRM.UI.EntityForm.requestObject(

                                function (entityForm) {
                                    var media = entityForm.getMediaTab("Signature");
                                    media.isEmpty(
                                        function (result) {
                                            if (result == true) {
                                                flag = true;
                                            }
                                            if (pinCode == '' || flag == true) {
                                                var popUpSignatureAndPincodeMandatoryMessage = document.getElementById("popUpSignatureAndPincodeMandatoryMessage");
                                                popUpSignatureAndPincodeMandatoryMessage.style.display = "block";
                                            }
                                            else {
                                                if (!pinVerified) {
                                                    $('#validationMessagePopup').find('label').text('Please verify Pin Code first.');
                                                    $('#validationMessagePopup').show();
                                                } else {
                                                    x.value = "Completed!";
                                                    x.disabled = true;
                                                    DisableSignatureTab();
                                                    $('#disablingPanel').show();
                                                    $("#btnFailed").attr("disabled", true);
                                                    MobileCRM.UI.EntityForm.requestObject(SetEndDate, onError, null);
                                                    MarkDeliveryEnd();
                                                }

                                            }
                                        },
                                        function (_error) {
                                            alert("An error occurred: " + _error);
                                        }, null
                                    );
                                }
                            );
                        }

                        else if (pinSignatureRule == 275380003) //Signature OR PIN
                        {
                            var pinCode = $('#txtPincode').val();

                            if (pinCode == '') {

                                MobileCRM.UI.EntityForm.requestObject(

                                    function (entityForm) {
                                        var media = entityForm.getMediaTab("Signature");
                                        media.isEmpty(
                                            function (result) {
                                                if (result == true) {
                                                    var popUpSignatureORPincodeMandatoryMessage = document.getElementById("popUpSignatureORPincodeMandatoryMessage");
                                                    popUpSignatureORPincodeMandatoryMessage.style.display = "block";
                                                }
                                                else {
                                                    x.value = "Completed!";
                                                    x.disabled = true;
                                                    DisableSignatureTab();
                                                    $('#disablingPanel').show();
                                                    $("#btnFailed").attr("disabled", true);
                                                    MobileCRM.UI.EntityForm.requestObject(SetEndDate, onError, null);
                                                    MarkDeliveryEnd();
                                                }
                                            },
                                            function (_error) {
                                                alert("An error occurred: " + _error);
                                            }, null
                                        );
                                    }

                                );
                            }
                            else {
                                if (!pinVerified) {
                                    $('#validationMessagePopup').find('label').text('Please verify Pin Code first.');
                                    $('#validationMessagePopup').show();
                                } else {
                                    x.value = "Completed!";
                                    x.disabled = true;
                                    DisableSignatureTab();
                                    $('#disablingPanel').show();
                                    $("#btnFailed").attr("disabled", true);
                                    MobileCRM.UI.EntityForm.requestObject(SetEndDate, onError, null);
                                    MarkDeliveryEnd();
                                }
                            }
                        }
                    }
                    else {
                        x.value = "Completed!";
                        x.disabled = true;
                        DisableSignatureTab();
                        $('#disablingPanel').show();
                        $("#btnFailed").attr("disabled", true);
                        $("#btnStartButton").attr("disabled", false);
                        MobileCRM.UI.EntityForm.requestObject(SetEndDate, onError, null);
                        MarkDeliveryEnd();
                    }
                }
            }
            catch (e) {
                alert(e);
            }
        }

        function MarkDeliveryEnd() {
            MobileCRM.UI.EntityForm.requestObject(
                function (entityForm) {
                    var media = entityForm.getMediaTab("Signature");
                    media.isEmpty(
                        function (result) {
                            if (result == false) {
                                var SignatureMedia = entityForm.getMediaTab("Signature");
                                SignatureMedia.getData(
                                    function (base64String) {

                                        var note = MobileCRM.DynamicEntity.createNew("annotation");

                                        note.properties.filename = 'Signature.svg';
                                        note.properties.mimetype = "image/svg+xml";
                                        note.properties.subject = "mobilecrm_signature";

                                        note.properties.documentbody = base64String;
                                        note.properties.objectid = new MobileCRM.Reference("msdyn_workorder", workorderid);

                                        note.save(function (err) {
                                            if (err) MobileCRM.bridge.alert(err);
                                            else {

                                                $("#productPackageTypeList .workorderproductpackageTemperature").each(function (index) {
                                                    var temp = $(this).find('.txtTemperature').val();
                                                    if (temp != '') {
                                                        UpdatePackageTypeTemperatures($(this).data('id'), temp);
                                                    }
                                                });

                                                if (!isWorkOrderPackage) {
                                                    for (i = 0; i < workorderProductPackageIds.length; i++) {
                                                        setPackageStatusDelivered(workorderProductPackageIds[i]);
                                                    }
                                                }
                                                else {
                                                    for (i = 0; i < workorderProductPackageIds.length; i++) {
                                                        setWorkOrderPackageStatusDelivered(workorderProductPackageIds[i]);
                                                    }
                                                }

                                                for (i = 0; i < workorderProducts.length; i++) {
                                                    setWOProductStatusDelivered(workorderProducts[i]);
                                                }

                                                setVisitStatusDelivered();
                                            }
                                        });

                                    },
                                    MobileCRM.bridge.alert
                                );
                            }
                            else {
                                $("#productPackageTypeList .workorderproductpackageTemperature").each(function (index) {
                                    var temp = $(this).find('.txtTemperature').val();
                                    if (temp != '') {
                                        UpdatePackageTypeTemperatures($(this).data('id'), temp);
                                    }
                                });

                                if (!isWorkOrderPackage) {
                                    for (i = 0; i < workorderProductPackageIds.length; i++) {
                                        setPackageStatusDelivered(workorderProductPackageIds[i]);
                                    }
                                }
                                else {
                                    for (i = 0; i < workorderProductPackageIds.length; i++) {
                                        setWorkOrderPackageStatusDelivered(workorderProductPackageIds[i]);
                                    }
                                }

                                for (i = 0; i < workorderProducts.length; i++) {
                                    setWOProductStatusDelivered(workorderProducts[i]);
                                }

                                setVisitStatusDelivered();
                            }
                        },
                        function (_error) {
                            alert("An error occurred: " + _error);
                        }, null
                    );
                },
                MobileCRM.bridge.alert, null
            );
        }

        $('#pincodemessageOkButton').click(function () {
            MobileCRM.UI.EntityForm.requestObject(EndDateOnFailed, onError, null);
        });

        function EndDateOnFailed(entityForm) {
            try {

                x.value = "Completed!";
                x.disabled = true;
                DisableSignatureTab();
                $('#disablingPanel').show();
                $("#btnFailed").attr("disabled", true);
                MobileCRM.UI.EntityForm.requestObject(SetEndDate, onError, null);
                saveAndCloseForm();
            }
            catch (e) {
                alert(e);
            }
        }

        function btnOKFailedButton(entityForm) {
            try {

                var selectedValue = $('#ddlookUpFailed option:selected').val();
                var selectedText = $('#ddlookUpFailed option:selected').text();

                var selectedSubReasonValue = $('#ddlookUpSubFailed option:selected').val();
                var selectedSubReasonText = $('#ddlookUpSubFailed option:selected').text();

                var skipvisit = entityForm.entity;
                skipvisit.properties["mzk_failurevisitreason"] = new MobileCRM.Reference("mzk_reasoncode", selectedValue, selectedText);

                if (selectedSubReasonValue != 0)
                    skipvisit.properties["mzk_failurevisitsubreason"] = new MobileCRM.Reference("mzk_reasoncode", selectedSubReasonValue, selectedSubReasonText);

                $("#btnFailed").attr("disabled", true);
                $("#btnStartButton").attr("disabled", true);
            }
            catch (e) {
                alert("An error occurred: " + e);
            }
        }
        //});

        $('#btnOKFailedButton').click(function () {
            try {
                var selectedValue = $('#ddlookUpFailed option:selected').val();

                if (selectedValue == 0) {
                    $('#validationMessagePopup').find('label').text('Select Reason to proceed.');
                    $('#validationMessagePopup').show();
                    return false;
                }

                if ($('#ddlookUpSubFailed option').length > 1 && $('#ddlookUpSubFailed').val() == 0) {
                    $('#validationMessagePopup').find('label').text('Select Sub Reason to proceed.');
                    $('#validationMessagePopup').show();
                    return false;
                }

                setVisitStatusFailed();
                MobileCRM.UI.EntityForm.requestObject(
                    btnOKFailedButton,
                    onError, null);
                $('#disablingPanel').hide();
                document.getElementById('id03').style.display = 'none';
                MobileCRM.UI.EntityForm.requestObject(EndDateOnFailed, onError, null);

            } catch (e) {
                alert("An error occurred: " + e);
            }
        });



        $('#btnVerify').click(function () {
            try {
                MobileCRM.UI.EntityForm.requestObject(
                    PinCode,
                    onError, null);
            } catch (e) {
                alert("An error occurred: " + e);
            }

        });
        //PIN Code
        function PinCode(entityForm) {

            var pinCode = $('#txtPincode').val();

            try {

                var serviceAccount = "";
                var msdyn_workorder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
                msdyn_workorder.addAttribute("msdyn_serviceaccount");
                msdyn_workorder.addAttribute("msdyn_name");
                var fetch = new MobileCRM.FetchXml.Fetch(msdyn_workorder);

                fetch.execute("Array",
                    MobileCRM.UI.EntityForm.requestObject(
                        function (entityForm) {
                            serviceAccount = entityForm.entity.properties["msdyn_serviceaccount"].id;

                            var entity = new MobileCRM.FetchXml.Entity("contact");
                            entity.addAttribute("mzk_pincode");
                            var linkEntity = entity.addLink("account", "primarycontactid", "contactid", "inner");
                            linkEntity.addFilter().where("accountid", "eq", serviceAccount);


                            var fetch = new MobileCRM.FetchXml.Fetch(entity);
                            fetch.execute(
                                "Array",
                                function (result) {
                                    if (result != '') {
                                        if (result == pinCode) {
                                            $('#productPackageTypeList :input').attr('disabled', true);
                                            $("#txtTemperatureBypasscode").attr("disabled", true);
                                            pinVerified = true;
                                            $('#disablingPanel').hide();

                                            var PackageSerialMatchedMessage = document.getElementById("PinCodeVerificationMessage2");
                                            PackageSerialMatchedMessage.style.display = "block";

                                            $("#btnVerify").attr("disabled", true);

                                            $('input:radio[name=rbName]')[0].checked = true;

                                            document.getElementById('id02').style.display = 'none';

                                            document.getElementById("ddlRecievedBy").disabled = false;

                                            if (pinSignatureRule != 275380003) {
                                                $("#ddlRecievedBy").val($("#ddlRecievedBy option:eq(1)").val());
                                                $('#ddlRecievedBy').trigger("change");
                                            }


                                            document.getElementById("txtPincode").disabled = true;
                                            document.getElementById("rbYes").disabled = true;
                                            document.getElementById("rbNo").disabled = true;

                                        }
                                        else {
                                            pinVerified = false;
                                            var popUpMessage = document.getElementById("popUpMessage");
                                            popUpMessage.style.display = "block";
                                        }
                                    }
                                    else {
                                        pinVerified = false;
                                        var popUpMessage = document.getElementById("popUpMessage");
                                        popUpMessage.style.display = "block";
                                    }
                                },
                                function (err) {
                                    MobileCRM.bridge.alert("Error fetching accounts: " + err);
                                },
                                null
                            );

                        },

                        function (err) { alert(err); },
                        null
                    ));

            } catch (e) {
                alert("An error occurred: " + e);
            }
        }
        function FailedPinCode(entityForm) {

            var x = document.getElementById("btnStartButton");
            var failedPinCodeText = $('#txtFailedPincode').val();

            try {

                var serviceAccount = "";
                var failurevisitreason = "";
                var msdyn_workorder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
                msdyn_workorder.addAttribute("msdyn_serviceaccount");
                msdyn_workorder.addAttribute("msdyn_name");
                var fetch = new MobileCRM.FetchXml.Fetch(msdyn_workorder);

                fetch.execute("Array",
                    MobileCRM.UI.EntityForm.requestObject(
                        function (entityForm) {

                            serviceAccount = entityForm.entity.properties["msdyn_serviceaccount"].id;

                            var entity = new MobileCRM.FetchXml.Entity("contact");
                            entity.addAttribute("mzk_failedpincode");
                            var linkEntity = entity.addLink("account", "primarycontactid", "contactid", "inner");
                            linkEntity.addFilter().where("accountid", "eq", serviceAccount);

                            var fetch = new MobileCRM.FetchXml.Fetch(entity);
                            fetch.execute(
                                "Array",
                                function (result) {
                                    if (result != '') {
                                        if (result == failedPinCodeText) {
                                            setVisitStatusFailed();
                                            MobileCRM.UI.EntityForm.requestObject(
                                                btnOKFailedButton,
                                                onError, null);
                                            document.getElementById("txtFailedPincode").disabled = true;
                                            $('#disablingPanel').hide();
                                            $("#btnStartButton").attr("disabled", true);

                                            var PinCodeVerificationMessage = document.getElementById("PinCodeVerificationMessage");
                                            PinCodeVerificationMessage.style.display = "block";

                                            document.getElementById('id03').style.display = 'none';

                                            var recieveType = entityForm.entity.properties["mzk_recievingtype"];
                                            var recieveBy = entityForm.entity.properties["mzk_recievedby"];

                                            $('#ddlRecievedBy').val("-1");
                                            $('#ddlRecievedBy').trigger("change");

                                            $('#ddlRecieverName').val('0');
                                            $('#ddlRecieverName').trigger("change");

                                        }
                                        else {
                                            var popUpMessage = document.getElementById("popUpFailedPinMessage");
                                            popUpMessage.style.display = "block";
                                        }
                                    }
                                    else {
                                        var popUpMessage = document.getElementById("popUpFailedPinMessage");
                                        popUpMessage.style.display = "block";
                                        document.getElementById('id03').style.display = 'block';
                                    }
                                },
                                function (err) {
                                    MobileCRM.bridge.alert("Error fetching accounts: " + err);
                                },
                                null
                            );

                        },

                        function (err) { alert(err); },
                        null
                    ));

            } catch (e) {
                alert("An error occurred: " + e);
            }
        }

        var id = "";
        var scheduleDateTime = "";
        var scheduleDateTimeConversion = "";
        var scheduleDateTimeConversion2 = "";
        var workorderid = "";
        var resourceid = "";
        var newDropNumber = "";
        var date = new Date();
        var visitType = "";
        var actualVisitStartDate = "";
        var actualVisitEndDate = "";
        var patientaddressId = "";

        function onLoad() {
            MobileCRM.UI.EntityForm.requestObject(
                function (entityForm) {
                    visitType = entityForm.entity.properties["mzk_visittype"];
                    patientaddressId = entityForm.entity.properties["mzk_patientaddressid"];

                    enableRules();
                    enableDisableInputs(true);

                    $("#btnStartButton").attr("disabled", true);
                    $("#btnFailed").attr("disabled", true);

                    id = entityForm.entity.properties["msdyn_priority"];
                    workorderid = entityForm.entity.properties["msdyn_workorderid"];

                    resourceid = entityForm.entity.properties["mzk_resource"].id;
                    scheduleDateTime = entityForm.entity.properties["mzk_scheduledstartdatetime"];
                    var actualVisitEndDate1 = entityForm.entity.properties["mzk_actualvisitenddatetime"];

                    var x = document.getElementById("btnStartButton");
                    if (actualVisitEndDate1 != undefined) {
                        x.value = "Completed!";
                        x.disabled = true;
                    }

                    scheduleDateTimeConversion = scheduleDateTime.toISOString();

                    var TodayDate = new Date();
                    TodayDate = TodayDate.toISOString();
                    var date1 = TodayDate.split('T');

                    var workorder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
                    workorder.addAttribute("mzk_scheduledstartdatetime");
                    workorder.addAttribute("mzk_actualvisitenddatetime");

                    var filter0 = new MobileCRM.FetchXml.Filter();
                    filter0.where("mzk_resource", "eq", resourceid);

                    var filter1 = new MobileCRM.FetchXml.Filter();
                    filter1.isIn("mzk_visittype", ["275380001", "275380002", "275380003", "275380004", "275380006", "275380007"]);

                    var filter2 = new MobileCRM.FetchXml.Filter();
                    filter2.where("mzk_scheduledstartdatetime", "lt", scheduleDateTimeConversion);

                    var filter3 = new MobileCRM.FetchXml.Filter();
                    filter3.where("mzk_actualvisitenddatetime", "null");

                    var filter4 = new MobileCRM.FetchXml.Filter();
                    // filter4.between("mzk_scheduledstartdatetime", new Date(date1[0] + "T00:00:00.000Z"), new Date(date1[0] + "T23:59:59.000Z"));
                    filter4.where("mzk_scheduledstartdatetime", "today");

                    var finalFilter = new MobileCRM.FetchXml.Filter();
                    finalFilter.filters.push(filter0);//resource
                    finalFilter.filters.push(filter1);// Visit type
                    finalFilter.filters.push(filter2);//scheduleDateTime
                    finalFilter.filters.push(filter3);//Actual visit END date
                    finalFilter.filters.push(filter4);// Today's date
                    finalFilter.type = "and";
                    workorder.filter = finalFilter;

                    var fetch = new MobileCRM.FetchXml.Fetch(workorder);
                    fetch.execute(
                        "Array",
                        function (result) {
                            getDropNumber();
                            for (var i in result) {
                                var account = result;

                                if (result.length > 0) {
                                    var actualVisitEndDate2 = entityForm.entity.properties["mzk_actualvisitenddatetime"];
                                    if (actualVisitEndDate2 == undefined) {

                                        $("#btnStartButton").attr("disabled", true);
                                        // $('#btnFailed').attr('disabled', false);

                                        id01.style.display = "block";
                                        $('#disablingPanel').hide();
                                    }
                                    else {

                                        $('#btnStartButton').attr('disabled', false);
                                        //$('#btnFailed').attr('disabled', false);
                                    }
                                }
                                else {
                                    id01.style.display = "none";
                                    $('#btnStartButton').attr('disabled', false);
                                    //$('#btnFailed').attr('disabled', false);
                                }

                            }
                            if (result.length == 0) {
                                $('#btnStartButton').attr('disabled', false);
                            }
                            // $('#btnStartButton').attr('disabled', false);
                            //$('#btnFailed').attr('disabled', false);

                        },
                        function (err) {
                            MobileCRM.bridge.alert("Error fetching accounts: " + err);
                        },
                        null
                    );



                    var fetchQuery =
                        '<fetch resultformat="DynamicEntities">'
                        + '  <entity name="mzk_configuration">'
                        + '    <attribute name="mzk_bypassdeliverytemperaturecode" />'
                        + '    <attribute name="mzk_deliveryoutsidetempcodeforwholesaleorgord" />'
                        + '    <attribute name="mzk_deliveryoutsidetempcodeforemployeeorders" />'
                        + '  </entity>'
                        + '</fetch>';

                    MobileCRM.FetchXml.Fetch.executeFromXML(
                        fetchQuery,
                        function (result) {
                            if (result && result.length > 0) {
                                var record = result[0].properties;
                                bypassdeliverytemperaturecode = '';
                                deliveryoutsidetempcodeforwholesaleorgord = '';
                                deliveryoutsidetempcodeforemployeeorders = '';

                                if (record.hasOwnProperty("mzk_bypassdeliverytemperaturecode") && record["mzk_bypassdeliverytemperaturecode"] != undefined) {
                                    bypassdeliverytemperaturecode = record["mzk_bypassdeliverytemperaturecode"];
                                }
                                if (record.hasOwnProperty("mzk_deliveryoutsidetempcodeforwholesaleorgord") && record["mzk_deliveryoutsidetempcodeforwholesaleorgord"] != undefined) {
                                    deliveryoutsidetempcodeforwholesaleorgord = record["mzk_deliveryoutsidetempcodeforwholesaleorgord"];
                                }
                                if (record.hasOwnProperty("mzk_deliveryoutsidetempcodeforemployeeorders") && record["mzk_deliveryoutsidetempcodeforemployeeorders"] != undefined) {
                                    deliveryoutsidetempcodeforemployeeorders = record["mzk_deliveryoutsidetempcodeforemployeeorders"];
                                }
                            }
                        },
                        function (err) {
                            MobileCRM.bridge.alert("Error fetching organization phone: " + err);
                        },
                        null
                    );

                    var serviceAccount = entityForm.entity.properties["msdyn_serviceaccount"].id;

                    var entity = new MobileCRM.FetchXml.Entity("contact");
                    entity.addAttribute("mzk_failedpincode");
                    entity.addAttribute("contactid");
                    entity.addAttribute("fullname");
                    var linkEntity = entity.addLink("account", "primarycontactid", "contactid", "inner");
                    linkEntity.addFilter().where("accountid", "eq", serviceAccount);

                    var fetch = new MobileCRM.FetchXml.Fetch(entity);
                    fetch.execute(
                        "Array",
                        function (result) {
                            if (result != '') {
                                var data = result[0].toString().split(',');
                                allowDeliveryOutsideTemperature = (data[0] != '' && data[0] != undefined && data[0] != null) ? data[0] : '';
                                contact.id = (data[1] != '' && data[1] != undefined && data[1] != null) ? data[1] : '';
                                contact.name = (data[2] != '' && data[2] != undefined && data[2] != null) ? data[2] : '';
                            }
                        },
                        function (err) {
                            MobileCRM.bridge.alert("Error fetching code: " + err);
                        },
                        null
                    );


                    var fetchQuery =
                        '<fetch resultformat="DynamicEntities">'
                        + '<entity name="mzk_workorderproductpackagetemperature">'
                        + '    <attribute name="mzk_workorderproductpackagetemperatureid" />'
                        + '    <attribute name="mzk_temperature" />'
                        + '    <attribute name="mzk_productpackagetype" />'
                        + '    <filter type="and">'
                        + '        <condition attribute="mzk_workorder" operator="eq" value="' + workorderid + '" />'
                        + '    </filter>'
                        + '    <link-entity name="mzk_masterdata" from="mzk_masterdataid" to="mzk_productpackagetype" link-type="inner" alias="productpackagetype">'
                        + '        <attribute name="mzk_totemperaturerange" />'
                        + '        <attribute name="mzk_fromtemperaturerange" />'
                        + '        <attribute name="mzk_code" />'
                        + '    </link-entity>'
                        + '</entity>'
                        + '</fetch>';
                    MobileCRM.FetchXml.Fetch.executeFromXML(
                        fetchQuery,
                        function (result) {
                            if (result && result.length > 0) {

                                for (var i = 0; i < result.length; i++) {
                                    var record = result[i].properties;
                                    var id = '';
                                    var code = '';
                                    var fromtemperaturerange = '';
                                    var totemperaturerange = '';
                                    var tablehtml = '';
                                    if (record.hasOwnProperty("mzk_workorderproductpackagetemperatureid") && record["mzk_workorderproductpackagetemperatureid"] != undefined) {
                                        id = record["mzk_workorderproductpackagetemperatureid"];
                                    }
                                    if (record.hasOwnProperty("productpackagetype.mzk_code") && record["productpackagetype.mzk_code"] != undefined) {
                                        code = record["productpackagetype.mzk_code"];
                                    }
                                    if (record.hasOwnProperty("productpackagetype.mzk_fromtemperaturerange") && record["productpackagetype.mzk_fromtemperaturerange"] != undefined) {
                                        fromtemperaturerange = record["productpackagetype.mzk_fromtemperaturerange"];
                                    }
                                    if (record.hasOwnProperty("productpackagetype.mzk_totemperaturerange") && record["productpackagetype.mzk_totemperaturerange"] != undefined) {
                                        totemperaturerange = record["productpackagetype.mzk_totemperaturerange"];
                                    }

                                    tablehtml += '<tr class="workorderproductpackageTemperature" data-id="' + id + '" data-status="no" data-code="' + code + '"  data-fromtemperaturerange="' + fromtemperaturerange + '" data-totemperaturerange="' + totemperaturerange + '" >'
                                        + '<td>' + code + '</td>'
                                        + '<td><input style="font-weight: 400;" type="number" class="txtTemperature" maxlength="10" required="required" /><i class="bar"></i></td></tr>';
                                    $('#productPackageTypeList').append(tablehtml);

                                }

                                $('.txtTemperature').unbind('change').change(function () {
                                    try {
                                        var temperature = $(this).val();
                                        var target = $(this).closest('tr');
                                        var packageTemperatureId = $(target).data('id');
                                        var code = $(target).data('code');

                                        if (temperature != '') {

                                            if (temperature == bypassdeliverytemperaturecode) {
                                                $(target).data('status', 'skip');

                                                var total = $("#productPackageTypeList .workorderproductpackageTemperature").length;
                                                var skipped = $("#productPackageTypeList .workorderproductpackageTemperature").filter(function () {
                                                    return $(this).data('status') == 'skip';
                                                }).length;
                                                var verified = $("#productPackageTypeList .workorderproductpackageTemperature").filter(function () {
                                                    return $(this).data('status') == 'yes';
                                                }).length;

                                                if (total == skipped || total == verified || total == (skipped + verified)) {
                                                    productpackageTemperatureVerified = true;
                                                    enableRules();
                                                }
                                                else {
                                                    productpackageTemperatureVerified = false;
                                                    enableDisableInputs(true);
                                                }

                                            }
                                            else {
                                                var fetchQuery =
                                                    '<fetch resultformat="DynamicEntities">'
                                                    + '  <entity name="mzk_workorderproductpackagetemperature">'
                                                    + '    <attribute name="mzk_workorderproductpackagetemperatureid" />'
                                                    + '    <filter type="and">'
                                                    + '      <condition attribute="mzk_workorderproductpackagetemperatureid" operator="eq" value="' + packageTemperatureId + '" />'
                                                    + '    </filter>'
                                                    + '    <link-entity name="mzk_masterdata" from="mzk_masterdataid" to="mzk_productpackagetype" link-type="inner" alias="cc">     '
                                                    + '      <filter type="and">'
                                                    + '        <condition attribute="mzk_fromtemperaturerange" operator="le" value="' + temperature + '" />'
                                                    + '        <condition attribute="mzk_totemperaturerange" operator="ge" value="' + temperature + '" />'
                                                    + '      </filter>'
                                                    + '    </link-entity>'
                                                    + '  </entity>'
                                                    + '</fetch>';

                                                MobileCRM.FetchXml.Fetch.executeFromXML(
                                                    fetchQuery,
                                                    function (result) {
                                                        if (result && result.length > 0) {
                                                            $(target).data('status', 'yes');
                                                            var total = $("#productPackageTypeList .workorderproductpackageTemperature").length;
                                                            var skipped = $("#productPackageTypeList .workorderproductpackageTemperature").filter(function () {
                                                                return $(this).data('status') == 'skip';
                                                            }).length;
                                                            var verified = $("#productPackageTypeList .workorderproductpackageTemperature").filter(function () {
                                                                return $(this).data('status') == 'yes';
                                                            }).length;

                                                            if (total == skipped || total == verified || total == (skipped + verified)) {
                                                                productpackageTemperatureVerified = true;
                                                                enableRules();
                                                            }
                                                            else {
                                                                productpackageTemperatureVerified = false;
                                                                enableDisableInputs(true);
                                                            }

                                                        } else {
                                                            enableDisableInputs(true);
                                                            $(target).data('status', 'no');
                                                            $('#validationMessagePopup').find('label').text('Cannot proceed with the delivery, Product package temperature for ' + code + ' is outside the range, please call for further instructions”.');
                                                            $('#validationMessagePopup').show();
                                                        }
                                                    },
                                                    function (err) {
                                                        MobileCRM.bridge.alert("Error fetching organization phone: " + err);
                                                    },
                                                    null
                                                );
                                            }
                                        }

                                    } catch (e) {
                                        alert("error : " + e);
                                    }

                                });


                            } else {
                                $("#txtTemperatureBypasscode").attr("disabled", true);
                                enableRules();
                                $('#productPackageTypeList').append('<tr><td colspan="2">No items</td></tr>');
                            }
                        },
                        function (err) {
                            MobileCRM.bridge.alert("Error fetching organization phone: " + err);
                        },
                        null
                    );

                    var workorder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
                    var filter = workorder.addFilter();
                    filter.where("msdyn_workorderid", "eq", workorderid);
                    var caseEntity = workorder.addLink("incident", "incidentid", "msdyn_servicerequest", "inner");
                    var contractEntity = caseEntity.addLink("mzk_contractmanagement", "mzk_contractmanagementid", "mzk_contract", "inner");
                    contractEntity.addAttribute("mzk_deliveryconfirmationmethod");

                    var fetch = new MobileCRM.FetchXml.Fetch(workorder);

                    fetch.execute(
                        "Array",
                        function (result) {
                            try {
                                if (result.length > 0) {
                                    if (result[0] != undefined && result[0] != null && result[0] != '')
                                        if (result[0].toString() != '') {
                                            var data = result[0].toString().split(',');
                                            pinSignatureRule = (data[0] != '' && data[0] != undefined && data[0] != null) ? data[0] : -1;

                                            enableRules();
                                            enableDisableInputs(true);
                                        }
                                }
                            }
                            catch (e) {
                                alert(e);
                            }

                        },
                        function (err) {
                            MobileCRM.bridge.alert("Error fetching accounts: " + err);
                        },
                        null
                    );

                    var WorkOrderProduct = new MobileCRM.FetchXml.Entity("msdyn_workorderproduct");
                    WorkOrderProduct.addAttribute("msdyn_workorderproductid");
                    WorkOrderProduct.addAttribute("msdyn_product");
                    WorkOrderProduct.addAttribute("msdyn_quantity");

                    var workorderidFilter = new MobileCRM.FetchXml.Filter();
                    workorderidFilter.where("msdyn_workorder", "eq", workorderid);

                    var linestatusFilter = new MobileCRM.FetchXml.Filter();
                    linestatusFilter.where("msdyn_linestatus", "eq", 275380000); // ordered

                    var linkEntity = WorkOrderProduct.addLink("mzk_workorderproductpackage", "mzk_workorderproduct", "msdyn_workorderproductid", "inner");
                    linkEntity.addAttribute("mzk_workorderproductpackageid");
                    linkEntity.addAttribute("mzk_packageid");
                    linkEntity.addAttribute("mzk_batchnumber");
                    linkEntity.addAttribute("mzk_quantity");
                    linkEntity.addAttribute("mzk_packagestatus");
                    linkEntity.addAttribute("mzk_packagetype");

                    var finalFilter = new MobileCRM.FetchXml.Filter();
                    finalFilter.filters.push(workorderidFilter);//workorderid
                    finalFilter.filters.push(linestatusFilter);//linestatus
                    finalFilter.type = "and";
                    WorkOrderProduct.filter = finalFilter;

                    var fetchWorkOrderProduct = new MobileCRM.FetchXml.Fetch(WorkOrderProduct);
                    fetchWorkOrderProduct.execute(
                        "Array",
                        function (result) {
                            try {
                                $('#productList').empty();
                                if (result.length > 0) {
                                    for (var i = 0; i < result.length; i++) {
                                        var tablehtml = '';
                                        var data = result[i].toString().split(',');
                                        var workorderproductid = (data[0] != '' && data[0] != undefined && data[0] != null) ? data[0] : '';
                                        var product = (data[1] != '' && data[1] != undefined && data[1] != null) ? JSON.stringify(data[1]).slice(1, -1) : '';
                                        var totalquantity = (data[2] != '' && data[2] != undefined && data[2] != null) ? data[2] : '';
                                        var workorderproductpackageid = (data[3] != '' && data[3] != undefined && data[3] != null) ? data[3] : '';
                                        var packageid = (data[4] != '' && data[4] != undefined && data[4] != null) ? data[4] : '';
                                        var batchnumber = (data[5] != '' && data[5] != undefined && data[5] != null) ? data[5] : '';
                                        var quantity = (data[6] != '' && data[6] != undefined && data[6] != null) ? data[6] : '';
                                        var pkgestatus = (data[7] != '' && data[7] != undefined && data[7] != null) ? data[7] : '';
                                        var packageType = (data[8] != '' && data[8] != undefined && data[8] != null) ? data[8] : '';
                                        var packagestatus = pkgestatus == 275380000 ? 'Ordered' : (pkgestatus == 275380001 ? 'Delivered' : '');

                                        tablehtml += '<tr class="workorderproductpackage" data-workorderproductpackageid="' + workorderproductpackageid + '" data-productpackageid="' + packageid + '" data-product="' + product + '" data-totalquantity="' + totalquantity + '" data-packagestatus="' + pkgestatus + '"  data-workorderproductid="' + workorderproductid + '"  >'
                                            + '<td>' + packageid + '</td>'
                                            + '<td>' + packageType + '</td>'
                                            + '<td class="packagestatus">' + packagestatus + '</td></tr>';
                                        $('#productList').append(tablehtml);
                                    }
                                }
                                else {
                                    isWorkOrderPackage = true;

                                    var WorkOrderPackageItem = new MobileCRM.FetchXml.Entity("mzk_workorderpackageitems");
                                    WorkOrderPackageItem.addAttribute("mzk_workorderpackageitemsid");
                                    WorkOrderPackageItem.addAttribute("mzk_packageid");
                                    WorkOrderPackageItem.addAttribute("mzk_packagestatus");
                                    WorkOrderPackageItem.addAttribute("mzk_packagetype");

                                    var filter1 = new MobileCRM.FetchXml.Filter();
                                    filter1.where("mzk_workorder", "eq", workorderid);

                                    var filter2 = new MobileCRM.FetchXml.Filter();
                                    filter2.where("mzk_packagestatus", "eq", 275380000); // ordered

                                    var finalFilter = new MobileCRM.FetchXml.Filter();
                                    finalFilter.filters.push(filter1);
                                    finalFilter.filters.push(filter2);
                                    finalFilter.type = "and";
                                    WorkOrderPackageItem.filter = finalFilter;

                                    var fetchWorkOrderPackageItem = new MobileCRM.FetchXml.Fetch(WorkOrderPackageItem);
                                    fetchWorkOrderPackageItem.execute(
                                        "Array",
                                        function (result) {
                                            try {
                                                $('#productList').empty();
                                                if (result.length > 0) {
                                                    for (var i = 0; i < result.length; i++) {
                                                        var tablehtml = '';
                                                        var data = result[i].toString().split(',');

                                                        var workorderproductpackageid = (data[0] != '' && data[0] != undefined && data[0] != null) ? data[0] : '';
                                                        var packageid = (data[1] != '' && data[1] != undefined && data[1] != null) ? data[1] : '';
                                                        var pkgestatus = (data[2] != '' && data[2] != undefined && data[2] != null) ? data[2] : '';
                                                        var packageType = (data[3] != '' && data[3] != undefined && data[3] != null) ? data[3] : '';
                                                        var packagestatus = pkgestatus == 275380000 ? 'Ordered' : (pkgestatus == 275380001 ? 'Delivered' : '');

                                                        tablehtml += '<tr class="workorderproductpackage" data-workorderproductpackageid="' + workorderproductpackageid + '" data-productpackageid="' + packageid + '" data-packagestatus="' + pkgestatus + '"  >'
                                                            + '<td>' + packageid + '</td>'
                                                            + '<td>' + packageType + '</td>'
                                                            + '<td class="packagestatus">' + packagestatus + '</td></tr>';
                                                        $('#productList').append(tablehtml);
                                                    }

                                                    var WorkOrderProductsQuery = new MobileCRM.FetchXml.Entity("msdyn_workorderproduct");
                                                    WorkOrderProductsQuery.addAttribute("msdyn_workorderproductid");
                                                    WorkOrderProductsQuery.addAttribute("msdyn_quantity");

                                                    var WorkOrderProductsQueryfilter1 = new MobileCRM.FetchXml.Filter();
                                                    WorkOrderProductsQueryfilter1.where("msdyn_workorder", "eq", workorderid);

                                                    var WorkOrderProductsQueryfilter2 = new MobileCRM.FetchXml.Filter();
                                                    WorkOrderProductsQueryfilter2.where("msdyn_linestatus", "eq", 275380000); // ordered

                                                    var WorkOrderProductsQueryfinalFilter = new MobileCRM.FetchXml.Filter();
                                                    WorkOrderProductsQueryfinalFilter.filters.push(WorkOrderProductsQueryfilter1);
                                                    WorkOrderProductsQueryfinalFilter.filters.push(WorkOrderProductsQueryfilter2);
                                                    WorkOrderProductsQueryfinalFilter.type = "and";
                                                    WorkOrderProductsQuery.filter = WorkOrderProductsQueryfinalFilter;

                                                    var fetchWorkOrderProducts = new MobileCRM.FetchXml.Fetch(WorkOrderProductsQuery);
                                                    fetchWorkOrderProducts.execute(
                                                        "Array",
                                                        function (results) {
                                                            try {
                                                                workorderProducts = [];
                                                                if (results.length > 0) {
                                                                    for (var i = 0; i < results.length; i++) {

                                                                        var productdata = results[i].toString().split(',');
                                                                        var workorderproductsid = (productdata[0] != '' && productdata[0] != undefined && productdata[0] != null) ? productdata[0] : '';
                                                                        var workorderproductsquantity = (productdata[1] != '' && productdata[1] != undefined && productdata[1] != null) ? productdata[1] : 0;

                                                                        workorderProducts.push({ Id: workorderproductsid, Quantity: workorderproductsquantity });

                                                                    }
                                                                }

                                                            }
                                                            catch (e) {
                                                                alert("NominatedSignatory error : " + e);
                                                            }

                                                        })

                                                }
                                                else {

                                                    //EnableSignatureTab();
                                                    //$("#btnStartButton").attr("disabled", false);
                                                    $('#productList').append('<tr><td colspan="3">No items</td></tr>');

                                                    if (visitType != 275380003 && visitType != 275380004 && visitType != 275380007) {
                                                        enableRules();
                                                        $("#txtPackageSerial").attr("disabled", true);
                                                        //$("#btnscanbarcode").attr("disabled", true);
                                                    }

                                                }

                                            } catch (e) {
                                                alert("NominatedSignatory error : " + e);
                                            }

                                        })
                                }

                            } catch (e) {
                                alert("NominatedSignatory error : " + e);
                            }

                        },
                        function (err) {
                            MobileCRM.bridge.alert("Error fetching accounts: " + err);
                        },
                        null
                    );

                    if (patientaddressId != '' && patientaddressId != null) {
                        var fetchQuery =
                            '<fetch resultformat="DynamicEntities">'
                            + '  <entity name="mzk_customeraddress">'
                            + '    <attribute name="mzk_customeraddressid" />'
                            + '    <attribute name="mzk_name" />'
                            + '    <filter type="and">'
                            + '      <condition attribute="mzk_parentcustomeraddressid" operator="eq" value="' + patientaddressId + '" />'
                            + '    </filter>'
                            + '  </entity>'
                            + '</fetch>';

                        MobileCRM.FetchXml.Fetch.executeFromXML(
                            fetchQuery,
                            function (result) {
                                if (result && result.length > 0) {
                                    var record = result[0].properties;

                                    if (record.hasOwnProperty("mzk_customeraddressid") && record["mzk_customeraddressid"] != undefined) {
                                        customeraddressid = record["mzk_customeraddressid"];
                                    }
                                    if (record.hasOwnProperty("mzk_name") && record["mzk_name"] != undefined) {
                                        customeraddressname = record["mzk_name"];
                                    }
                                }
                            },
                            function (err) {
                                MobileCRM.bridge.alert("Error fetching address: " + err);
                            },
                            null
                        );
                    }



                },
                function (err) { alert(err); },
                null
            )
        }
        onLoad();

        MobileCRM.UI.EntityForm.onSave(
            function (entityForm) {
                var actualVisitEndDate1 = entityForm.entity.properties["mzk_actualvisitenddatetime"];
                var failurevisitreason = entityForm.entity.properties["mzk_failurevisitreason"];
                var skipvisitreason = entityForm.entity.properties["mzk_skipvisitreason"];

                var actualVisitStartDate1 = entityForm.entity.properties["mzk_actualvisitstartdatetime"];
                var recieveType = entityForm.entity.properties["mzk_recievingtype"];
                var recieveBy = entityForm.entity.properties["mzk_recievedby"];

                if (actualVisitEndDate1 == undefined) {
                    entityForm.cancelValidation("Press END before saving.");
                    return true;
                }

                else {
                    return false;
                }
            },
            true, null);

        //Skip Scenario
        var mzk_reasonCode = new MobileCRM.FetchXml.Entity("mzk_reasoncode");
        mzk_reasonCode.addAttribute("mzk_reasoncodeid");
        mzk_reasonCode.addAttribute("mzk_name");
        var filter = new MobileCRM.FetchXml.Filter();
        filter.where("mzk_reasontype", "eq", 275380009);
        mzk_reasonCode.filter = filter;

        var fetch = new MobileCRM.FetchXml.Fetch(mzk_reasonCode);
        fetch.execute(
            "Array",
            function (result) {
                try {
                    var LookUpDropDown = $('#ddlookUp')[0];
                    LookUpDropDown.options[LookUpDropDown.length] = new Option('Select', 0);
                    for (var i = 0; i < result.length; i++) {
                        var data = result[i].toString().split(',');
                        LookUpDropDown.options[LookUpDropDown.length] = new Option(data[1], data[0]);
                    }
                } catch (e) {
                    alert(e);
                }

            },
            function (err) {
                MobileCRM.bridge.alert("Error fetching accounts: " + err);
            },
            null
        );



        //Failed Scenario
        var mzk_reasonCode = new MobileCRM.FetchXml.Entity("mzk_reasoncode");
        mzk_reasonCode.addAttribute("mzk_reasoncodeid");
        mzk_reasonCode.addAttribute("mzk_name");
        var filter = new MobileCRM.FetchXml.Filter();
        filter.where("mzk_reasontype", "eq", 275380003);
        mzk_reasonCode.filter = filter;

        var fetch = new MobileCRM.FetchXml.Fetch(mzk_reasonCode);
        fetch.execute(
            "Array",
            function (result) {
                try {
                    var LookUpDropDown = $('#ddlookUpFailed')[0];
                    LookUpDropDown.options[LookUpDropDown.length] = new Option('Select', 0);
                    for (var i = 0; i < result.length; i++) {
                        var data = result[i].toString().split(',');
                        LookUpDropDown.options[LookUpDropDown.length] = new Option(data[1], data[0]);
                    }

                    $('#ddlookUpFailed').unbind('change').change(function () {
                        var failedReason = $('#ddlookUpFailed').val();
                        $($('#ddlookUpSubFailed')[0]).find('option').remove();

                        if (failedReason != 0 && failedReason != '') {
                            var fetchQuery =
                                '<fetch resultformat="DynamicEntities">'
                                + '    <entity name="mzk_faileddeliverysubreason">'
                                + '        <attribute name="mzk_faileddeliverysubreasonid" />'
                                + '        <attribute name="mzk_failsubreason" />'
                                + '        <filter type="and">'
                                + '            <condition attribute="mzk_reasoncode" operator="eq"  value="' + failedReason + '" />'
                                + '            <condition attribute="statecode" operator="eq" value="0" />'
                                + '        </filter>'
                                + '    </entity>'
                                + '</fetch>';

                            MobileCRM.FetchXml.Fetch.executeFromXML(
                                fetchQuery,
                                function (result) {
                                    if (result && result.length > 0) {
                                        $('#ddlookUpSubFailedDiv').show();
                                        var ddlookUpSubFailed = $('#ddlookUpSubFailed')[0];
                                        ddlookUpSubFailed.options[ddlookUpSubFailed.length] = new Option('Select', 0);
                                        if (result.length > 0) {
                                            for (var i in result) {
                                                var record = result[i].properties;
                                                ddlookUpSubFailed.options[ddlookUpSubFailed.length] = new Option(record["mzk_failsubreason"].primaryName, record["mzk_failsubreason"].id);
                                            }
                                        }

                                    } else {
                                        $('#ddlookUpSubFailedDiv').hide();
                                        $($('#ddlookUpSubFailed')[0]).find('option').remove();
                                    }

                                },
                                function (err) {
                                    MobileCRM.bridge.alert("Error fetching sub reasons: " + err);
                                },
                                null
                            );


                        }
                        else {
                            $('#ddlookUpSubFailedDiv').hide();
                            $($('#ddlookUpSubFailed')[0]).find('option').remove();
                        }
                    });
                } catch (e) {
                    alert(e);
                }

            },
            function (err) {
                MobileCRM.bridge.alert("Error fetching accounts: " + err);
            },
            null
        );


        $('#btnOK').click(function () {

            var selectedValue = $('#ddlookUp option:selected').val();
            if (selectedValue == 0) {
                alert("Select Reason to proceed");
            }
            else {
                MobileCRM.UI.EntityForm.requestObject(
                    btnOkClick,
                    onError, null);
            }

            function btnOkClick(entityForm) {
                try {
                    $('#disablingPanel').show();
                    $("#btnStartButton").attr("disabled", false);
                    $("#btnFailed").attr("disabled", true);
                    var selectedValue = $('#ddlookUp option:selected').val();
                    var selectedText = $('#ddlookUp option:selected').text();

                    var skipvisit = entityForm.entity;
                    skipvisit.properties["mzk_skipvisitreason"] = new MobileCRM.Reference("mzk_reasoncode", selectedValue, selectedText);
                    document.getElementById('id02').style.display = 'none';

                }
                catch (e) {
                    alert("An error occurred: " + e);
                }
            }
        });


        function ddlSelfClick(entityForm) {
            try {
                var selectedValue = $('#ddlRecievedBy option:selected').val();
                var selectedText = $('#ddlRecievedBy option:selected').text();
                var recievedType = entityForm.entity;
                recievedType.properties["mzk_recievingtype"] = selectedValue;

            }
            catch (e) {
                alert("An error occurred: " + e);
            }
        }
        //MobileCRM.UI.EntityForm.requestObject(
        //    ddlSignatoryClick,
        //    onError, null);

        //function ddlSignatoryClick(entityForm) {
        //    try {

        //        var selectedValue = $('#ddlRecieverName option:selected').val();
        //        var selectedText = $('#ddlRecieverName option:selected').text();

        //        var recievedBy = entityForm.entity;
        //        //recievedBy.properties["mzk_recievedby"] = new MobileCRM.Reference("contact", selectedValue, selectedText);
        //        if (selectedValue == 0)
        //            recievedBy.properties["mzk_recievedby"] = null;
        //        else
        //            recievedBy.properties["mzk_recievedby"] = new MobileCRM.Reference("contact", selectedValue, selectedText);
        //    }
        //    catch (e) {
        //        alert("An error occurred: " + e);
        //    }
        //}

        $('#ddlRecieverName').change(function () {

            MobileCRM.UI.EntityForm.requestObject(
                ddlSignatoryClick,
                onError, null);

            function ddlSignatoryClick(entityForm) {
                try {

                    document.getElementById("ddlRecieverName").disabled = false;

                    var selectedValue = $('#ddlRecieverName option:selected').val();
                    var selectedText = $('#ddlRecieverName option:selected').text();
                    nominatoryAddressid = '';
                    nominatoryAddressname = '';

                    if (selectedValue != 0 && selectedValue != '' && selectedValue != null && selectedValue != undefined) {
                        $("#btnStartButton").attr("disabled", false);
                        entityForm.entity.properties["mzk_recievedby"] = new MobileCRM.Reference("contact", selectedValue, selectedText);

                        if (nominatoryAddressList.length > 0) {
                            var filteredData = nominatoryAddressList.filter(
                                a => a.contactid == selectedValue
                            );

                            if (filteredData.length > 0) {
                                nominatoryAddressid = filteredData[0].addressid;
                                nominatoryAddressname = filteredData[0].addressname;
                            }
                        }

                    }
                    else {
                        entityForm.entity.properties["mzk_recievedby"] = null;
                    }
                }
                catch (e) {
                    alert("An error occurred: " + e);
                }
            }
        });

        var selectedOption = '';
        var isTemperatureUpdated = false;
        $("#ddlRecievedBy").change(function () {

            selectedOption = $("#ddlRecievedBy option:selected").val();

            MobileCRM.UI.EntityForm.requestObject(
                ddlSelfClick,
                onError, null);

            if (selectedOption == 275380002 || selectedOption == 275380003) {
                if (!isTemperatureUpdated) {
                    $('#productPackageTypeList :input').attr('disabled', true);
                    $("#txtTemperatureBypasscode").attr("disabled", true);
                }
            }

            if (selectedOption == 275380002) {
                //$('#txtOtherRecipient').val('');
                $('.otherRecipientDiv').hide();
                $('.receiverNameDiv').show();
                //$('#ddlRecieverName').val('0');
                //$('#ddlRecieverName').trigger("change");
                document.getElementById("ddlRecieverName").disabled = false;
                if (visitType == 275380001) {
                    patientDeliveryVisitRecipient();
                }
                else if (visitType == 275380006) {
                    wholesaleOrderRecipient();
                }
                else if (visitType == 275380002) {
                    employeeOrderRecipient();
                }
            }
            else if (selectedOption == 275380003) {
                document.getElementById("txtOtherRecipient").disabled = false;
                $("#btnStartButton").attr("disabled", false);

                // $('#txtOtherRecipient').val('');
                $('.otherRecipientDiv').show();
                $('.receiverNameDiv').hide();

            }
            else {
                var LookUpDropDown = $('#ddlRecieverName')[0];
                $('#ddlRecieverName').find('option').remove();
                LookUpDropDown.options[LookUpDropDown.length] = new Option('Select', 0);
                $("#ddlRecieverName").prop('disabled', 'disabled');
            }
        });

        function patientDeliveryVisitRecipient() {
            try {

                $('#ddlRecieverName').find('option').remove();
                var NominatedSignatoryDropDown = $('#ddlRecieverName')[0];
                NominatedSignatoryDropDown.options[NominatedSignatoryDropDown.length] = new Option('Select', 0);
                NominatedSignatoryDropDown.options[NominatedSignatoryDropDown.length] = new Option(contact.name, contact.id);

                var serviceAccount = "";
                var msdyn_workorder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
                msdyn_workorder.addAttribute("msdyn_serviceaccount");

                var fetch = new MobileCRM.FetchXml.Fetch(msdyn_workorder);

                fetch.execute("Array",
                    MobileCRM.UI.EntityForm.requestObject(
                        function (entityForm) {
                            serviceAccount = entityForm.entity.properties["msdyn_serviceaccount"].id;

                            var account = new MobileCRM.FetchXml.Entity("account");
                            var filter = account.addFilter();
                            filter.where("accountid", "eq", serviceAccount);

                            var contactEntity = account.addLink("contact", "contactid", "primarycontactid", "inner");

                            var relationEntity = contactEntity.addLink("mzk_relationship", "mzk_customer", "contactid", "inner");
                            var filter1 = new MobileCRM.FetchXml.Filter();
                            filter1.where("mzk_authorizerecipients", "eq", 1);
                            var filter2 = new MobileCRM.FetchXml.Filter();
                            filter2.where("statecode", "eq", 0);
                            var finalFilter = new MobileCRM.FetchXml.Filter();
                            finalFilter.filters.push(filter1);
                            finalFilter.filters.push(filter2);
                            finalFilter.type = "and";
                            relationEntity.filter = finalFilter;

                            var linkEntity = relationEntity.addLink("contact", "contactid", "mzk_connectedto", "inner");
                            linkEntity.addAttribute("contactid");
                            linkEntity.addAttribute("fullname");

                            var linkEntity1 = relationEntity.addLink("mzk_customeraddress", "mzk_customeraddressid", "mzk_customeraddress", "outer");
                            linkEntity1.addAttribute("mzk_customeraddressid");
                            linkEntity1.addAttribute("mzk_name");

                            var fetchcontact = new MobileCRM.FetchXml.Fetch(account);

                            fetchcontact.execute(
                                "Array",
                                function (result) {
                                    try {
                                        nominatoryAddressList = [];
                                        if (result.length > 0) {
                                            for (var i = 0; i < result.length; i++) {
                                                var data = result[i].toString().split(',');
                                                NominatedSignatoryDropDown.options[NominatedSignatoryDropDown.length] = new Option(data[1], data[0]);

                                                if (data[2] != '' && data[2] != undefined && data[3] != '' && data[3] != undefined) {
                                                    nominatoryAddressList.push({ 'contactid': data[0], 'contactname': data[1], 'addressid': data[2], 'addressname': data[3] });
                                                }
                                            }
                                            $("#ddlRecieverName").val($("#ddlRecieverName option:eq(1)").val());
                                            $('#ddlRecieverName').trigger("change");

                                        } else {
                                            if ($("#ddlRecieverName option:eq(1)").val() !== undefined) {
                                                $("#ddlRecieverName").val($("#ddlRecieverName option:eq(1)").val());
                                            }
                                            else {
                                                $("#ddlRecieverName").val($("#ddlRecieverName option:eq(0)").val());
                                            }
                                            $('#ddlRecieverName').trigger("change");
                                        }

                                    } catch (e) {
                                        alert("NominatedSignatory error : " + e);
                                    }

                                },
                                function (err) {
                                    MobileCRM.bridge.alert("Error fetching accounts: " + err);
                                },
                                null
                            );
                        })
                );


            } catch (e) {
                alert("An error occurred: " + e);
            }
        }

        function wholesaleOrderRecipient() {
            try {

                var fetchQuery =
                    "<fetch resultformat='DynamicEntities'>" +
                    "<entity name='mzk_addressauthorizedrecipient'>" +
                    "<attribute name='mzk_contact'/>" +
                    '<filter type="and">' +
                    '<condition attribute="mzk_name" operator="eq" value="' + patientaddressId + '"/>' +
                    "<condition attribute='statecode' operator='eq' value='0' />" +
                    "</filter>" +
                    '<link-entity name="contact" from="contactid" to="mzk_contact" link-type="inner" alias="contact">' +
                    '<attribute name="fullname" />' +
                    "</link-entity>" +
                    "</entity>" +
                    "</fetch>";

                MobileCRM.FetchXml.Fetch.executeFromXML(
                    fetchQuery,
                    function (result) {
                        if (result && result.length > 0) {

                            $('#ddlRecieverName').find('option').remove();
                            var authorizedRecipientddl = $('#ddlRecieverName')[0];
                            authorizedRecipientddl.options[authorizedRecipientddl.length] = new Option('Select', 0);
                            if (result.length > 0) {
                                for (var i in result) {
                                    var record = result[i].properties;
                                    authorizedRecipientddl.options[authorizedRecipientddl.length] = new Option(record["contact.fullname"], record["mzk_contact"].id);
                                }
                                $("#ddlRecieverName").val($("#ddlRecieverName option:eq(1)").val());
                                $('#ddlRecieverName').trigger("change");
                            }
                            else {
                                $("#ddlRecieverName").val($("#ddlRecieverName option:eq(0)").val());
                                $('#ddlRecieverName').trigger("change");
                            }

                        }

                    },
                    function (err) {
                        MobileCRM.bridge.alert("Error fetching recipients: " + err);
                    },
                    null
                );

            } catch (e) {
                alert("An error occurred: " + e);
            }
        }

        function employeeOrderRecipient() {
            try {
                MobileCRM.UI.EntityForm.requestObject(
                    function (entityForm) {

                        var serviceAccount = entityForm.entity.properties["msdyn_serviceaccount"].id;
                        var entity = new MobileCRM.FetchXml.Entity("contact");
                        entity.addAttribute("contactid");
                        entity.addAttribute("fullname");
                        var linkEntity = entity.addLink("account", "primarycontactid", "contactid", "inner");
                        linkEntity.addFilter().where("accountid", "eq", serviceAccount);

                        var fetch = new MobileCRM.FetchXml.Fetch(entity);
                        fetch.execute(
                            "Array",
                            function (result) {
                                if (result != '') {
                                    if (result[0].toString() != '') {
                                        var data = result[0].toString().split(',');
                                        contact.id = (data[0] != '' && data[0] != undefined && data[0] != null) ? data[0] : '';
                                        contact.name = (data[1] != '' && data[1] != undefined && data[1] != null) ? data[1] : '';

                                        $('#ddlRecieverName').find('option').remove();
                                        var authorizedRecipientddl = $('#ddlRecieverName')[0];
                                        authorizedRecipientddl.options[authorizedRecipientddl.length] = new Option('Select', 0);

                                        if (contact.id != '' && contact.name != '') {
                                            authorizedRecipientddl.options[authorizedRecipientddl.length] = new Option(contact.name, contact.id);
                                            $("#ddlRecieverName").val($("#ddlRecieverName option:eq(1)").val());
                                            $("#ddlRecieverName").attr("disabled", true);
                                            $('#ddlRecieverName').trigger("change");
                                        }
                                        else {
                                            $("#ddlRecieverName").val($("#ddlRecieverName option:eq(0)").val());
                                            $('#ddlRecieverName').trigger("change");
                                        }
                                    }
                                }
                            },
                            function (err) {
                                MobileCRM.bridge.alert("Error fetching code: " + err);
                            },
                            null
                        );




                    },
                    function (err) {
                        MobileCRM.bridge.alert("Error: " + err);
                    },
                    null
                );


            } catch (e) {
                alert("An error occurred: " + e);
            }
        }

        function getDropNumber() {
            var workorder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
            workorder.addAttribute("mzk_actualdropnumber");
            workorder.orderBy("mzk_actualdropnumber", true);

            var filter0 = new MobileCRM.FetchXml.Filter();
            filter0.where("mzk_resource", "eq", resourceid);

            var filter1 = new MobileCRM.FetchXml.Filter();
            filter1.isIn("mzk_visittype", ["275380001", "275380002", "275380003", "275380004", "275380006", "275380007"]);

            //var filter2 = new MobileCRM.FetchXml.Filter();
            //filter2.where("mzk_scheduledstartdatetime", "lt", scheduleDateTimeConversion);

            //var filter3 = new MobileCRM.FetchXml.Filter();
            //filter3.where("mzk_actualvisitenddatetime", "null");

            var filter4 = new MobileCRM.FetchXml.Filter();
            // filter4.between("mzk_scheduledstartdatetime", new Date(date1[0] + "T00:00:00.000Z"), new Date(date1[0] + "T23:59:59.000Z"));
            filter4.where("mzk_scheduledstartdatetime", "today");

            var finalFilter = new MobileCRM.FetchXml.Filter();
            finalFilter.filters.push(filter0);//resource
            finalFilter.filters.push(filter1);// Visit type
            //finalFilter.filters.push(filter2);//scheduleDateTime
            //finalFilter.filters.push(filter3);//Actual visit END date
            finalFilter.filters.push(filter4);// Today's date
            //finalFilter.filters.push(filter4);//  Visit Type equals Delivery Visit
            finalFilter.type = "and";
            workorder.filter = finalFilter;

            var fetch = new MobileCRM.FetchXml.Fetch(workorder);
            fetch.execute(
                "Array",
                function (result) {
                    if (result[0] != '' && result[0] != null && result[0] != undefined) {
                        if (!isNaN(parseInt(result[0]))) {
                            newDropNumber = parseInt(result[0]) + 1;
                        } else {
                            newDropNumber = 1;
                        }

                    } else {
                        newDropNumber = 1;
                    }

                },
                function (err) {
                    MobileCRM.bridge.alert("Error fetching accounts: " + err);
                },
                null
            );
        }

        $('#txtPackageSerial').change(function () {
            try {
                MobileCRM.UI.EntityForm.requestObject(
                    PackageSerialValidation,
                    onError, null);
            } catch (e) {
                alert("button error : " + e);
            }
        });

        function PackageSerialValidation(entityForm) {
            try {
                var msdyn_workorder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
                var packageSerial = $('#txtPackageSerial').val();
                var isMatched = false;

                $("#productList .workorderproductpackage").each(function (index) {
                    if ($('#txtPackageSerial').val() != '' && $(this).data('productpackageid') == $('#txtPackageSerial').val() && workorderProductPackageIds.indexOf($(this).data('workorderproductpackageid')) == -1) {
                        isMatched = true;
                        $(this).find('.packagestatus').text('Delivered');
                        if (workorderProductPackageIds.indexOf($(this).data('workorderproductpackageid')) == -1)
                            workorderProductPackageIds.push($(this).data('workorderproductpackageid'));

                        if (!isWorkOrderPackage) {
                            if (workorderProducts.filter(obj => obj.Id == $(this).data('workorderproductid')).length == 0) {
                                workorderProducts.push({ Id: $(this).data('workorderproductid'), Quantity: $(this).data('totalquantity') });
                            }
                        }
                    }
                });

                if (isMatched) {
                    $('#productPackageTypeList :input').attr('disabled', true);
                    $("#txtTemperatureBypasscode").attr("disabled", true);
                    $('#PackageSerialMatchedMessage').find('label').text("PACKID #" + $('#txtPackageSerial').val() + " has been successfully scanned.");
                    $('#PackageSerialMatchedMessage').show();
                }
                else {
                    beep();
                    var PackageSerialNotMatchedMessage = document.getElementById("PackageSerialNotMatchedMessage");
                    PackageSerialNotMatchedMessage.style.display = "block";
                }

                if ($("#productList .workorderproductpackage").length > 0 && (workorderProductPackageIds.length == $("#productList .workorderproductpackage").length)) {
                    //EnableSignatureTab();
                    //$("#btnStartButton").attr("disabled", false);
                    $("#txtPackageSerial").attr("disabled", true);
                    // $("#btnscanbarcode").attr("disabled", true);

                    if (visitType == 275380001 && (pinSignatureRule == 275380000 || pinSignatureRule == 275380002 || pinSignatureRule == 275380003)) {
                        EnableSignatureTab();
                    } else {
                        DisableSignatureTab();
                    }

                    if (visitType == 275380002 || visitType == 275380006) {
                        EnableSignatureTab();
                    }

                    if (visitType == 275380001) {
                        if (pinSignatureRule == 275380001 || pinSignatureRule == 275380002 || pinSignatureRule == 275380003) {
                            $('#txtPincode').attr('disabled', false);
                            $('#btnVerify').attr('disabled', false);
                        }
                        if (pinSignatureRule == -1 || pinSignatureRule == 275380000 || pinSignatureRule == 275380003) {
                            document.getElementById("ddlRecievedBy").disabled = false;
                            $("#ddlRecievedBy").val($("#ddlRecievedBy option:eq(1)").val());
                            $('#ddlRecievedBy').trigger("change");
                        }
                    }
                    if (visitType == 275380002 || visitType == 275380006) {

                        document.getElementById("ddlRecievedBy").disabled = false;
                        $("#ddlRecievedBy").val($("#ddlRecievedBy option:eq(1)").val());
                        $('#ddlRecievedBy').trigger("change");
                    }


                }
                else {
                    // DisableSignatureTab();
                    // $("#btnStartButton").attr("disabled", false);
                    $("#txtPackageSerial").attr("disabled", false);
                    // $("#btnscanbarcode").attr("disabled", false);
                }
            }
            catch (e) {
                alert("error : " + e);
            }
        }

        function setVisitStatusDelivered() {

            var VisitStatus = '';
            var WorkOrder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
            WorkOrder.addAttribute("mzk_visitstatus");
            WorkOrder.addAttribute("mzk_otherrecipientname");
            var fetch = new MobileCRM.FetchXml.Fetch(WorkOrder);
            fetch.execute(
                "Array",
                MobileCRM.UI.EntityForm.requestObject(
                    function (entityForm) {
                        try {
                            VisitStatus = entityForm.entity;

                            VisitStatus.properties["mzk_visitstatus"] = 275380016; //Delivered

                            if (visitType == 275380003 || visitType == 275380004 || visitType == 275380007) {
                                VisitStatus.properties["mzk_collectedfrom"] = $('#txtCollectedFrom').val();
                                VisitStatus.properties["mzk_visitstatus"] = 275380018; // Collected
                            }

                            if ($('#ddlRecievedBy').val() == 275380003) {
                                VisitStatus.properties["mzk_otherrecipientname"] = $('#txtOtherRecipient').val();
                            }

                            if ($('#txtTemperatureBypasscode').val() != '') {
                                VisitStatus.properties["mzk_temperaturebypasscode"] = $('#txtTemperatureBypasscode').val();
                            }

                            if (visitType == 275380001) {
                                if ($('#ddlRecievedBy').val() == 275380002) {
                                    if (nominatoryAddressid != '' && nominatoryAddressname != '')
                                        VisitStatus.properties["mzk_customeraddress"] = new MobileCRM.Reference("mzk_customeraddress", nominatoryAddressid, nominatoryAddressname);
                                    else if (customeraddressid != '' && customeraddressname != '')
                                        VisitStatus.properties["mzk_customeraddress"] = new MobileCRM.Reference("mzk_customeraddress", customeraddressid, customeraddressname);
                                }
                                else if ($('#ddlRecievedBy').val() == 275380003) {
                                    if (customeraddressid != '' && customeraddressname != '')
                                        VisitStatus.properties["mzk_customeraddress"] = new MobileCRM.Reference("mzk_customeraddress", customeraddressid, customeraddressname);
                                }
                            }

                            if (visitType == 275380002 || visitType == 275380006) {
                                if (customeraddressid != '' && customeraddressname != '')
                                    VisitStatus.properties["mzk_customeraddress"] = new MobileCRM.Reference("mzk_customeraddress", customeraddressid, customeraddressname);

                            }

                            var media = entityForm.getMediaTab("Signature");
                            media.clear();
                            saveAndCloseForm();

                        } catch (e) {
                            alert("set line status field error : " + e);
                        }
                    },
                    function (err) {
                        MobileCRM.bridge.alert("Error fetching accounts: " + err);
                    },
                    null
                ));
        }
        function saveAndCloseForm() {
            MobileCRM.UI.EntityForm.requestObject(
                function (entityForm) {
                    if (entityForm)
                        MobileCRM.UI.EntityForm.saveAndClose();
                },
                function (err) {
                    MobileCRM.bridge.alert("An error occurred: " + err);
                },
                null
            );
        }
        function setPackageStatusDelivered(workorderProductPackageId) {
            var WorkOrderProductPackage = new MobileCRM.DynamicEntity("mzk_workorderproductpackage", workorderProductPackageId);
            var props = WorkOrderProductPackage.properties;
            props.mzk_packagestatus = 275380001; // Delivered
            WorkOrderProductPackage.save(
                function (error) {
                    if (error) {
                        MobileCRM.bridge.alert("An error occurred: " + error);
                    }
                }
            );
        }
        function setWorkOrderPackageStatusDelivered(workorderPackageId) {
            var WorkOrderPackage = new MobileCRM.DynamicEntity("mzk_workorderpackageitems", workorderPackageId);
            var props = WorkOrderPackage.properties;
            props.mzk_packagestatus = 275380001; // Delivered
            WorkOrderPackage.save(
                function (error) {
                    if (error) {
                        MobileCRM.bridge.alert("An error occurred: " + error);
                    }
                }
            );
        }
        function setWOProductStatusDelivered(workorderProduct) {
            var WorkOrderProduct = new MobileCRM.DynamicEntity("msdyn_workorderproduct", workorderProduct.Id);
            var props = WorkOrderProduct.properties;
            props.msdyn_linestatus = 275380001;
            props.mzk_delivered = Number(workorderProduct.Quantity).toFixed(2);
            WorkOrderProduct.save(
                function (error) {
                    if (error) {
                        MobileCRM.bridge.alert("An error occurredd: " + error);
                    }
                }
            );
        }
        function setVisitStatusFailed() {

            var VisitStatus = '';
            var WorkOrder = new MobileCRM.FetchXml.Entity("msdyn_workorder");
            WorkOrder.addAttribute("mzk_visitstatus");
            var fetch = new MobileCRM.FetchXml.Fetch(WorkOrder);
            fetch.execute(
                "Array",
                MobileCRM.UI.EntityForm.requestObject(
                    function (entityForm) {
                        try {
                            VisitStatus = entityForm.entity;
                            VisitStatus.properties["mzk_visitstatus"] = 275380011;

                        } catch (e) {
                            alert("set Visit status field error : " + e);
                        }
                    },
                    function (err) {
                        MobileCRM.bridge.alert("Error fetching accounts: " + err);
                    },
                    null
                ));
        }
        function loadPrimaryContact() {
            try {
                if (patientaddressId != "") {
                    var fetchQuery =
                        "<fetch resultformat='DynamicEntities'>" +
                        "<entity name='customeraddress'>" +
                        "<attribute name='telephone1'/>" +
                        '<filter type="and">' +
                        '<condition attribute="customeraddressid" operator="eq" value="' + patientaddressId + '"/>' +
                        "</filter>" +
                        "</entity>" +
                        "</fetch>";
                    MobileCRM.FetchXml.Fetch.executeFromXML(
                        fetchQuery,
                        function (result) {
                            if (result && result.length > 0) {
                                var record = result[0].properties;

                                if (record.hasOwnProperty("telephone1")) {
                                    var phone = record["telephone1"];

                                    MobileCRM.UI.EntityForm.requestObject(
                                        function (entityForm) {
                                            entityForm.entity.properties["mzk_primarycontact"] = phone;

                                        },
                                        function (err) {
                                            MobileCRM.bridge.alert("An error occurred:" + err);
                                        }, null);
                                }
                            }
                        },
                        function (err) {
                            MobileCRM.bridge.alert("Error fetching organization phone: " + err);
                        },
                        null
                    );
                }

            } catch (e) {
                alert("An error occurred: " + e);
            }
        }

        function UpdatePackageTypeTemperatures(id, temperature) {
            var productpackagetemperature = new MobileCRM.DynamicEntity("mzk_workorderproductpackagetemperature", id);
            var props = productpackagetemperature.properties;
            props.mzk_temperature = Number(temperature).toFixed(1);
            productpackagetemperature.save(
                function (error) {
                    if (error) {
                        MobileCRM.bridge.alert("An error occurred: " + error);
                    }
                }
            );
        }

        $('#txtTemperatureBypasscode').change(function () {
            try {
                var temperature = $(this).val();
                if (temperature != '') {

                    if (visitType == 275380001 || visitType == 275380003) {
                        if (temperature == allowDeliveryOutsideTemperature) {
                            productpackageTemperatureVerified = true;
                            enableRules();
                            $("#productPackageTypeList .workorderproductpackageTemperature").each(function (index) {
                                $(this).data('status', 'skip');
                            });
                        }
                        else {
                            productpackageTemperatureVerified = false;
                            enableDisableInputs(true);
                            $('#validationMessagePopup').find('label').text('Invalid code.');
                            $('#validationMessagePopup').show();
                        }
                    }
                    else if (visitType == 275380006 || visitType == 275380007 || visitType == 275380004) {
                        if (temperature == deliveryoutsidetempcodeforwholesaleorgord) {
                            productpackageTemperatureVerified = true;
                            enableRules();
                            $("#productPackageTypeList .workorderproductpackageTemperature").each(function (index) {
                                $(this).data('status', 'skip');
                            });
                        }
                        else {
                            productpackageTemperatureVerified = false;
                            enableDisableInputs(true);
                            $('#validationMessagePopup').find('label').text('Invalid code.');
                            $('#validationMessagePopup').show();
                        }
                    }
                    else if (visitType == 275380002) {
                        if (temperature == deliveryoutsidetempcodeforemployeeorders) {
                            productpackageTemperatureVerified = true;
                            enableRules();
                            $("#productPackageTypeList .workorderproductpackageTemperature").each(function (index) {
                                $(this).data('status', 'skip');
                            });
                        } else {
                            productpackageTemperatureVerified = false;
                            enableDisableInputs(true);
                            $('#validationMessagePopup').find('label').text('Invalid code.');
                            $('#validationMessagePopup').show();
                        }
                    }
                }

            } catch (e) {
                alert("error : " + e);
            }

        });

        function enableRules() {

            document.getElementById("txtPackageSerial").disabled = false;
            //document.getElementById("btnscanbarcode").disabled = false;

            document.getElementById("txtPincode").disabled = true;
            document.getElementById("btnVerify").disabled = true;

            document.getElementById("ddlRecievedBy").disabled = true;
            document.getElementById("ddlRecieverName").disabled = true;

            $('#failedDeliveryPinBlock').hide();
            $('#collectedFromDiv').hide();

            if (visitType == 275380001 && (pinSignatureRule == 275380001 || pinSignatureRule == 275380002 || pinSignatureRule == 275380003)) {
                $('#pinVerificationDiv').show();
            }
            else {
                $('#pinVerificationDiv').hide();
            }

            //if (visitType == 275380001 && (pinSignatureRule == 275380000 || pinSignatureRule == 275380002 || pinSignatureRule == 275380003)) {
            //    EnableSignatureTab();
            //} else {
            //    DisableSignatureTab();
            //}

            if (visitType == 275380003 || visitType == 275380004 || visitType == 275380007) {
                $('#pinVerificationDiv').hide();
                $('#packageSerialBlock').hide();
                $('#packageTableDiv').hide();
                $('#receiverBlock').hide();
                $('.nextLine').hide();
                $('#collectedFromDiv').show();
                document.getElementById("txtCollectedFrom").disabled = false;

                if ($("#productPackageTypeList .workorderproductpackageTemperature").length == 0) {
                    document.getElementById("txtCollectedFrom").disabled = false;
                }

                EnableSignatureTab();
            }
            if (visitType == 275380002 || visitType == 275380006) {

                $('#pinVerificationDiv').hide();
                $('#packageSerialBlock').show();
                $('#packageTableDiv').show();
                if ($("#productList .workorderproductpackage").length == 0) {
                    document.getElementById("txtPackageSerial").disabled = true;
                    //document.getElementById("btnscanbarcode").disabled = true;
                    document.getElementById("ddlRecievedBy").disabled = false;
                }
                // EnableSignatureTab();
            }

            if (visitType == 275380001 && $("#productList .workorderproductpackage").length == 0) {
                document.getElementById("txtPackageSerial").disabled = true;
                //document.getElementById("btnscanbarcode").disabled = true;

                if (pinSignatureRule == 275380001 || pinSignatureRule == 275380002 || pinSignatureRule == 275380003) {
                    $('#txtPincode').attr('disabled', false);
                    $('#btnVerify').attr('disabled', false);
                }
                else {
                    document.getElementById("ddlRecievedBy").disabled = false;
                }
            }


        }

        function enableDisableInputs(val) {
            $('#verificationDiv select').attr('disabled', val);
            $('#verificationDiv input').attr('disabled', val);
            $('#verificationDiv button').attr('disabled', val);
        }

        function barCode() {
            MobileCRM.Platform.scanBarCode(
                function (barcodes) {
                    var packageSerial = $('#txtPackageSerial').val();
                    packageSerial = barcodes;
                },
                MobileCRM.bridge.alert
            );
        }
        function beep() {
            var snd = new Audio("data:audio/wav;base64,UklGRvRoAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YdBoAAAFWvxZAloBWv1ZBVr6WQRa/1n/WQJa/1kAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAVr+WQJa/1kAWgBaAVr9WQVa+1kEWv1ZAVoAWgFa/lkDWvxZBFr9pQKm/qUCpv+lAKYApgCmAKYApgCmAKYApgGm/qUCpv+lAKYApgCmAab+pQKm/aUDpv+l/6UBpv+lAab/pQKm/aUCpgCm/qUDpv6lAab/pQGm/6UCpv6lAab/pQGmAab9WQRa/FkDWv9Z/1kCWv5ZAlr/WQBaAFoAWgBaAVr+WQJa/1n/WQNa/FkEWv1ZAlr/WQBaAFoBWv9ZAVr/WQBaAVr/WQFa/1kAWgFa/1kBWgBa/lkDWv1ZAloAWv9ZAab/pQGm/6UBpv+lAab/pQGm/6UApgGm/6UBpv+l/6UDpv2lA6b+pf+lA6b9pQOm/aUDpvylBab8pQKmAKb+pQKmAKb/pQGmAKb+pQOm/qUBpgCm/6UBpv+lAaYApv+lAlr8WQVa/FkDWv5ZAVr/WQFa/1kBWv9ZAVr/WQFa/1kBWv9ZAVoAWv9ZAVoAWv9ZAlr+WQFaAVr+WQJa/lkBWgFa/lkCWv5ZAVoAWv9ZAVoAWv9ZAVr/WQFaAFr/WQJa/aUDpv2lA6b+pQGm/6UBpv+lAab/pQCmAqb9pQOm/aUDpv2lBKb8pQOm/qUBpgCmAKYApv+lAab/pQGmAKb/pQCmAqb8pQWm+6UEpv6lAab/pQCmAKYBpv+lAab+pQJa/1kBWv5ZAlr/WQFa/1kAWgFa/1kBWv9ZAFoBWv9ZAVr/WQBaAFoBWv9ZAFoBWv9ZAFoBWv5ZA1r9WQNa/VkDWv1ZA1r9WQNa/VkDWv1ZA1r9WQJa/1kAWgFa/1kAWgGm/qUDpvylBKb9pQKm/6UApgGm/qUDpv2lAqb/pQCmAab/pQCmAKYBpv6lAqb+pQKmAKb+pQKm/6X/pQSm/KUCpgCm/qUEpvulBab8pQKmAab9pQOm/aUDpv2lA6b+WQBaAVr/WQFa/1kBWv9ZAVr/WQFa/lkDWv1ZA1r9WQFaAVr+WQNa/VkCWv5ZAlr/WQBaAlr8WQNa/1kAWgFa/1n/WQJa/1kAWgFa/1kAWgFa/1kAWgFa/1kAWgFa/lkCpv6lAqb+pQKm/6X/pQKm/6UApgGm/6UApgGm/qUCpv+lAab/pf+lAqb/pQCmAqb8pQSm/aUCpv+lAab+pQOm/aUCpv+lAKYApgGm/6UApgGm/qUCpv6lA6b8pQWm+6UDWv9ZAFoBWv9ZAFoAWgFa/1kAWgBa/1kDWv1ZAlr+WQFaAVr+WQJa/lkCWv5ZAlr+WQFaAFoAWv9ZAlr9WQNa/lkBWgBa/1kCWv1ZA1r+WQFaAFr/WQJa/VkDWv5ZAaYApgCm/6UBpgCm/6UCpv6lAaYApv+lAqb+pQKm/qUBpgCmAKYApgCmAKYApgCmAab+pQKm/qUCpv+lAKYApv+lA6b9pQKm/qUBpgCmAab+pQOm+6UGpvulBKb9pQGmAVr/WQFa/1kAWgFaAFr/WQJa/VkDWv5ZAVoAWv9ZAlr+WQFaAFr/WQJa/lkBWgBaAFr/WQJa/VkDWv5ZAVoAWgBa/lkDWv5ZAVoAWv9ZAVoAWv9ZAlr9WQRa/FkDWv+l/qUEpvylA6b+pQGmAKYApv+lAqb+pQKm/qUCpv6lAqb+pQKm/qUCpv6lAaYBpv2lBKb8pQOm/qUCpv2lBab6pQWm/aUBpgCmAKYBpv+lAKYApgCmAab/pQGm/qUDpv1ZA1r9WQJa/lkDWvxZBVr7WQNa/1n/WQNa/VkCWv9ZAFoBWv9ZAVr/WQFa/1kBWgBaAFr/WQFaAFoAWgBaAFoAWgBaAFr/WQNa/FkEWvxZA1r+WQJa/lkCWv5ZAlr+WQKm/aUFpvqlBqb6pQWm/aUCpv2lA6b+pQGmAKb/pQGm/6UBpv+lAab/pQGm/6UBpv6lA6b+pQCmAqb8pQWm/KUCpgCm/6UBpv+lAab/pQGm/6UBpv+lAKYBpv6lA6b9WQJa/1n/WQJa/lkCWv5ZAVoAWv9ZAlr+WQBaAlr9WQNa/1n/WQJa/lkBWgBaAVr+WQJa/VkDWv9Z/1kCWv1ZBFr7WQVa/FkDWv9Z/1kBWgBa/1kCWv5ZAlr9WQRa/FkEpv2lAqb+pQOm/KUFpvqlB6b5pQam+6UDpgCm/qUDpv2lAqYApv+lAKYCpv2lBKb7pQSm/qUBpgCm/qUDpv6lAaYApv6lBKb7pQWm/aUApgKm/aUDpv6lAab/pQGmAFr/WQFa/1kBWv9ZAVr/WQFa/1kBWv5ZA1r9WQNa/lkBWv9ZAFoBWgBaAFoAWv9ZAFoDWvxZA1r+WQFaAFoBWv1ZBFr8WQRa/FkDWv9Z/1kDWvtZBVr9WQFaAVr9WQRa/KUDpv6lAaYApv+lAab/pQGm/6UApgGm/6UBpv+lAKYApgGm/6UApgGm/aUFpvulBKb9pQKm/qUCpv6lAqb/pf+lAaYApv+lAqb9pQOm/qUBpgCmAKYApgCmAKYApgCmAFoAWgBaAFoAWgBaAFr/WQJa/lkDWv1ZAlr/WQBaAVr/WQFa/1kAWgFa/1kBWv9ZAFoBWv9ZAVr/WQFa/1kAWgFa/1kBWv9ZAFoAWgFa/lkDWvxZBFr9WQJa/1kAWgCmAKYBpv+lAab+pQOm/aUCpv+lAKYCpv2lAqb/pQCmAab/pQGm/6UBpv6lA6b8pQWm/KUCpgCm/qUDpv2lA6b+pQGm/6UBpv+lAab/pQGmAKb+pQOm/aUDpv6lAab/pQFa/1kAWgJa/VkDWv1ZAloAWv5ZA1r9WQNa/lkAWgJa/VkDWv5ZAVoAWgBa/1kCWv1ZA1r+WQFaAFr/WQJa/VkEWvtZBVr8WQNa/lkBWgBa/1kBWgBa/1kCWv5ZAFoDpvulBqb5pQem+6UDpv6lAaYApgCmAab9pQOm/qUCpv6lAqb+pQGmAKb/pQKm/qUBpgCm/6UCpv2lA6b9pQOm/qUBpv+lAKYApgGmAKb+pQKm/qUCpv+l/6UCpv6lAqb+WQFaAFoAWgBaAFr/WQJa/lkBWgBa/1kBWgBaAFr/WQJa/FkFWv1ZAVoAWv9ZAVoAWgBa/1kBWv9ZAVr/WQFa/1kBWv9ZAFoBWv9ZAVr/WQFaAFr/WQFaAFr/WQFaAFr+pQOm/qUBpgCm/qUCpv+lAaYApv6lAqb+pQKm/6UApgCmAKYApgCmAKYBpv6lA6b9pQKmAKb+pQSm/KUDpv6lAaYApgCmAKb/pQKm/aUEpvylBKb8pQOm/6X/pQOm/VkCWv9ZAVr/WQFa/1kBWv9ZAVr/WQFaAFr+WQNa/VkDWv5ZAVr/WQJa/VkDWv1ZA1r9WQNa/VkCWv9ZAFoBWv9ZAVr/WQFa/1kBWv9ZAVoAWv9ZAVr+WQNa/VkDWv5ZAKYBpv+lAab/pQCmAab+pQKm/6UApgGm/qUCpv6lA6b+pQCmAab/pQCmAab/pQCmAqb8pQWm+6UEpv6lAKYBpv+lAab/pQGm/qUCpv+lAab/pQCmAKYBpv6lA6b8pQRa/VkBWgBaAFoAWgBaAFoAWgBaAFoAWgFa/lkDWv1ZAlr/WQBaAVr/WQFa/1kAWgFa/1kBWgBa/lkDWv1ZA1r+WQFa/1kBWv9ZAVr/WQFa/1kBWv5ZAlr/WQFa/1kAWgCmAab/pQGm/qUDpvylBKb9pQKm/6UApgCmAKYApgGm/6UBpv+l/6UDpv2lA6b9pQGmAKYBpv6lAqb/pf+lA6b9pQKm/6UBpv+lAab/pQGm/6UApgCmAab/pQCm/6UBpgFa/lkCWv5ZAVoAWgFa/lkCWv5ZAVoBWv5ZAlr+WQFaAVr9WQRa/VkBWgBaAFoAWgBaAFr/WQJa/1kAWgBaAFr/WQNa/VkBWgFa/lkCWv5ZAlr+WQNa/FkEWvxZBFr+pQCmAab+pQOm/qUBpv+lAab/pQGm/6UBpv+lAab/pQGm/6UBpv+lAab/pQGm/6UBpv6lA6b9pQKm/qUCpv6lA6b8pQOm/6X/pQKm/qUCpv+lAKYApgGm/qUEpvulBKb+WQBaAlr9WQNa/FkFWvtZBVr7WQRa/VkCWv9ZAFoBWv9ZAVr+WQJa/1kBWv5ZA1r8WQRa/ln/WQNa/VkCWv9Z/1kDWv1ZAlr+WQJa/VkEWv1ZAlr+WQJa/VkEWv1ZAaYBpv6lAqb+pQKm/qUCpv6lAqb/pf+lAqb9pQSm/aUBpgCm/6UCpv6lAaYApv+lAqb9pQOm/qUApgGm/6UBpv+lAKYApgGm/6UBpv6lAqb/pQCmAab/pQCmAab+pQKm/1kAWgFa/1kBWv9ZAFoBWv9ZAVr/WQBaAVr/WQBaAFoBWv5ZA1r9WQFaAVr+WQJa/1kAWgFa/lkCWv5ZAloAWv5ZAlr/Wf9ZA1r8WQRa/FkDWv9ZAFoAWv9ZAVoAWgFa/aUEpvylA6b/pQCmAKYApgCmAKYApgGm/aUFpvqlBqb6pQam+6UEpvylBKb9pQKm/6X/pQOm/aUCpv+l/6UDpv2lAqYApv6lA6b9pQKm/6UBpv+lAab+pQKm/6UApgFa/lkCWv9ZAVr/WQFa/lkDWv5ZAlr9WQNa/lkCWv5ZAVoAWgBaAVr9WQRa/FkEWv1ZAVoBWv5ZAlr+WQJa/1kAWgBaAFoAWgFa/1kAWgBaAFoAWgBaAVr9WQVa+lkGWvulA6b/pQCmAab+pQOm/KUEpv2lAqb/pQCmAab+pQOm/aUCpv+lAab/pQGm/6UBpv+lAaYApv6lA6b+pQGmAKb/pQCmAab/pQGmAKb+pQOm/aUCpgCm/qUDpv2lAqb/WQBaAVr+WQJa/1n/WQNa/FkEWv1ZAVoAWgFa/lkCWv5ZAlr+WQJa/lkBWgBa/1kCWv1ZBFr7WQVa/VkAWgJa/lkBWgBa/1kBWgBa/1kCWv1ZA1r+WQFaAFr/WQJa/lkBpgCm/6UCpv6lAqb+pQKm/qUCpv6lA6b8pQSm/aUCpv6lA6b8pQSm/KUEpv2lAaYApv+lA6b9pQGm/6UCpv+lAKYApv+lAqb+pQKm/qUCpv6lAqb/pQCmAKYApgCmAKYBWv5ZAlr+WQJa/lkCWv9ZAFoBWv9Z/1kDWv1ZA1r+WQBaAVoAWgBa/1kCWv5ZAVoAWv9ZAlr+WQFaAFoAWv9ZAVr/WQNa/FkDWv5ZAVoBWv1ZA1r+WQFaAFoAWv9ZAaYApv+lAqb+pQGmAKb/pQGm/6UBpgCm/6UBpv+lAaYApv+lAab/pQCmAqb9pQOm/aUCpv+lAab/pQGm/6UBpv+lAab/pQGm/6UBpv+lAaYApv+lAab/pQCmAqb+pQGm/1kBWgBa/1kBWgBa/1kCWv1ZAlr/WQFa/1kAWgFa/lkDWv1ZA1r9WQJa/1kBWgBa/1kBWv9ZAlr+WQFa/1kBWgBaAFoAWv9ZAVr/WQFaAFr/WQFa/lkDWv1ZA1r9WQKm/6UBpv+lAab/pQCmAab/pQCmAab+pQKm/6UApgCmAKYBpv6lAqb+pQKm/qUDpvylA6b/pf+lA6b9pQGmAKYApgCmAKYApgCmAKYApgCmAKYBpv+lAKYApgGm/qUDpv1ZAloAWv5ZAloAWv9ZAVr+WQJa/1kCWv1ZAlr/WQBaAVr/WQFaAFr+WQNa/FkEWv5ZAFoBWv9ZAFoBWv9ZAVr/WQFa/lkDWv1ZAlr/WQBaAFoBWv5ZAlr+WQNa/VkCWv6lAqb/pQGm/6UApgGm/qUCpv6lA6b9pQKm/6X/pQOm/aUCpgCm/6UApgGm/6UCpv2lA6b9pQKmAKb/pQGmAKb+pQOm/qUBpgCm/6UBpgCmAKb/pQKm/aUEpvylA6b+WQFa/1kBWv9ZAlr8WQVa+1kFWvxZAlr/WQFaAFr/WQFa/1kBWv9ZAVr/WQFa/1kBWgBa/1kCWv1ZBFr8WQNa/1n/WQJa/lkBWgBa/1kBWgBa/1kBWv9ZAVoAWv9ZAVr/pQGm/6UCpvylBab8pQKmAKb+pQOm/qUBpv+lAaYApgCmAKb/pQGmAKYBpv6lAqb+pQGmAab+pQKm/6UApgGm/qUCpv+lAKYBpv2lBKb8pQSm/KUCpgGm/aUEpvylAloAWv9ZAVr/WQFa/1kBWv9ZAVr/WQBaAlr9WQRa+1kEWv5ZAVr/WQFa/lkDWv1ZAlr+WQJa/lkCWv5ZAVoAWgBa/1kCWv5ZAVoBWv1ZBFr8WQRa/VkCWv5ZAlr/WQBaAab+pQKm/qUCpv+lAKYBpv2lBKb9pQKm/6UApgCmAKYBpv6lAqb+pQGmAab9pQOm/qUBpgCm/6UApgKm/aUEpvulBab8pQOm/qUBpgCm/6UCpv6lAqb+pQKm/qUCpv6lAlr/WQBaAFoAWgBaAVr+WQJa/1kAWgFa/lkCWv9ZAFoBWv5ZAlr+WQJa/lkCWv5ZAlr+WQFaAFoAWgFa/lkCWv5ZAlr/WQBaAVr+WQJa/1kAWgFa/lkBWgBaAVr+WQKm/qUApgOm+6UFpv2lAKYCpv2lBKb8pQOm/qUApgKm/aUCpgCm/qUDpv2lAqYApv6lA6b+pQKm/qUBpv+lAqb+pQKm/qUCpv6lAqb+pQKm/6UApgCmAKYApgGm/qUCpv5ZAlr+WQJa/1kAWgFa/lkCWv9ZAFoBWv9ZAFoAWgFa/lkDWv1ZA1r9WQJa/1kBWgBa/1kBWv9ZAVr/WQFa/1kBWgBa/1kBWgBa/lkEWvtZBFr+WQBaAVr+WQNa/VkCpv6lAaYBpv+lAKYApgCmAKYBpv6lAqb/pQCmAab/pf+lA6b9pQKm/6UBpv+lAab/pQCmAqb+pQGm/6UBpv6lBKb7pQSm/aUCpv+lAab/pQCmAab/pQGm/6UBpv+lAab/WQFa/1kCWv1ZA1r+WQJa/lkCWv5ZAlr/WQBaAVr+WQJa/lkCWv9ZAFoAWgBa/1kDWv1ZAVoAWv9ZAlr/Wf9ZAVr/WQJa/lkBWgBa/1kCWv5ZAlr+WQJa/VkEWvxZA1r+pQGm/6UCpv2lBKb8pQOm/qUBpgCmAKYApgCm/6UCpv6lAqb+pQGmAKYApgGm/aUDpv2lBKb8pQOm/qUApgOm+6UFpv2lAKYCpv2lA6b+pQGm/6UBpgCm/6UBpv+lAVoAWgBa/1kCWvxZBlr6WQVa/VkAWgNa+1kFWvxZA1r/WQBaAFr/WQJa/lkCWv9ZAFoAWgBaAFoAWgBaAFr/WQJa/lkBWv9ZAVoAWv9ZAlr9WQNa/lkAWgJa/lkBWgBa/qUEpvulBab8pQOm/qUBpgCmAKYApv+lAqb+pQKm/qUBpv+lAqb9pQOm/qUApgKm/aUDpv2lA6b+pQGm/6UBpgCm/6UCpvylBab8pQOm/qUBpv+lAab/pQGm/6UBpv9ZAFoBWv9ZAFoBWv5ZA1r9WQNa/VkCWv9ZAFoCWv1ZA1r9WQJa/1kBWv9ZAVr/WQBaAVr/WQFa/1kBWv9ZAVr/WQFa/1kAWgFa/lkDWv1ZAVoBWv5ZAlr/WQBaAFoBWv6lA6b9pQKm/6UApgCmAab+pQKm/qUCpv2lBKb8pQSm/KUDpv6lAqb/pf+lAqb+pQOm/KUEpvylBKb9pQKm/6UApgGm/qUCpv+lAab/pQCmAab+pQKm/6UApgGm/6X/pQJa/lkBWgBa/1kCWv1ZAlr/WQFa/1kAWgBaAFoCWvxZA1r/Wf9ZA1r9WQFaAVr/WQFa/1kAWgBaAVoAWv9ZAVr+WQNa/VkDWv1ZAlr/WQBaAVr+WQJa/lkCWv9ZAFoApgCmAKYApgCmAab+pQKm/qUCpgCm/qUDpvylBKb+pQGm/6UApgCmAab/pQGm/aUEpv2lA6b9pQKm/qUCpgCm/6UBpv+lAKYCpv6lAaYApv+lAqb/pf+lAqb+pQKm/qUCWv5ZAlr/WQBaAFoBWv5ZA1r9WQJa/1kBWv9ZAVr/WQFa/1kBWgBa/1kBWv9ZAVoAWv9ZAVr/WQFaAFr/WQJa/lkBWgBa/1kCWv5ZAVr/WQJa/lkBWv9ZAFoCWv1ZAqYApv6lA6b9pQKm/6UBpv+lAKYBpv6lA6b+pQCmAab/pQGmAKYApv+lAaYApv+lA6b8pQOm/qUBpgCmAKb/pQGmAKb/pQKm/aUDpv2lAqYApv+lAab/pf+lA6b9pQKm/1kAWgFa/lkCWv9ZAFoAWgBa/1kCWv5ZAVr/WQFa/1kBWv9ZAVr/WQFa/1kBWgBa/1kBWv9ZAlr+WQFaAFr/WQJa/lkAWgJa/VkDWv1ZAlr/WQFa/1kAWgFa/1kBWv5ZA6b9pQOm/qX/pQOm/aUCpv+lAKYApgCmAKb/pQKm/qUBpgCm/6UBpgCm/6UCpv6lAab/pQKm/qUCpv6lAqb+pQKm/6UApgGm/qUDpv2lAqYApv+lAab/pQCmAaYApv9ZAVr/WQFa/1kBWgBa/lkDWv1ZAloAWv5ZA1r9WQJa/1kBWv9ZAVr/WQFa/1kAWgFa/1kBWv9ZAVr/WQJa/VkDWv5ZAlr/WQBaAFoAWgBaAFoAWgFa/lkBWgBa/1kBWgCm/6UCpv2lA6b9pQSm/KUDpv6lAqb+pQKm/qUBpgGm/aUEpvylA6b+pQGmAKb/pQKm/qUBpgCm/qUEpv2lAaYApv+lAaYApgCm/6UDpvylA6b/pf+lAqb+pQKm/6UAWgBaAFoAWgFa/1kAWgFa/lkDWv1ZAlr/WQBaAVr/WQBaAFoBWv9ZAlr8WQVa/FkDWv9Z/1kCWv5ZAlr+WQJa/1kAWgBaAFoAWgBaAFr/WQFaAFr/WQFa/1kAWgFa/1kBpgCm/qUDpv6lAaYApv+lAaYApv+lAqb9pQOm/qUBpgCm/6UBpv+lAaYApgCm/6UBpv+lAaYApgCm/6UBpv+lAaYApgCm/6UBpv+lAaYBpv6lAab/pQGmAKYApv+lAab/WQFaAFr/WQJa/VkDWv5ZAVoAWv9ZAlr9WQNa/lkAWgJa/FkEWv5ZAFoBWv5ZAlr+WQJa/1kAWgFa/1kAWgBaAFoBWv9ZAVr+WQFaAFoAWgBaAVr+WQFaAFoAWgFa/qUCpv6lAqb+pQGmAKb/pQKm/aUDpv2lA6b9pQOm/aUDpv6lAab/pQCmAab/pQKm/qUApgGm/6UBpgCmAKYApv+lAaYApv+lAqb+pQGmAKb/pQGmAKb/pQKm/aUDpv6lAFoBWgBa/lkDWv1ZAlr/WQFa/lkDWv1ZAlr/WQFa/1kAWgFa/1kAWgFa/1kBWv9ZAFoAWgFa/1kBWv9ZAVr+WQJa/1kBWv9ZAVr+WQJa/1kAWgBaAFoAWgFa/lkCWv2lBKb+pf+lA6b8pQOmAKb9pQSm/aUBpgGm/qUCpv6lAqb/pQCmAab+pQKm/6X/pQKm/6UApgCm/6UCpv6lAqb+pQGmAKb/pQGmAKb/pQGm/6UBpv+lAab/pQGmAKb/pQFa/1kBWgBa/1kBWv9ZAVoAWv9ZAVoAWgBa/1kBWv9ZAlr/Wf9ZAlr9WQNa/lkBWgBa/1kCWv1ZA1r9WQNa/VkDWv5ZAFoCWv1ZA1r+WQBaAlr9WQNa/lkBWv9ZAVr/WQGm/6UBpgCm/6UBpv6lAqb/pQGm/qUCpv6lAaYBpv6lAqb+pQGmAKYApgCmAKb/pQGmAKb/pQGmAKb/pQKm/qUApgKm/qUCpv6lAaYApgCmAKYApgCm/6UCpv6lAqb+WQFaAFoAWgBaAFr/WQJa/lkCWv9ZAFr/WQFaAFoAWgBa/1kCWv1ZBFr8WQJaAFr/WQFa/1kAWgFa/lkCWv9ZAFoAWgBaAFoAWgBaAFoBWv9ZAFoAWgBaAFoBWv9ZAFoApv+lAaYApv+lAab/pQGm/6UApgGm/6UCpv2lA6b9pQOm/qUBpgCm/6UCpv6lAaYApgCmAKYBpv2lBKb7pQam+6UDpv6lAaYApgCmAKb/pQKm/qUCpv6lAaYApv+lAlr9WQRa/FkDWv1ZA1r+WQJa/lkBWgBaAFoAWgBaAFoAWgFa/lkCWv5ZAVoCWvtZBlr6WQZa+1kDWv5ZAVoAWgBaAFoAWv9ZAVr/WQFaAFr/WQBaAVr/WQFaAFr+WQJaAKYApv+lAab+pQOm/qUApgGm/qUDpvylBKb9pQKm/6UApgCmAab+pQOm/aUCpgCm/6UApgKm/aUEpvulBab7pQWm/aUApgKm/aUCpgCm/6UBpv+lAab/pQCmAKYBpv+lAVr+WQFaAVr/WQBaAVr/WQFa/1kAWgFa/1kBWv9ZAFoBWv5ZAlr/WQBaAFoAWgBaAFoAWv9ZAlr+WQFaAFr/WQJa/lkBWgBa/1kBWgBa/1kBWv9ZAVr/WQFa/1kBWgCm/6UBpgCm/6UCpv2lA6b+pQGmAKb/pQGmAKb/pQKm/qUBpgCm/6UCpv6lAaYApv+lAab/pQGmAKb/pQGm/qUEpvulBKb+pQCmA6b8pQOm/aUDpv+lAKYBpv2lBKb9pQJa/1kAWgFa/1kAWgFa/1kBWv9ZAFoBWv9ZAVr/WQFa/1kBWv9ZAVr/WQFaAFr/WQJa/VkEWv1ZAVoAWv9ZAlr+WQJa/lkBWgBa/1kCWv5ZAVoBWv1ZBFr8WQNa/1kAWgCmAKYApgGm/qUCpv2lBab7pQSm/KUDpv+lAab/pQGm/6UApgGm/qUDpv2lAqb/pQCmAab+pQOm/aUDpv2lAqb/pQCmAKYApgCmAKYApgCm/6UDpvylBKb9pQGmAKYAWgBaAFr/WQJa/VkEWvxZA1r+WQJa/lkCWv5ZAlr+WQNa/FkDWv9ZAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWv9ZAlr+WQJa/1n/WQNa/FkEpv2lAqb/pQGm/6UBpv+lAab+pQOm/aUEpvulBKb+pQCmAqb+pQCmA6b7pQWm/KUDpv6lAqb+pQGm/6UCpv6lA6b8pQOm/qUCpv+lAKYApv+lA6b8pQSm/aUBpgCmAFoAWgFa/lkBWgBaAFoBWv9ZAFoBWv5ZA1r9WQNa/VkDWv5ZAVr/WQFa/1kBWgBa/1kAWgJa/VkDWv5ZAVoAWgBaAFoAWgBaAFoAWgBaAVr9WQNa/lkBWgBa/1kBWv9ZAab/pQGm/6UBpv+lAab/pQCmAab/pQGm/6UApgGm/6UBpv+lAaYApv+lAab/pQGmAKb/pQGm/6UBpv+lAab/pQGm/6UBpv+lAKYBpv+lAab/pQCmAab/pQGm/6UBpv+lAVr/WQFa/1kBWv5ZA1r8WQVa+1kDWv9ZAFoBWv9ZAFoAWgFaAFr/WQFa/lkDWv5ZAVr/WQFa/1kCWv1ZA1r+WQFaAFr/WQFaAFr/WQJa/lkBWgBaAFr/WQJa/lkCWv+l/6UCpv+lAKYApgCmAKYBpv6lAqb+pQKm/qUBpgCm/6UCpv2lA6b9pQOm/aUDpv2lA6b+pQGm/6UCpv2lA6b+pQGmAKb/pQGmAKb/pQGm/6UBpgCm/6UBpv+lAaYApv9ZAVr/WQFa/1kBWv9ZAVr/WQFa/lkDWv5ZAVoAWv9ZAVoAWgBa/1kDWvtZBlr6WQVa/FkEWv1ZAVoAWv9ZAlr/Wf9ZAlr+WQFaAFoAWgBaAFoAWv9ZAlr+WQFaAFr/pQKm/aUDpv2lA6b+pQGm/6UBpv+lAab/pQGm/6UBpv+lAab/pQCmAqb8pQSm/aUBpgGm/qUCpv2lBKb9pQKm/6UApgCmAab/pQGm/6UApgCmAab/pQGm/qUCpgCm/6UCWvxZBVr8WQNa/1n+WQNa/lkBWgFa/VkDWv5ZAlr+WQFa/1kBWgBa/1kBWv9ZAVr/WQFaAFr/WQJa/VkDWv9Z/1kCWv5ZAlr+WQJa/lkCWv5ZAlr+WQJa/lkBWgBa/1kCpv6lAaYApv+lAqb9pQOm/qUCpv6lAKYBpv+lAqb+pQGm/6UBpv+lAaYApv+lAaYApv6lA6b9pQOm/aUDpv2lA6b9pQKm/6UBpv+lAKYApgGm/6UApgGm/qUDpv2lAVoCWvxZBVr7WQRa/lkAWgFa/lkDWv5ZAFoBWv5ZA1r9WQNa/VkCWv9ZAFoBWv9ZAVr/WQFa/lkDWv1ZA1r+WQBaAVr/WQBaAVr+WQNa/VkCWv9Z/1kDWv1ZAlr+WQJa/6UApgGm/qUDpv6lAab+pQOm/aUEpvylAqb/pQGm/6UBpv+lAab/pQGmAKb/pQGmAKb/pQKm/qUBpgGm/qUCpv2lBKb9pQKm/qUBpgCmAKYApv+lAqb+pQKm/qUCpv9ZAFoBWv5ZA1r+WQFaAFr+WQNa/lkBWgBa/1kBWv9ZAVr/WQJa/lkBWv9ZAVoAWgBa/1kCWv5ZAlr+WQFaAFoAWgFa/lkCWv5ZAlr+WQFaAFr/WQNa/FkEWvxZBFr9WQOm/qUApgKm/aUDpv6lAKYBpgCm/qUDpvylBKb+pQCmAKYApgCmAab+pQKm/aUFpvqlBab8pQOm/qUCpv6lAqb+pQGmAKYBpv+lAKb/pQKm/6UBpv6lAqb+pQOm/aUCpv9ZAFoBWv9ZAVr/WQBaAFoBWv9ZAVr/WQBaAVr/WQFa/1kBWv5ZA1r9WQJa/1n/WQJa/lkCWv5ZAlr+WQFaAFoAWgBaAFr/WQJa/1kAWgBaAFoBWv5ZAlr/WQFaAFr+pQKm/6UBpgCm/qUDpv2lAqb/pQCmAab/pQGm/qUCpv+lAab/pQGm/qUCpv+lAKYBpv6lAqb/pQCmAab+pQOm/aUCpv+lAab/pQGm/6UApgGm/6UApgGm/6UApgGm/qUDWvxZBVr7WQRa/ln/WQNa/VkCWv9ZAFoAWgBaAFoAWgBaAFr/WQJa/VkDWv5ZAVoAWgBa/1kBWgBa/1kCWv1ZA1r+WQFa/1kAWgFaAFr/WQFa/1kAWgJa/VkDWv5ZAKYBpgCm/qUEpvulBKb+pQGm/6UApgGm/qUDpv2lAaYBpv2lBKb8pQOm/qUCpv2lBKb8pQOm/6X/pQGmAKb/pQKm/qUBpv+lAab/pQGm/6UBpgCm/6UBpv+lAqb+pQGmAFr/WQNa/FkEWvxZBFr9WQFaAVr+WQJa/1n/WQNa/FkDWv5ZAlr+WQJa/lkCWv5ZAlr+WQJa/lkDWvxZBVr6WQZa+1kFWvxZAlr/WQFa/1kBWv9ZAVr/WQFa/1kBWv9ZAKYBpv+lAab/pQCmAab+pQOm/aUCpv+lAKYApgGm/qUCpv+l/6UDpvylBKb9pQKm/6X/pQOm/KUFpvulBKb9pQKm/6UApgGm/6UApgGm/aUEpv2lAaYBpv6lAaYApgBa/1kDWvxZBFr8WQRa/FkEWv1ZAlr/WQBaAFoBWv5ZAlr+WQJa/lkCWv1ZBFr8WQNa/lkBWgBa/1kBWgBaAFoAWgBaAFr/WQNa+1kGWvtZBFr9WQFaAFoAWgFa/1kAWgCmAab+pQOm/KUEpv2lAqb+pQKm/6X/pQOm/KUDpv+lAKYApgGm/aUEpv2lA6b9pQKm/qUCpv+lAab+pQKm/qUCpv6lAqb/pQCmAab+pQKm/6UBpv+lAKYBpv6lBKb7WQNa/1kAWgFa/1n/WQJa/lkCWv9ZAFoAWgBaAFoBWv9ZAFoBWv5ZA1r8WQVa+1kEWv5Z/1kEWvtZBVr8WQNa/VkDWv5ZAVoAWv9ZAVoAWv9ZAVoAWgBaAFr/WQJa/lkCpv6lAaYApv+lAqb9pQSm/KUDpv6lAaYApgCmAKb/pQKm/qUBpgCmAKYApgCmAKYApgGm/6UBpv6lA6b9pQKm/6UBpv+lAKYApgCmAKYApgCmAKYBpv6lAaYApgCmAKYAWgBa/1kCWv5ZAVoAWv9ZAVr/WQJa/VkEWvtZBFr+WQJa/lkBWgBa/1kCWv5ZAVoAWv9ZAlr+WQFaAFr/WQJa/lkBWgBaAFr/WQFaAFr/WQJa/VkDWv5ZAVoAWv9ZAab/pQGmAKb/pQGm/6UApgKm/aUDpv2lA6b+pQGm/6UBpv+lAqb9pQKmAKb/pQGm/6UApgGm/6UBpv+lAKYBpv+lAKYBpv6lA6b9pQOm/KUEpv2lAqb/pQCmAKYBpv+lAVr+WQJa/1kCWv5ZAFoAWgBaAVr/WQBaAVr9WQVa+lkGWvtZA1r/Wf9ZA1r8WQRa/VkBWgFa/VkEWvxZBFr9WQJa/lkBWgBaAFoAWgBa/1kCWv5ZAlr+WQJa/lkDWvylBab7pQOm/6UApgCmAab+pQKm/qUBpgCmAab+pQGmAKb/pQOm/KUDpv6lAaYApgCmAKYApgCm/6UCpv2lBKb9pQGmAKb/pQGmAab9pQSm/KUDpv+l/qUEpvylA6b+pQFaAFr/WQFa/1kCWv5ZAVoAWv9ZAlr+WQJa/lkBWgBa/1kDWvxZAloAWv9ZAlr+WQFa/1kBWv9ZAlr9WQNa/VkCWgBa/lkEWvtZBFr9WQNa/lkCWv1ZA1r9WQNa/lkCWv6lAab/pQGmAab+pQKm/qUBpgGm/qUCpv6lAaYApgCm/6UBpgCm/6UCpv2lA6b+pQKm/qUBpgCm/6UCpv6lAqb9pQOm/qUBpgCmAKYApgCm/6UBpgCm/6UCpv6lAab/WQJa/VkDWv9Z/1kDWvxZBFr9WQJa/1kAWgJa/VkDWv1ZAloAWgBa/1kCWv1ZA1r+WQJa/lkBWv9ZAlr+WQJa/VkCWgFa/lkCWv1ZA1r+WQJa/lkBWgBa/1kCWv5ZAlr+pQGmAKYApgCmAKYApgCmAKb/pQKm/6UApgCm/6UCpv6lAqb+pQKm/6X/pQKm/qUCpv+lAKYApgCmAKYBpv6lAqb+pQKm/qUDpvylBKb8pQOm/6UApgCmAKYApgGm/1kAWgBaAFoBWv9ZAFoAWv9ZAlr+WQJa/lkBWgBaAFoAWgFa/lkCWv9ZAFoBWv9ZAFoBWv5ZA1r8WQVa+1kEWv1ZAVoAWgFa/lkCWv1ZBFr8WQRa/VkBWgFa/lkCWv9ZAab+pQOm/KUFpvulBKb9pQOm/aUDpv2lA6b+pQGmAKb/pQGmAKYApgCmAKb/pQKm/qUCpv6lAaYApgCmAab9pQSm+6UFpv2lAaYApgCm/6UCpv2lA6b+pQGm/6UCpv2lAlr/WQFa/1kBWv5ZAlr/WQFa/lkCWv5ZAlr+WQNa/VkCWv9Z/1kDWv5ZAFoCWvxZBFr+WQBaAVr+WQJa/lkDWv1ZAVoAWgBaAVr/WQFa/VkFWvtZBFr9WQJa/lkCWv6lAaYApgCmAKYApv+lAqb+pQKm/6UApgCmAab9pQSm/KUDpv+lAKYApv+lAqb+pQOm/aUCpv+lAKYBpv+lAab/pQGm/qUDpv2lA6b9pQOm/aUEpvulBab7pQWm/KUDpv1ZAlr/WQBaAVr+WQNa/FkEWv1ZAlr/WQBaAFoBWv9ZAFoAWgBaAVr/WQBaAVr/WQFa/1kBWv9ZAVr/WQBaAVr/WQBaAVr+WQJa/lkCWv9ZAVr/WQBaAVr/WQJa/VkDpv2lA6b+pQGm/6UBpv+lAab/pQGm/qUDpv2lAqb/pQCmAKYBpv6lAqb+pQGmAab9pQSm/KUCpgGm/aUEpv2lAaYApgCm/6UDpvylA6b+pQGmAKYApv+lAqb9pQOm/qUBWgBaAFr/WQFaAFr/WQFaAFr/WQFa/1kBWgBa/1kBWv5ZA1r9WQJa/1kAWgFa/lkCWv5ZAlr/WQBaAVr/WQBaAVr/WQBaAVr/WQFaAFr+WQJa/1kBWv9ZAFoAWgBaAFoApgCmAKYApgCm/6UDpvylBKb9pQKm/6UApgCmAKYBpv+lAKYApv+lAqb+pQKm/qUCpv6lAqb9pQSm/KUEpvylBKb7pQWm+6UFpvylA6b9pQKmAKb/pQKm/qUBpgCmAFoAWgBa/1kCWv5ZAlr+WQFaAFoAWgBaAFoAWgBaAFoAWgBa/1kCWv9Z/1kDWvtZBlr6WQVa/VkBWgBa/1kBWgBa/lkDWv1ZA1r9WQJa/1kAWgFa/lkCWv5ZAlr+WQFaAKYApgCmAKb/pQKm/qUCpv6lAaYBpv6lAqb+pQKm/6UApgCmAKYApgGm/qUBpgCm/6UBpgGm/aUEpvulBab9pQGmAKb/pQGmAKb/pQGm/6UBpv+lAab/pQCmAaYApv9ZAVr/WQBaAlr9WQNa/VkDWv1ZA1r+WQBaAlr9WQNa/lkBWv9ZAlr9WQNa/lkCWv5ZAVr/WQFaAVr+WQFaAFr/WQJa/lkBWgFa/VkDWv5ZAVoAWv9ZAVr/WQFa/1kBWv+lAab/pQCmAqb9pQOm/aUCpv+lAaYApv+lAaYApv+lAqb+pQKm/qUCpv+lAKYBpv6lAaYBpv+lAKYBpv6lAqb/pQCmAab/pQCmAab+pQOm/aUCpv+lAKYBpv+lAKYApgBaAFoAWgBaAFoAWgBa/1kCWv5ZAlr/Wf9ZA1r8WQVa/FkCWv9ZAFoBWv9ZAVr/WQBaAVr+WQNa/FkFWvtZBFr+WQBaAVoAWv9ZAVr/WQJa/lkCWv5ZAFoCWv5ZAlr+pQGmAKb/pQKm/qUBpgCm/6UCpv6lAqb+pQGmAKb/pQOm/KUEpvylA6b+pQKm/qUDpvylA6b/pQCmAab+pQKm/qUCpv+l/6UCpv6lAaYApgCm/6UDpvulBab8pQOm/qUBWgBaAFoAWv9ZAlr+WQNa/VkCWv5ZA1r9WQNa/VkCWgBa/1kAWgFa/lkDWv1ZAlr/WQBaAVr/WQFa/lkDWvxZBVr8WQJa/1kAWgBaAVr+WQNa/FkEWv1ZAVoAWgBaAKYApgCm/6UCpv6lAqb+pQKm/qUCpv+l/6UCpv6lAqb+pQGmAKYApgCm/6UCpv2lBKb7pQWm/aUApgGm/6UBpgCmAKb/pQKm/qUBpgGm/aUEpv2lAqb/pQCmAKYApgGm/1kAWgFa/lkCWv9Z/1kCWv1ZA1r+WQFa/1kBWv5ZA1r+WQBaAlr9WQNa/VkCWv9ZAVoAWv5ZAlr/WQFa/1kBWv9ZAVr/WQFa/1kBWgBa/1kBWv9ZAVr/WQFa/1kBWv9ZAab/pQGm/6UBpv6lA6b+pQGmAKb+pQOm/qUBpv+lAab/pQKm/qUApgGm/6UCpv6lAaYApv+lAqb9pQOm/qUBpv+lAaYApv+lAKYBpv6lBKb7pQOmAKb+pQOm/KUEpv1ZA1r9WQJaAFr+WQNa/VkCWgBa/1kAWgFa/lkDWv1ZA1r9WQJa/1kBWv9ZAVr+WQJa/1kAWgFa/lkCWv5ZAlr/WQFa/1kAWgBaAVoAWv9ZAVr/WQBaAVoAWv9ZAVr/WQCmAqb9pQOm/aUCpgCmAKYApv+lAab/pQKm/qUBpgCmAKYApgCm/6UCpv6lAqb/pf+lA6b8pQOm/6UApgGm/qUCpv2lBKb8pQOm/qUBpv+lAab/pQKm/qUBpgCmAKYAWgBaAFoAWgFa/VkEWv1ZAlr/Wf9ZAlr/WQFa/lkCWv5ZAlr/Wf9ZAlr+WQJa/lkBWgBaAFoAWv9ZAVoAWv9ZAlr9WQNa/VkDWv1ZA1r+WQFaAFr/WQJa/lkDWvxZBFr8pQSm/aUCpv6lAqb+pQKm/qUCpv6lA6b9pQGmAKYApgCmAab+pQKm/qUBpgCmAKYApgCmAKYApgCmAKYApgCmAKb/pQKm/qUBpgCm/qUDpv2lA6b9pQOm/aUDpv6lAaYAWgBaAFoAWgFa/lkDWvxZBFr9WQJa/1kAWgFa/lkCWv5ZAlr/WQBaAVr+WQJa/lkDWvxZBVr6WQZa+1kEWvxZA1r/Wf9ZA1r8WQNa/1n/WQJa/VkDWv5ZAVoAWv9ZAab/pQGm/6UCpv6lAab/pQGmAKYApgCm/6UBpgCmAKYApgCm/6UBpgCm/6UDpvylA6b+pQGmAab+pQKm/qUBpgGm/qUCpv6lAqb+pQGmAab+pQKm/qUBpgGm/qUCpv6lAVoAWgBaAFr/WQJa/lkCWv9ZAFoAWgFa/1kAWgFa/1kAWgFa/1kAWgFa/lkDWv1ZAlr/WQBaAVr+WQJa/1kAWgFa/VkFWvpZBlr7WQRa/VkCWv5ZAlr+WQNa/FkDWv6lAaYBpv6lAqb9pQSm/aUBpgGm/qUBpgGm/aUEpv2lAKYDpvulBqb7pQOm/qUCpv6lAqb+pQKm/qUCpv6lAaYBpv6lAqb/pQCmAKYApgCmAab/pQCm/6UCpv+l/6UDpvtZBVr+Wf9ZAlr+WQJa/1kAWgBaAFoAWgBaAFoAWgBaAFr/WQJa/lkCWv9Z/1kCWv9ZAFoBWv5ZAlr/WQBaAVr+WQNa/VkCWv9ZAFoAWgFa/lkCWv9ZAFoAWgBaAFoBWv6lAqb/pQCmAab+pQKm/6UApgCmAKYApgCmAKb/pQKm/qUBpgCm/6UCpv6lAqb+pQKm/aUEpvylA6b/pf6lA6b9pQKmAKb/pQCmAab+pQOm/qUApgGm/6UApgKm/aUDWv1ZA1r+WQBaAlr9WQNa/1n+WQRa+1kEWv5ZAVr/WQBaAFoBWv9ZAFoAWgBaAVr/WQFa/lkDWv1ZA1r+WQBaAlr9WQNa/lkAWgJa/VkDWv5ZAVoAWv9ZAlr+WQJa/lkBpgGm/qUDpvulBqb7pQOmAKb9pQSm/KUEpv2lAqb/pQCmAKYApgGm/qUDpv2lAqb/pf+lAqb+pQKm/qUCpv2lA6b9pQOm/qUApgKm/aUCpgCm/qUDpv6lAKYBpv6lAloAWv5ZA1r8WQRa/VkCWv9ZAFoBWv9ZAVr+WQJa/1kBWgBa/lkDWv1ZAlr/WQBaAVr/WQFa/lkCWv9ZAFoBWv9ZAFoBWv9ZAVr+WQNa/VkDWv1ZAlr/WQFaAFr+WQJa/6UBpgCm/qUDpvylBab7pQSm/qUApgCmAab+pQOm/aUCpv+lAKYBpv6lAqb+pQKm/6UApv+lAqb+pQGmAab+pQKm/qUBpgCmAab+pQKm/qUBpgGm/aUEpvylA6b+pQGmAFoAWv9ZAlr9WQRa/FkDWv5ZAVoAWv9ZAVoAWv9ZAVr/WQFa/1kBWv5ZA1r9WQNa/VkCWv5ZA1r+WQFaAFr+WQNa/lkBWgBa/lkDWv1ZA1r9WQJa/1kAWgJa/VkDWv6lAaYApgCm/6UDpv2lAqb/pf+lA6b9pQKm/qUBpgGm/qUCpv2lA6b+pQKm/qUCpv6lAqb+pQKm/qUDpvylBKb9pQKm/6UApgCmAKYBpv6lAqb/pf+lA6b9pQKm/6UApgBaAVr/WQBaAVr/WQFa/1kAWgFa/1kBWgBa/1kBWv5ZA1r9WQNa/VkCWv9ZAFoAWgBaAVr/WQBaAFoAWgFa/1kBWv9ZAVr+WQNa/VkDWv1ZA1r9WQJa/1kAWgFa/1kApgCmAab+pQKm/qUCpv+lAab+pQGmAab+pQKm/6UApgGm/qUBpgGm/6UBpv+lAKYBpv+lAab/pQGm/6UBpgCm/qUDpv6lAab/pQCmAaYApgCm/6UApgGm/6UCpv2lA6b9WQJa/1kBWv9ZAVr+WQNa/VkDWv1ZAlr/WQBaAVr/WQFa/1kAWgBaAVr+WQJa/1kAWgBa/1kCWv9ZAFoAWgBaAFoCWvxZBFr9WQJa/1kAWv9ZA1r8WQRa/FkDWv9ZAFoApv+lAqb/pQCmAKb/pQKm/qUBpgCm/6UCpv6lAaYApv+lAqb+pQGmAKb/pQKm/qUBpgCmAKYApv+lAaYApgCmAKb/pQCmAab/pQGm/qUCpv+lAKYBpv6lAqb/pQCmAVr+WQJa/1kAWgFa/lkDWv1ZA1r9WQNa/lkCWv5ZAVoAWgBaAFr/WQFaAFr/WQJa/VkDWv5ZAVoAWgBaAFr/WQJa/1n/WQNa+1kGWvpZBlr7WQRa/VkCWv5ZAloAWv5ZA6b9pQGmAab+pQKm/6X/pQKm/qUBpgCmAKb/pQOm/KUDpv+lAKYApgGm/qUCpv6lAqb/pQCmAKb/pQKm/6X/pQKm/qUCpv6lAaYApgCmAab+pQGm/6UBpgCmAKYApv9ZAVr/WQFaAFr/WQFa/1kBWv9ZAVr/WQFa/1kBWv9ZAVoAWv9ZAVr/WQFa/1kBWv9ZAFoBWv9ZAFoBWv5ZAlr/WQBaAFoBWv5ZAlr+WQFaAFoAWgBa/1kBWgBa/1kCWv2lA6b9pQSm+6UEpv+l/qUEpvulBKb+pQGmAKb/pQGm/6UCpv6lAqb+pQCmAqb9pQSm/aUBpgCm/6UBpgCm/6UCpv6lAab/pQGmAKb/pQGm/6UBpgCmAKb+pQOm/qUBpgBa/1kBWgBa/1kBWv9ZAVr/WQFa/1kAWgFa/1kBWgBa/1kBWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFr/WQJa/lkCWv5ZAVr/WQFaAFoAWv9ZAVr/WQFaAFr/WQJa/lkBpgCmAKYBpv6lAaYBpv6lA6b8pQSm/aUCpv+lAKYApgGm/6UApgGm/qUCpv+lAKYApgGm/qUCpv6lAqb/pQCmAKYApgCmAab+pQKm/6X/pQOm/KUEpv2lAqb+pQKm/qUCWv9Z/1kCWv5ZAlr+WQFaAFr/WQNa/FkEWv1ZAVoAWgFa/1kBWv5ZAVoBWv5ZA1r8WQNa/1kAWgBaAFoAWgBaAFoAWgBaAFr/WQJa/lkCWv5ZAVoAWgBaAFoAWv9ZAab/pQGmAKb/pQCmAab/pQGm/6UApgGmAKb/pQGm/6UBpgCmAKb/pQGm/6UCpv+lAKYApv+lAqb+pQGmAKYApv+lAab/pQGm/6UBpv+lAqb+pQGm/6UBpgGm/qUBpv+lAVoAWgBa/1kBWgBa/1kCWv5ZAFoCWv1ZA1r+WQBaAVr/WQFa/1kBWv9ZAVoAWv9ZAVoAWv9ZAVoAWv9ZAlr9WQJa/1kCWv1ZA1r9WQJa/1kAWgBaAVr+WQNa/FkEWv1ZAaYBpv6lA6b9pQKm/qUCpv+lAKYBpv6lA6b9pQKm/6UApgKm/aUDpv6lAKYCpv6lAaYApv+lAqb+pQGm/6UBpgCm/6UBpv+lAKYBpv+lAab/pQGm/6UBpv+lAab/pQFa/1kAWgFa/1kAWgFa/1kAWgBaAVr/WQFa/1kAWgFaAFr+WQNa/FkEWv1ZAlr/Wf9ZA1r7WQZa+lkFWv1ZAVoAWv9ZAlr9WQNa/lkBWgBa/1kBWv9ZAlr9WQRa+1kFWvylAqYApv6lAqYApv6lA6b9pQKm/6UApgGm/6UBpv+lAKYBpv+lAKYBpv6lA6b9pQKm/6UBpv+lAab/pQGm/6UCpv6lAaYApv+lAab/pQKm/aUEpvulBKb+pQGmAKb+pQNa/lkBWgFa/VkCWgBa/lkEWvxZA1r9WQNa/FkFWvxZA1r9WQJa/1kBWv9ZAVr+WQNa/lkAWgFa/1kBWgBa/1kAWgFa/1kAWgFa/1kAWgFa/lkDWv1ZA1r9WQNa/VkDpv2lA6b+pQGmAKb+pQOm/aUEpvulBab7pQSm/aUCpv6lA6b8pQSm/aUBpgCmAKYApgCmAKb/pQKm/qUCpv6lAqb+pQKm/qUCpv+lAKYBpv6lAqb/pQCmAab/pQCmAab/WQFa/1kBWv5ZA1r+WQFaAFr+WQNa/VkDWv1ZAlr/WQBaAFoAWgFa/lkBWgFa/lkCWv9Z/1kDWv1ZAVoBWv9ZAFoBWv5ZAlr/WQBaAVr9WQNa/lkBWgBa/1kAWgJa/aUDpv6lAaYApv+lAqb9pQSm/KUDpv6lAab/pQGmAKb/pQGm/6UBpv+lAaYApv+lAaYApv+lAqb+pQGmAKYApgCmAKYApgCmAKYApgCmAKYApgCmAKYApgCmAKYApgCmAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFr/WQFaAFr/WQJa/VkDWv1ZAloAWv5ZBFr6WQda+VkFWv1ZAVoBWv5ZAVoAWv9ZAlr+WQFaAFr/WQJa/lkBWgBaAKYApv+lAab/pQGmAKYApv6lA6b9pQKmAKb/pQGmAKb+pQOm/aUDpv6lAKYBpv+lAab/pQCmAab/pQGm/6UBpv6lBKb7pQSm/qUApgGm/6UApgCmAKYApgCmAab+pQFaAFoAWgFa/1kAWgBaAFoAWgFa/lkCWv9ZAFoBWv5ZAloAWv9ZAlr9WQNa/lkBWgBa/1kCWv5ZAVr/WQFaAFoAWgBa/1kBWgBaAFoAWv9ZAlr+WQJa/lkCWv5ZAlr/WQCmAab+pQOm/aUCpv+lAKYBpv+lAab+pQOm/KUFpvylAqb/pQGm/6UCpv2lA6b9pQOm/qUCpv6lAaYApgCmAab+pQGmAKYApgCmAKb/pQKm/qUCpv2lBKb8pQOm/6X/WQJa/VkEWvxZA1r+WQFaAFoAWv9ZAlr+WQFa/1kBWgBaAFr/WQBaAVoAWgBa/1kBWv9ZAlr+WQJa/lkBWgBaAFoAWgBaAFoAWgBaAFr/WQJa/1kAWv9ZAlr9WQRa/VkBpgCmAKb/pQKm/qUCpv+l/6UDpvylBKb9pQKmAKb+pQOm/aUDpv6lAab/pQKm/qUBpgCmAKYApgCmAKYApv+lA6b8pQSm/aUBpgGm/qUDpv2lAqb/pQCmAab/pQCmAab/WQFa/1kAWgBaAlr9WQNa/VkCWv9ZAVr/WQJa/VkDWv5ZAVoAWgBaAFoBWv5ZAlr+WQJa/1kAWgFa/1kAWgBaAVr+WQNa/VkCWgBa/1kAWgFa/1kBWv9ZAVr+WQNa/aUCpv+lAKYApgCmAab/pQCmAab+pQKm/6UApgGm/6UApgGm/6UApgKm/aUDpv6lAaYApv+lAaYApv+lAqb+pQCmAqb9pQOm/6X/pQGm/6UBpgGm/qUBpv+lAaYApgCm/1kBWv9ZAVr/WQFa/1kCWv1ZA1r9WQNa/lkCWv1ZA1r9WQNa/lkBWv9ZAVr+WQNa/lkBWv9ZAVr/WQJa/lkBWv9ZAlr+WQJa/lkBWgBaAFr/WQJa/VkDWv5ZAVoAWv+lAab/pQKm/qUBpgCm/6UCpv6lAaYBpv2lBab6pQWm/aUBpgGm/qUCpv6lAqb/pQGm/qUCpv+lAab/pQCmAKYBpv+lAKYApgCmAKYApgGm/qUCpv6lAqb/pQCmAab/pQBaAVr+WQNa/VkDWvxZBFr9WQJa/1kAWgFa/lkDWvxZBFr9WQJa/1kAWgFa/VkFWvpZBVr9WQFaAFr/WQJa/lkBWgBa/lkEWvxZBFr8WQNa/lkCWv5ZAlr+WQFaAVr9WQSm/aUBpgCm/6UCpv6lAqb+pQGmAKb/pQKm/qUBpv+lAaYApv+lAqb9pQSm+6UGpvqlBab9pQCmAqb+pQGmAKb/pQGmAKb/pQGmAKb/pQKm/qUBpgCm/6UCpv6lAqb9WQNa/lkBWgBa/lkDWv1ZA1r9WQJa/1kAWgFa/1kBWv9ZAFoBWv9ZAVoAWv9ZAVoAWv9ZAVoAWv9ZAlr+WQFaAFoAWgBaAFoAWgBaAFoBWv5ZA1r8WQVa+1kFWvtZBFr+pQGm/6UBpv6lA6b+pQCmAqb9pQOm/qUApgKm/qUBpgCm/qUDpv6lAaYApv6lA6b+pQGmAKb/pQGm/6UBpv+lAab/pQGm/6UBpgCm/6UCpv6lAqb+pQKm/qUCpv+lAFoAWv9ZAlr/WQFa/lkBWgBaAVr+WQNa/FkEWv1ZAloAWv5ZAlr+WQNa/VkCWv9ZAFoBWv5ZAlr/WQFa/1kBWv9ZAVr/WQFaAFr/WQJa/VkCWgBaAFoAWv9ZAVoAWgBaAKYApgCmAKYApgCmAKYApgCmAKYBpv6lAaYBpv6lA6b9pQGmAab+pQOm/KUEpv2lAqb/pQGm/qUDpvylBKb+pQCmAKYBpv2lBab7pQOm/6UApgCmAKYApgCmAab+pQKm/lkDWvxZBVr7WQRa/lkAWgFa/1kBWv9ZAFoBWv5ZA1r8WQRa/VkCWv9ZAFoAWgFa/1kAWgFa/1kBWv9ZAFoAWgFaAFr/WQFa/lkDWv5ZAlr+WQFa/1kBWgBa/1kCWv2lA6b9pQOm/aUDpv6lAKYBpv+lAab/pQGm/qUDpv2lAqb/pQCmAKYApgCmAab+pQKm/qUCpgCm/qUDpv2lA6b9pQKm/6UBpgCm/qUDpvylBab7pQWm/KUDpv6lAab/pQJa/lkCWv5ZAlr+WQJa/1n/WQNa/FkEWv1ZAlr/WQBaAFoAWgBaAFoAWgBa/1kBWgBa/1kCWv1ZAloBWv1ZBFr8WQJaAVr+WQJa/1n/WQJa/1kAWgFa/lkCWv9ZAFoBpv+lAKYBpv6lA6b9pQKm/6UApgGm/qUDpvylBKb+pQCmAab+pQKmAKb/pQGm/qUDpv6lAab/pQGmAKYApv+lAab/pQKm/qUBpgCm/6UCpv6lAaYApv+lAqb+pQGmAKb+WQNa/lkBWv9ZAFoBWv9ZAVr/WQBaAVr/WQFa/lkDWv1ZA1r+WQBaAVr+WQNa/VkDWv1ZAlr+WQJa/1kAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgFa/lkCWv5ZAlr/pQCmAKYBpv6lA6b8pQSm/aUCpv+lAKYApgCmAKYApgCmAKYApgCmAKYBpv6lAqb/pf+lA6b9pQKm/6UApgCmAKYApgGm/qUCpv6lAqb/pQCmAKYBpv+lAab+pQOm/VkDWv1ZA1r+WQFa/lkDWv1ZA1r9WQJaAFr/WQBaAFoAWgFa/1kBWv5ZAlr+WQJa/lkCWv5ZAlr+WQFa/1kBWgBaAFr/WQFa/1kBWgBaAFr/WQFa/1kBWgBa/1kBWv9ZAab/pQGm/6UCpv2lA6b+pQCmAqb8pQWm+6UFpvylAaYBpv2lBab8pQGmAKYBpv6lA6b8pQOm/6UApgCmAab9pQSm/aUBpgCm/6UCpv+lAKb/pQKm/qUCpv6lAqb+pQNa/FkDWv9ZAFoAWgFa/lkDWv1ZAlr+WQNa/VkDWvxZBFr9WQJa/1kAWgBaAFoBWv5ZA1r9WQJa/1kBWv9ZAVr/WQBaAVr/WQBaAFoBWv5ZAlr+WQFaAFoAWgBaAFr/WQGmAKYApv+lAqb9pQOm/6X+pQSm+6UFpvylA6b+pQGmAKYApgCmAKYApgCmAKYApgCmAKYApgCmAKb/pQKm/qYCp/6mAacApwCn/6YCp/6mAqf+pgGnAaf+pgKn/qYCp/5YAln+WANZ/FgEWftYBln7WARZ/VgBWQBZ/1gDWfxYBFn8WAJZAVn9WANZ/lgBWQBZ/1gBWf9YAVn/WABZAVkAWf5YA1n9WAJZAFn/WABZAln9WANZ/lgAWQFZ/1gBpwCn/6YBpwCn/6YCp/6mAacBp/6mAacBp/2mBKf8pgKnAKf/pgCnAqf8pgWn+6YEp/6mAKcBp/+mAKcCp/ymBKf9pgKn/6YBp/+mAKcBp/+mAacAp/+mAacAp/+mAaf/WAFZAFn/WAFZ/1gBWf9YAVn/WAFZ/1gBWQBZ/1gBWf9YAVkAWf9YAln+WAJZ/VgEWf1YAln/WP9YA1n9WAJZ/1gAWQFZ/1gBWf9YAVn+WAJZAFn+WANZ/VgCWQBZ/qYCp/+mAKcBp/+mAKcBp/6mA6f9pgKn/6YBp/+mAqf9pgOn/aYDp/6mAaf/pgKn/aYEp/ymA6f/pgCnAKcApwCnAKcApwGn/qYCp/6mAacBp/2mBKf8pgOn/qYApwKn/VgDWf5YAFkCWf1YA1n+WAFZAFn/WAJZ/lgCWf1YBFn9WAJZ/lgBWQBZAFn/WAJZ/VgDWf1YAlkAWf9YAVn+WANZ/VgCWQBZ/lgEWftYBVn8WAJZ/1gBWf9YAln9WANZ/aYCpwCn/6YBp/+mAaf/pgKn/aYCp/+mAacApwCn/6YBp/+mAqf+pgKn/qYBpwCnAKcApwCn/6YCp/6mAacBp/2mBKf8pgKnAaf9pgSn+6YFp/ymBKf9pgCnAqf+pgJZ/1gAWQBZAFkAWQBZAVn+WAJZ/lgCWf9YAFkAWQBZAFkAWQBZAFkAWQBZAFn/WAFZAFn/WAJZ/VgDWf5YAln+WAFZAFn/WAJZ/1gAWQBZ/1gBWQBZAFkAWQBZ/1gCWf2mBaf6pgWn/KYDp/+mAKcAp/+mAacApwCnAaf+pgGnAKf/pgOn/KYDp/+m/6YCp/6mAacApwCnAKcApwCnAKcApwCnAKcApwCnAKcApwCnAKcApwCnAKcApwCnAKcAWQBZAVn9WARZ/VgCWQBZ/lgCWf9YAFkBWQBZ/1gBWf5YA1n+WAFZAFn+WARZ+1gFWftYBFn+WABZAVn+WAJZ/lgCWf9YAVn+WAJZ/lgDWf1YA1n9WAJZAFn+WANZ/VgDp/2mAqf/pgCnAaf+pgKn/qYCp/6mAqf/pv+mAqf+pgKn/qYCp/6mAqf+pgKn/qYCp/+mAKcBp/6mA6f9pgOn/aYCp/+mAaf/pgCnAaf/pgGn/6YApwGnAKf/pgKn/aYDWf5YAVkAWQBZ/1gCWf1YBFn8WANZ/lgBWQBZAFn/WAJZ/lgBWf9YAVkAWQBZAFn/WAFZ/1gCWf5YAln+WAFZAFkAWQBZAFkAWQFZ/lgCWf5YAVkBWf5YAln9WANZ/aYEp/ymA6f9pgKnAKcAp/+mAqf9pgOn/qYBpwCnAKf/pgGn/6YCp/6mAaf/pgGnAKcApwCn/6YBpwCnAKf/pgGn/6YCp/6mAaf/pgGnAKcAp/+mAqf+pgGnAKf/pgKn/lgBWf9YAVkBWf1YBFn8WANZ/1gAWQBZAVn+WAJZ/1gAWQFZ/1j/WANZ/FgFWftYA1n+WAJZ/lgBWQBZ/1gCWf1YA1n9WANZ/lgAWQFZ/lgCWf9YAFkAWf9YA1n8WASn/KYEp/2mA6f9pgKn/6YBp/6mAqf/pgCnAaf9pgOn/6YApwCnAKcApwCnAKf/pgKn/qYBpwCn/6YBp/+mAaf/pgKn/qYBpwCn/6YBpwCnAKcApwCn/6YBp/+mAqf+pgFZ/1gAWQFZ/1gAWQFZ/lgCWf5YA1n8WARZ/FgDWf9YAFkAWQBZAFkAWQBZAFkBWf9YAVn+WANZ/VgDWf1YA1n9WANZ/VgDWf1YA1n9WAJZAFn/WAFZAFn+WAJZAFn+WASn+6YDpwCn/qYCp/+m/6YDp/2mAqf/pgCnAaf+pgOn/aYCp/+mAaf+pgOn/aYBpwKn/aYCpwCn/6YBp/+mAaf/pgKn/qYApwGnAKf/pgKn/aYDp/6mAacAp/+mAqf+WAFZAFkAWQBZ/1gCWf1YBFn8WAJZAFn/WAFZAFn+WARZ/FgDWf5YAFkCWf9Y/1gCWf5YAVkBWf5YAVkBWf5YAln/WABZAFkBWf5YAln/WABZAVn+WAJZ/1gBWf9YAFkBp/+mAaf/pgGn/qYDp/ymBKf9pgGnAaf+pgOn/aYCp/+mAaf/pgGn/qYDp/2mAqf/pgCnAKcBp/+mAaf/pgGn/6YBpwCn/6YBpwCn/6YBpwCn/6YCp/6mAaf/pgGn/1gBWQBZ/1gBWf9YAFkBWQBZ/1gCWf1YAlkAWf9YAVn/WAFZ/1gBWf9YAVkAWf9YAVn/WAJZ/lgBWf9YAln+WAJZ/lgBWQBZAFkBWf9YAFkBWf5YA1n9WANZ/lgAWQFZ/qYCpwCn/qYCp/6mAqf/pgCnAaf9pgWn+qYGp/ymAacBp/6mAqcAp/6mA6f9pgKn/6YApwCnAaf/pgCnAaf+pgKn/6YApwGn/6YApwGn/qYCp/+mAKcBp/6mA6f9pgKn/1gAWQFZAFn+WANZ/VgDWf1YA1n9WAJZ/1gAWQJZ/VgCWf5YAln/WABZAVn9WAVZ+lgFWf1YAVkAWQBZ/1gCWf9Y/lgEWfxYBFn9WAJZ/lgCWf9YAFkBWf5YAln+WAKn/qYCp/6mAacApwCnAKcBp/6mAqf/pgCnAaf/pgGn/6YBp/+mAKcCp/2mA6f9pgKnAKf/pgGn/6YBp/+mAaf+pgOn/qYBp/+mAKcBp/+mAaf/pgGn/6YBp/+mAKcCp/1YA1n+WAFZ/1gBWQBZAFkAWf9YAVkAWQBZAFn/WAFZAFn/WAJZ/lgBWQBZ/1gBWQBZ/1gCWf5YAVn/WAFZAFkAWf9YAVn/WAJZ/VgEWftYBVn8WAJZAFkAWf9YAVn/pgGnAKf/pgCnAaf/pgKn/aYDp/ymBqf6pgWn/KYCp/+mAqf9pgKnAKf/pgGnAKf+pgSn+6YFp/ymA6f+pgGn/6YCp/2mA6f9pgOn/aYDp/2mA6f9pgKn/6YBp/+mAaf/WABZAln9WANZ/VgCWQBZ/lgDWfxYBFn+WABZAFkAWQBZAVn+WAJZ/lgCWf9Y/1gCWf9YAFkAWQBZAFkBWf9YAFkBWf5YA1n9WAJZ/1gAWQBZAVn+WANZ/FgEWfxYBFn9pgKn/6YApwCnAaf/pgGn/6YApwGn/6YBpwCn/6YBpwCn/qYDp/6mAqf+pgGnAKf/pgKn/aYEp/2mAqf+pgGnAKcApwGn/qYCp/2mA6f/pgCnAKcAp/+mAqf+pgKn/VgEWfxYBFn9WAFZAFkAWQBZAFkAWQBZAFkAWQBZ/1gCWf5YAln+WAJZ/VgDWf9Y/1gDWftYBVn9WAJZ/lgCWf5YAln/WABZAVn+WAJZ/lgDWf1YAln+WAJZ/1gBWf5YAqf/pgGn/6YApwGn/6YCp/ymBKf9pgOn/qYApwCnAaf+pgOn/aYCp/6mA6f8pgSn/aYBpwGn/6YApwCnAKcApwGn/qYCp/2mBaf6pgWn/aYBpwGn/qYCp/6mAqf+pgNZ/VgCWf5YAVkAWQFZ/lgCWf5YAVkAWQFZ/lgCWf5YA1n9WANZ/FgEWf5YAFkBWf5YAln+WAJZ/lgCWf5YAVkAWQBZAVn+WAJZ/lgCWf9YAFkAWQBZAFn/WAJZ/VgDWf6mAaf/pgGn/6YBpwCn/6YCp/6mAaf/pgGnAKcApwCn/6YCp/2mA6f+pgGnAKf/pgGn/6YCp/2mAqf/pgGn/6YBp/6mAqf/pgCnAKcBp/6mA6f8pgSn/aYCp/+mAKcApwFZ/VgFWfpYBln7WARZ/VgCWf9YAFkBWf9YAFkCWf1YAlkAWf9YAVkAWf9YAln+WAFZAFn/WAFZAFn/WAJZ/lgAWQJZ/VgDWf5YAVn/WAFZ/1gBWf9YAVn+WANZ/VgDp/2mAqf/pgCnAqf8pgSn/aYCp/+mAKcApwGn/qYCp/+mAaf/pgCnAaf+pgSn+qYHp/mmB6f6pgSn/aYDp/2mA6f+pgCnAqf8pgSn/aYCp/+mAKcBp/6mAqf/pgCnAaf/WAFZ/1gBWf9YAFkBWf9YAFkBWf5YAln/WABZAVn+WANZ/FgEWf1YAln/WABZAFkAWQFZ/lgCWf9YAFkBWf5YAln/WABZAVn/WABZAVn/WAFZ/1gBWf9YAVkAWf9YAKcCp/2mBKf8pgOn/qYBpwGn/qYCp/+m/6YDp/ymBKf9pgGnAaf+pgKn/qYCp/+mAKcBp/6mAqf/pgCnAaf+pgKn/6YApwGn/6YApwCnAaf/pgGn/qYCp/+mAaf/pv+mAln/WAFZ/lgCWf5YAln/WP9YAln+WAFZAVn+WAFZ/1gBWQBZAFn/WAJZ/VgDWf1YA1n+WAFZ/1gBWf9YAVn/WAFZAFn+WARZ/FgCWQFZ/VgEWfxYA1n+WAJZ/lgBWQBZAKcApwCn/6YBpwGn/qYCp/2mA6f9pgOn/qYBp/+mAaf+pgSn/KYDp/2mA6f+pgKn/qYCp/6mAqf+pgGnAaf/pgGn/qYCp/6mAqf/pgGn/6YApwCnAaf/pgGn/qYCpwBZ/1gAWQFZ/1gBWf9YAVn+WANZ/VgDWf5YAFkBWf5YA1n+WABZAln8WAVZ+1gFWfxYA1n9WAJZ/1gBWQBZ/1gAWQFZ/lgDWf5YAFkCWf1YAlkAWf9YAVkAWf9YAVn/WAGn/6YBp/+mAaf/pgGn/6YBp/+mAaf+pgOn/aYCp/+m/6YCp/6mAqf+pgGn/6YCp/2mBKf7pgWn/KYDp/6mAKcBp/+mAaf/pgCnAKcBp/+mAKcApwCnAaf+pgOn/KYEWf1YAln/WABZAFkBWf5YA1n9WAJZ/1gAWQBZAVn/WABZAVn+WANZ/VgCWf9YAVn/WABZAFkBWf5YA1n8WARZ/FgDWf9YAFkBWf5YAln/WABZAVn/WAFZAFn/WAFZAFkAp/+mA6f7pgan+6YCpwGn/aYEp/ymA6f+pgGn/6YBpwCnAKf/pgGn/6YBpwCn/6YBp/+mAKcBp/+mAKcBp/6mAqf/pgCnAKcApwCnAKcApwCn/6YCp/6mAqf+pgGnAKcAWQBZAVn9WARZ/VgBWQFZ/lgCWf9YAFkAWQFZ/lgDWfxYBFn9WAJZ/1gBWf5YA1n8WARZ/lgBWf9YAVn+WANZ/lgBWf9YAVn/WAFZAFn+WARZ+1gFWfxYAlkBWf1YBKf7pgWn/KYDp/6mAacAp/+mAacAp/+mAacAp/+mAacAp/+mAaf/pgGnAKf/pgGn/qYDp/6mAaf/pgCnAacAp/+mAaf/pgGnAKf/pgCnAaf/pgGn/6YBp/+mAKcBp/6mA1n9WAJZ/1gAWQBZAFkAWQBZAVn+WAJZ/lgBWQFZ/VgEWfxYA1n/WP9YAln9WANZ/1gAWQFZ/VgDWf5YA1n8WARZ/FgDWf9YAFn/WAJZ/lgBWQFZ/VgEWfxYA1n/WP+mAqf+pgGnAaf+pgGnAKcApwCnAKcApwCnAKcBp/2mBKf8pgSn/aYBpwCn/6YCp/+m/6YCp/6mAacBp/6mAacApwCnAKcApwCn/6YCp/6mAacAp/+mAacAp/6mBKf8pgNZ/lgBWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAVn9WANZ/lgBWQJZ/FgDWf5YAVkAWQBZAFkAWQBZ/1gCWf5YAVkAWf9YAln+WAFZAFn/WAFZAFn/WAKn/aYDp/6mAacAp/6mA6f+pgGnAKf+pgKn/6YBp/+mAaf+pgKn/qYCp/+mAKcBp/6mAqf/pgCnAKcBp/6mAqf/pgCnAaf+pgGnAaf+pgKn/6b/pgOn/KYDp/+mAKcBWf5YAln+WANZ/VgDWfxYBFn9WANZ/VgCWf9YAVn/WAFZ/lgDWf5YAVn/WAFZ/lgDWf1YAlkAWf5YA1n9WANZ/VgDWf1YA1n+WAFZ/1gCWf1YA1n9WAJZAFn/WABZAVn+pgOn/aYCp/+mAaf+pgOn/aYCp/+mAKcApwGn/qYCp/+mAaf+pgKn/6YApwGn/6YApwGn/6YApwKn/KYFp/ymAqcAp/6mA6f+pgCnAaf+pgOn/aYCp/6mAqf/pgCnAFkAWf9YAln+WAFZAVn+WAFZAFn/WAJZ/1j/WANZ+1gGWfpYBVn9WAJZ/1j/WAJZ/lgCWf9Y/1gCWf5YAln+WAFZAFkAWQBZ/1gBWQBZAFkAWf9YAln+WAJZ/lgBWQFZ/qYBpwCn/6YCp/2mA6f+pgGnAKf/pgKn/qYCp/6mAqf/pv+mA6f8pgSn/aYBpwGn/qYCp/+mAKcBp/6mAqf/pgCnAaf+pgKn/6b/pgOn/KYFp/umBKf9pgKn/6YApwGn/1gBWf9YAVn/WAFZAFn/WAFZ/1gBWf9YAln8WARZ/VgCWf9YAVn+WANZ/FgFWftYBFn9WAJZ/1gAWQFZ/lgCWf9Y/1gDWfxYBFn9WAJZ/lgCWf5YA1n9WAJZ/1gAWQGn/qYDp/ymBaf7pgSn/aYBpwGn/6YBp/+mAKcApwGn/6YBp/+mAKcBp/+mAaf/pgGn/6YBp/+mAaf/pgGn/6YApwGn/6YBp/6mA6f9pgOn/aYBpwKn/aYDp/2mA6f9pgJZ/1gAWQJZ/VgCWf9YAVn+WANZ/VgDWf5YAFkAWQFZ/1gBWf9YAVn/WAFZ/lgDWf1YA1n9WAJZ/1gAWQBZAFkAWQFZ/VgEWfxYA1n/WABZAFkAWf9YA1n9WANZ/FgDWf+mAKcBp/6mAqf+pgKn/qYCp/6mAqf+pgKn/qYDp/2mAacAp/+mAqf/pv+mAaf/pgKn/qYCp/6mAacBp/+m/6YCp/6mAqf+pgKn/aYEp/ymA6f/pv+mAacAp/+mAqf9WANZ/VgDWf1YAln/WABZAVn+WAJZ/lgCWf5YAln+WAFZAFkAWQBZAFkAWQBZAFkAWf9YAln+WAFZAFn/WAFZAFn/WAFZ/1gBWQBZ/1gBWf5YA1n9WANZ/VgCWf9YAFkBp/6mA6f9pgOn/KYEp/2mA6f9pgKn/qYCp/+mAKcBp/+mAKcBp/6mBKf8pgOn/aYDp/2mA6f9pgOn/aYCp/+mAKcBp/+mAaf/pgGn/6YBp/+mAaf/pgGnAKf+pgOn/VgDWf9Y/lgCWf9YAFkCWf1YAln/WAFZ/1gAWQFZ/1gBWQBZ/1gAWQJZ/FgFWfxYAlkAWf9YAFkBWf5YA1n9WAJZAFn+WAJZ/lgCWQBZ/lgCWf5YAln/WABZAFkBWf5YA6f9pgKn/6YBp/+mAaf/pgCnAaf/pgCnAaf/pgGn/6YApwGn/qYDp/2mAqf/pgCnAKcApwGn/qYCp/+mAKcBp/6mAqf+pgOn/aYCp/6mAqf+pgOn/KYEp/2mAqf/pgCnAVn/WAFZ/1gAWQFZ/lgDWf1YAln/WABZAFkAWQFZ/1gAWQBZAFkBWf9YAFkAWQBZAVn+WAJZ/1gAWQBZAFkAWQFZ/lgCWf5YA1n9WAFZAFn/WANZ/VgCWf5YAln/WACnAKcApwCnAKcAp/+mAqf+pgGnAKf/pgKn/qYBpwCn/6YBp/+mAacAp/+mAaf+pgOn/qYCp/6mAacAp/+mAqf+pgKn/qYCp/6mAacAp/+mAqf+pgKn/qYCp/6mAacApwFZ/lgCWf5YAln/WABZAFkAWQBZAFkBWf9YAFkAWQBZAVn/WAFZ/1gBWf9YAVn/WAJZ/lgBWf9YAVkAWQBZ/1gBWf9YAVkAWf9YAVn/WAFZ/1gBWf9YAVkAWf5YA1n9pgOn/qYBp/+mAacAp/6mA6f9pgOn/qYApwCnAaf/pgGn/6YBp/+mAaf+pgKn/6YBp/+mAaf+pgKn/6YApwKn/aYCp/+mAKcApwGn/qYDp/ymBKf9pgKn/6YApwGn/6YAWQFZ/1gBWf9YAFkBWf9YAFkBWf5YA1n9WAJZ/1gBWQBZ/lgDWf5YAln+WAFZ/1gCWf1YBFn8WANZ/lgBWQBZAVn9WARZ/FgEWf1YAVn/WAJZ/lgCWf5YAVkAWf9YAVn/pgKn/aYDp/2mA6f9pgKnAKf/pgKn/aYCpwCn/6YCp/6mAacAp/+mAqf/pv+mAqf+pgGnAaf9pgOn/qYCp/6mAqf9pgOn/qYCp/+m/6YBpwCn/6YBpwCn/6YCp/2mAlkAWf9YAln9WANZ/lgBWQBZ/1gCWf1YA1n+WAFZAFn/WAFZ/1gCWf1YA1n+WAFZ/1gCWf1YA1n9WANZ/VgDWf5YAFkBWf9YAVkAWf9YAFkBWf9YAVn/WAFZ/lgDWf1YAqcAp/6mA6f9pgKnAKf/pgGn/6YBp/+mAqf9pgOn/aYDp/6mAKcCp/2mA6f+pgCnAqf9pgOn/qYBp/+mAaf+pgSn/KYCpwCn/qYDp/6mAaf/pgGn/6YBpwCn/6YApwFZ/1gBWf9YAVn+WANZ/VgCWf9YAFkAWQFZ/lgCWf5YAln/WP9YAln/WABZAFkAWf9YA1n8WANZ/1j/WANZ/FgEWf1YAVkBWf5YA1n9WAFZAVn+WAJZ/1gAWQBZAFkAWACoAKgAqACoAKgAqACoAKgAqACoAaj+pwOo/KcDqP+nAKgBqP+nAKgAqAGo/6cBqACo/6cBqACo/6cCqP+n/6cCqP6nAagBqP6nAqj/pwCoAKgAqP+nAqj+pwKo/qcBqABYAFj/VwJY/lcCWP9X/1cBWABYAFj/VwJY/lcBWABY/1cBWABY/1cBWABY/1cCWP5XAVgAWP9XA1j8VwRY/FcEWPxXBFj8VwRY/VcBWABYAFgAWABYAFgAWABYAFgAqACoAKgBqP2nBKj8pwOo/6f/pwKo/qcCqP6nAqj+pwOo/KcEqPynBKj9pwKo/6f/pwOo/acCqP+nAaj/pwGo/6cAqAGo/6cBqP6nAqj+pwKo/6f/pwKo/acEqP2nAqj/VwBYAFgCWP1XA1j+VwBYAlj+VwFYAFj/VwBYAlj9VwRY+1cEWP5XAVgAWABY/1cCWP5XAlj+VwJY/lcCWP5XAlj+VwJY/lcBWABYAFj/VwFY/1cBWABY/lcDWP1XA6j9pwKo/6cAqAGo/qcDqP2nAqj/pwCoAKgBqP+nAaj/pwCoAKgBqP6nA6j9pwKo/6cAqAGo/6cBqACo/qcCqP+nAKgCqP2nAqj+pwKo/qcDqPynBKj8pwOo/qcCqP+nAFgAWP9XAlj+VwFYAFgAWP9XAlj+VwFYAFj/VwJY/lcDWPxXBFj9VwFYAVj+VwNY/lcAWAFY/lcDWP5XAFgBWP9XAVj/VwBYAVj/VwJY/FcFWPtXBVj8VwNY/lcAWAJY/acDqP6nAKgCqP2nA6j+pwGo/6cBqACoAKgAqP+nAqj+pwGoAKj/pwKo/qcBqP+nAaj/pwGoAKgAqP+nAqj9pwSo/acBqAGo/qcCqP+nAKgAqACoAKgBqP6nA6j7pwZY/FcCWP9XAFgAWAFY/lcDWP1XAlj/VwBYAVj/VwFY/1cBWP5XA1j9VwJY/1cBWP5XA1j8VwRY/lf/VwNY/FcEWP1XAlj/VwBYAFgAWABYAVj/VwBYAFj/VwJY/1cAWACoAKj/pwKo/qcCqP+nAKgAqACoAKgAqACoAKgAqACo/6cBqP+nAagAqP+nAaj/pwGo/6cCqP2nBKj7pwWo+6cFqPynA6j9pwKoAKj/pwGo/6cBqP+nAqj+pwCoAaj/VwJY/VcDWP1XA1j+VwBYAVgAWABY/1cBWP9XAVgAWP9XAVj/VwFY/1cBWABY/1cBWP9XAVj/VwFY/1cAWAJY/FcFWPtXBFj9VwNY/FcGWPhXCFj6VwRY/VcCWP5XAlj/pwCoAKgAqACoAKgAqACoAKgAqAGo/qcCqP6nAqj/pwCoAaj+pwOo/KcEqP2nA6j9pwKo/6cBqP+nAaj/pwCoAqj9pwOo/acCqP+nAaj/pwGo/qcDqP2nAqj/pwCoAaj/VwBYAVj+VwJY/1cAWAFY/lcCWP5XAlj/VwFY/1cAWABYAFgBWP9XAFgBWP5XAlj/VwBYAVj+VwNY/VcCWP9XAFgBWP9XAVj+VwNY/FcEWP1XA1j9VwJY/1cAWAFY/6cAqAGo/qcDqP6nAKgBqP6nA6j9pwOo/acDqP6nAaj/pwGo/6cBqACo/6cBqP+nAaj/pwGo/6cBqP+nAaj/pwGoAKj+pwOo/qcBqP+nAaj/pwGoAKj+pwOo/acCqP+nAFgAWABYAFgAWABYAFj/VwFYAFgAWABYAFj/VwJY/1cAWABYAFgAWAFY/1cAWABYAFgAWAFY/lcDWPxXBFj9VwJY/1cBWP9XAFgAWAFY/1cBWP9XAFgBWP9XAVj/VwGo/6cBqP+nAaj/pwGo/6cBqP+nAaj/pwCoAqj9pwOo/qcAqAGo/6cCqP2nBKj7pwSo/qcAqAKo/acCqP+nAKgBqACo/qcDqP2nA6j9pwOo/qcBqP+nAaj+pwSo+6cEqP1XA1j9VwJY/1cAWAJY/VcCWP5XAlj/VwFY/lcCWP1XBVj6VwZY+1cCWAFY/VcEWP1XAVgAWABY/1cCWP5XAVgBWP5XAVgBWP5XAlj/V/9XAlj+VwJY/lcCWP1XA1j+VwGoAKj/pwGo/6cCqP2nBKj7pwWo/KcDqf6pAasAq/+rAq3+rACuAa//rgKw/rAAsgGy/7IBtP+zAbX/tQG3/7YBuP+4Abn+uQS7+7sFvPu8BL7+vQG/AMD/wALB/cEEPfw8BDz9OgE6ADoAOQE4/jcCN/41Ajb/NAA0ADMBM/4xAjH+MAIw/y4BLv4tAi3/KwAsAiv9KQIp/ygBKP8mASf/JQAlAST/IwAjASL+IQIh/x8AHwEf/h0CHf4cAhz+5ALl/+X/5gLo/ucB6QDqAOoA6wDsAO3/7APu++4G7/vvA/H/8QDyAPMA9AD0APUB9v72Avf+9wL5//gA+gD7APwA/AD9AP7//QH/AAA=");
            snd.play();
        }

        function onError(error) {
            if (typeofalert != "undefined") {
                alert("An error occured:" + err);
            }
        }
        function EnableSignatureTab() {
            MobileCRM.UI.EntityForm.requestObject(
                function (entityForm) {
                    // get media tab by its name
                    var media = entityForm.getMediaTab("Signature");
                    media.setEditable(true, MobileCRM.bridge.alert); // set false to make it read-only
                },
                MobileCRM.bridge.alert, null
            );
        }
        function DisableSignatureTab() {
            MobileCRM.UI.EntityForm.requestObject(
                function (entityForm) {
                    // get media tab by its name
                    var media = entityForm.getMediaTab("Signature");
                    media.setEditable(false, MobileCRM.bridge.alert); // set false to make it read-only
                },
                MobileCRM.bridge.alert, null
            );
        }
        function getSignatureData() {
            MobileCRM.UI.EntityForm.requestObject(
                function (entityForm) {
                    var media = entityForm.getMediaTab("Signature");
                    media.getData(
                        function (base64String) {
                            MobileCRM.bridge.alert("base64String from media tab:\n" + base64String);
                            var img = document.getElementById("imgTarget");
                            if (img)
                                img.src = "data:;base64," + base64String;
                        },
                        MobileCRM.bridge.alert
                    );
                },
                MobileCRM.bridge.alert, null
            );
        }
                //});
    </script>
</body>
</html>
